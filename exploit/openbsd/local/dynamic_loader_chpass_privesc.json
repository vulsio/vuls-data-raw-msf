{
  "name": "OpenBSD Dynamic Loader chpass Privilege Escalation",
  "fullname": "exploit/openbsd/local/dynamic_loader_chpass_privesc",
  "rank": 600,
  "disclosure_date": "2019-12-11",
  "type": "exploit",
  "author": [
    "Qualys",
    "bcoles <bcoles@gmail.com>"
  ],
  "description": "This module exploits a vulnerability in the OpenBSD `ld.so`\n          dynamic loader (CVE-2019-19726).\n\n          The `_dl_getenv()` function fails to reset the `LD_LIBRARY_PATH`\n          environment variable when set with approximately `ARG_MAX` colons.\n\n          This can be abused to load `libutil.so` from an untrusted path,\n          using `LD_LIBRARY_PATH` in combination with the `chpass` set-uid\n          executable, resulting in privileged code execution.\n\n          This module has been tested successfully on:\n\n          OpenBSD 6.1 (amd64); and\n          OpenBSD 6.6 (amd64)",
  "references": [
    "CVE-2019-19726",
    "EDB-47780",
    "URL-https://blog.qualys.com/laws-of-vulnerabilities/2019/12/11/openbsd-local-privilege-escalation-vulnerability-cve-2019-19726",
    "URL-https://www.qualys.com/2019/12/11/cve-2019-19726/local-privilege-escalation-openbsd-dynamic-loader.txt",
    "URL-https://www.openwall.com/lists/oss-security/2019/12/11/9",
    "URL-https://github.com/bcoles/local-exploits/blob/master/CVE-2019-19726/openbsd-dynamic-loader-chpass",
    "URL-https://ftp.openbsd.org/pub/OpenBSD/patches/6.6/common/013_ldso.patch.sig"
  ],
  "platform": "BSD,Unix",
  "arch": "cmd",
  "targets": [
    "Automatic"
  ],
  "mod_time": "2023-02-02 18:17:02 +0000",
  "path": "/modules/exploits/openbsd/local/dynamic_loader_chpass_privesc.rb",
  "is_install_path": true,
  "ref_name": "openbsd/local/dynamic_loader_chpass_privesc",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "session_types": [
    "shell"
  ],
  "needs_cleanup": true
}
