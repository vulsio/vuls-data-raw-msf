{
	"name": "Solaris RSH Stack Clash Privilege Escalation",
	"fullname": "exploit/solaris/local/rsh_stack_clash_priv_esc",
	"rank": 400,
	"disclosure_date": "2017-06-19",
	"type": "exploit",
	"author": [
		"Qualys Corporation",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module exploits a vulnerability in RSH on unpatched Solaris\n        systems which allows users to gain root privileges.\n\n        The stack guard page on unpatched Solaris systems is of\n        insufficient size to prevent collisions between the stack\n        and heap memory, aka Stack Clash.\n\n        This module uploads and executes Qualys' Solaris_rsh.c exploit,\n        which exploits a vulnerability in RSH to bypass the stack guard\n        page to write to the stack and create a SUID root shell.\n\n        This module has offsets for Solaris versions 11.1 (x86) and\n        Solaris 11.3 (x86).\n\n        Exploitation will usually complete within a few minutes using\n        the default number of worker threads (10). Occasionally,\n        exploitation will fail. If the target system is vulnerable,\n        usually re-running the exploit will be successful.\n\n        This module has been tested successfully on Solaris 11.1 (x86)\n        and Solaris 11.3 (x86).",
	"references": [
		"BID-99151",
		"BID-99153",
		"CVE-2017-1000364",
		"CVE-2017-3629",
		"CVE-2017-3630",
		"CVE-2017-3631",
		"EDB-42270",
		"URL-http://www.oracle.com/technetwork/security-advisory/alert-cve-2017-3629-3757403.html",
		"URL-https://blog.qualys.com/securitylabs/2017/06/19/the-stack-clash",
		"URL-https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt"
	],
	"platform": "Unix",
	"arch": "x86, x64",
	"targets": [
		"Automatic",
		"Solaris 11.1",
		"Solaris 11.3"
	],
	"mod_time": "2020-09-18 11:38:43 +0000",
	"path": "/modules/exploits/solaris/local/rsh_stack_clash_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "solaris/local/rsh_stack_clash_priv_esc",
	"check": true,
	"notes": {
		"AKA": [
			"Stack Clash",
			"Solaris_rsh.c"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
