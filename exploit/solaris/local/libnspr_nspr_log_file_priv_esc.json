{
	"name": "Solaris libnspr NSPR_LOG_FILE Privilege Escalation",
	"fullname": "exploit/solaris/local/libnspr_nspr_log_file_priv_esc",
	"rank": 600,
	"disclosure_date": "2006-10-11",
	"type": "exploit",
	"author": [
		"iDefense",
		"Marco Ivaldi",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module exploits an arbitrary file write vulnerability in the\n        Netscape Portable Runtime library (libnspr) on unpatched Solaris systems\n        prior to Solaris 10u3 which allows users to gain root privileges.\n\n        libnspr versions prior to 4.6.3 allow users to specify a log file with\n        the `NSPR_LOG_FILE` environment variable. The log file is created with\n        the privileges of the running process, resulting in privilege escalation\n        when used in combination with a SUID executable.\n\n        This module writes a shared object to the trusted library directory\n        `/usr/lib/secure` and runs the specified SUID binary with the shared\n        object loaded using the `LD_LIBRARY_PATH` environment variable.\n\n        This module has been tested successfully with libnspr version 4.5.1\n        on Solaris 10u1 (01/06) (x86) and Solaris 10u2 (06/06) (x86).",
	"references": [
		"BID-20471",
		"CVE-2006-4842",
		"EDB-2543",
		"EDB-2569",
		"EDB-2641",
		"URL-https://securitytracker.com/id/1017050",
		"URL-https://securitytracker.com/id/1017051",
		"URL-https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSPR",
		"URL-http://web.archive.org/web/20061118024339/http://labs.idefense.com:80/intelligence/vulnerabilities/display.php?id=418",
		"URL-http://web.archive.org/web/20061110164829/http://sunsolve.sun.com/search/document.do?assetkey=1-26-102658-1"
	],
	"platform": "Solaris",
	"arch": "x86, x64, sparc",
	"targets": [
		"Auto"
	],
	"mod_time": "2021-02-17 12:33:59 +0000",
	"path": "/modules/exploits/solaris/local/libnspr_nspr_log_file_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "solaris/local/libnspr_nspr_log_file_priv_esc",
	"check": true,
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
