{
  "name": "HP Data Protector Create New Folder Buffer Overflow",
  "fullname": "exploit/windows/misc/hp_dataprotector_new_folder",
  "rank": 300,
  "disclosure_date": "2012-03-12",
  "type": "exploit",
  "author": [
    "juan vazquez <juan.vazquez@metasploit.com>",
    "sinn3r <sinn3r@metasploit.com>"
  ],
  "description": "This module exploits a stack buffer overflow in HP Data Protector 5. The overflow\n        occurs in the creation of new folders, where the name of the folder is handled in a\n        insecure way by the dpwindtb.dll component. While the overflow occurs in the stack, the\n        folder name is split in fragments in this insecure copy. Because of this, this module\n        uses egg hunting to search a non corrupted copy of the payload in the heap. On the other\n        hand the overflowed buffer is stored in a frame protected by stack cookies, because of\n        this SEH handler overwrite is used.\n\n        Any user of HP Data Protector Express is able to create new folders and trigger the\n        vulnerability. Moreover, in the default installation the 'Admin' user has an empty\n        password. Successful exploitation will lead to code execution with the privileges of\n        the \"dpwinsdr.exe\" (HP Data Protector Express Domain Server Service) process, which\n        runs as SYSTEM by default.",
  "references": [
    "CVE-2012-0124",
    "OSVDB-80105",
    "BID-52431",
    "URL-https://www.rapid7.com/blog/post/2012/07/06/an-example-of-egghunting-to-exploit-cve-2012-0124"
  ],
  "platform": "Windows",
  "rport": 3817,
  "targets": [
    "HP Data Protector Express 6.0.00.11974 / Windows XP SP3",
    "HP Data Protector Express 5.0.00.59287 / Windows XP SP3"
  ],
  "mod_time": "2022-01-23 15:28:32 +0000",
  "path": "/modules/exploits/windows/misc/hp_dataprotector_new_folder.rb",
  "is_install_path": true,
  "ref_name": "windows/misc/hp_dataprotector_new_folder",
  "post_auth": true
}
