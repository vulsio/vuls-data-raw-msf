{
  "name": "Veritas/Symantec Backup Exec SSL NDMP Connection Use-After-Free",
  "fullname": "exploit/windows/backupexec/ssl_uaf",
  "rank": 300,
  "disclosure_date": "2017-05-10",
  "type": "exploit",
  "author": [
    "Matthew Daley"
  ],
  "description": "This module exploits a use-after-free vulnerability in the handling of SSL NDMP\n        connections in Veritas/Symantec Backup Exec's Remote Agent for Windows. When SSL\n        is re-established on a NDMP connection that previously has had SSL established,\n        the BIO struct for the connection's previous SSL session is reused, even though it\n        has previously been freed.\n\n        This module supports 3 specific versions of the Backup Exec agent in the 14, 15\n        and 16 series on 64-bit and 32-bit versions of Windows and has been tested from\n        Vista to Windows 10. The check command can help narrow down what major and minor\n        revision is installed and the precise of version of Windows, but some other\n        information may be required to make a reliable choice of target.\n\n        NX, ASLR and Windows 8+ anti-ROP mitigations are bypassed. On Windows 8+, it has a\n        reliability of around 85%. On other versions of Windows, reliability is around 35%\n        (due to the need to win a race condition across the network in this case; this may\n        drop further depending on network conditions). The agent is normally installed on\n        all hosts in a domain that need to be backed up, so if one service crashes, try\n        again on another :) Successful exploitation will give remote code execution as the\n        user of the Backup Exec Remote Agent for Windows service, almost always\n        NT AUTHORITY\\SYSTEM.",
  "references": [
    "CVE-2017-8895",
    "VTS-17-006",
    "URL-https://www.veritas.com/content/support/en_US/security/VTS17-006.html"
  ],
  "platform": "Windows",
  "rport": 10000,
  "targets": [
    "Backup Exec 14 (14.1 / revision 9.1), Windows >= 8 x64",
    "Backup Exec 14 (14.1 / revision 9.1), Windows >= 8 x86",
    "Backup Exec 14 (14.1 / revision 9.1), Windows <= 7 x64",
    "Backup Exec 14 (14.1 / revision 9.1), Windows <= 7 x86",
    "Backup Exec 15 (14.2 / revision 9.2), Windows >= 8 x64",
    "Backup Exec 15 (14.2 / revision 9.2), Windows >= 8 x86",
    "Backup Exec 15 (14.2 / revision 9.2), Windows <= 7 x64",
    "Backup Exec 15 (14.2 / revision 9.2), Windows <= 7 x86",
    "Backup Exec 16 (16.0 / revision 9.2), Windows >= 8 x64",
    "Backup Exec 16 (16.0 / revision 9.2), Windows >= 8 x86",
    "Backup Exec 16 (16.0 / revision 9.2), Windows <= 7 x64",
    "Backup Exec 16 (16.0 / revision 9.2), Windows <= 7 x86"
  ],
  "mod_time": "2023-07-14 12:46:26 +0000",
  "path": "/modules/exploits/windows/backupexec/ssl_uaf.rb",
  "is_install_path": true,
  "ref_name": "windows/backupexec/ssl_uaf",
  "check": true
}
