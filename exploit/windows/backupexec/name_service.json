{
  "name": "Veritas Backup Exec Name Service Overflow",
  "fullname": "exploit/windows/backupexec/name_service",
  "rank": 200,
  "disclosure_date": "2004-12-16",
  "type": "exploit",
  "author": [
    "hdm <x@hdm.io>"
  ],
  "description": "This module exploits a vulnerability in the Veritas Backup\n        Exec Agent Browser service. This vulnerability occurs when a\n        recv() call has a length value too long for the\tdestination\n        stack buffer. By sending an agent name value of 63 bytes or\n        more, we can overwrite the return address of the recv\n        function. Since we only have ~60 bytes of contiguous space\n        for shellcode, a tiny findsock payload is sent which uses a\n        hardcoded IAT address for the recv() function. This payload\n        will then roll the stack back to the beginning of the page,\n        recv() the real shellcode into it, and jump to it. This\n        module has been tested against Veritas 9.1 SP0, 9.1 SP1, and\n        8.6.",
  "references": [
    "CVE-2004-1172",
    "OSVDB-12418",
    "BID-11974",
    "URL-http://www.idefense.com/application/poi/display?id=169&type=vulnerabilities"
  ],
  "platform": "Windows",
  "rport": 6101,
  "targets": [
    "Veritas BE 9.1 SP0/SP1",
    "Veritas BE 8.5"
  ],
  "mod_time": "2020-10-02 17:38:06 +0000",
  "path": "/modules/exploits/windows/backupexec/name_service.rb",
  "is_install_path": true,
  "ref_name": "windows/backupexec/name_service"
}
