{
	"name": "FlexDotnetCMS Arbitrary ASP File Upload",
	"fullname": "exploit/windows/http/flexdotnetcms_upload_exec",
	"rank": 600,
	"disclosure_date": "2020-09-28",
	"type": "exploit",
	"author": [
		"Erik Wynter"
	],
	"description": "This module exploits an arbitrary file upload vulnerability in\n          FlexDotnetCMS v1.5.8 and prior in order to execute arbitrary\n          commands with elevated privileges.\n\n          The module first tries to authenticate to FlexDotnetCMS via an HTTP\n          POST request to `/login`. It then attempts to upload a random TXT\n          file and subsequently uses the FlexDotnetCMS file editor to rename\n          the TXT file to an ASP file. If this succeeds, the target is\n          vulnerable and the ASP file is generated as a copy of the TXT file,\n          which remains on the server.\n\n          Next, the module sends another request to rename the TXT file to an\n          ASP file, this time adding the payload. Finally, the module tries\n          to execute the ASP payload via a simple HTTP GET request to\n          `/media/uploads/asp_payload`\n\n          Valid credentials for a FlexDotnetCMS user with permissions to use\n          the FileManager are required. This module has been successfully\n          tested against FlexDotnetCMS v1.5.8 running on Windows Server 2012.",
	"references": [
		"CVE-2020-27386"
	],
	"platform": "Windows",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Windows (x86)",
		"Windows (x64)"
	],
	"mod_time": "2023-02-10 18:04:31 +0000",
	"path": "/modules/exploits/windows/http/flexdotnetcms_upload_exec.rb",
	"is_install_path": true,
	"ref_name": "windows/http/flexdotnetcms_upload_exec",
	"check": true,
	"post_auth": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
