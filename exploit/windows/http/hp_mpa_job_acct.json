{
  "name": "HP Managed Printing Administration jobAcct Remote Command Execution",
  "fullname": "exploit/windows/http/hp_mpa_job_acct",
  "rank": 600,
  "disclosure_date": "2011-12-21",
  "type": "exploit",
  "author": [
    "Andrea Micalizzi",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits an arbitrary file upload vulnerability on HP Managed Printing\n        Administration 2.6.3 and prior versions. The vulnerability exists in the UploadFiles()\n        function from the MPAUploader.Uploader.1 control, loaded and used by the server.\n        The function can be abused via directory traversal and null byte injection in order\n        to achieve arbitrary file upload. In order to exploit successfully, a few conditions\n        must be met. First, a writable location under the context of Internet Guest Account\n        (IUSR_*) or Everyone is required. By default, this module will attempt to write to\n        /hpmpa/userfiles/, but the WRITEWEBFOLDER option can be used to provide\n        another writable path. Second, the writable path must also be readable by a browser,\n        so this typically means a location under wwwroot. Finally, you cannot overwrite\n        a file with the same name as the payload.",
  "references": [
    "CVE-2011-4166",
    "OSVDB-78015",
    "BID-51174",
    "ZDI-11-352",
    "URL-https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03128469"
  ],
  "platform": "Windows",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "HP Managed Printing Administration 2.6.3 / Microsoft Windows [XP SP3 | Server 2003 SP2]"
  ],
  "mod_time": "2017-07-24 06:26:21 +0000",
  "path": "/modules/exploits/windows/http/hp_mpa_job_acct.rb",
  "is_install_path": true,
  "ref_name": "windows/http/hp_mpa_job_acct",
  "check": true
}
