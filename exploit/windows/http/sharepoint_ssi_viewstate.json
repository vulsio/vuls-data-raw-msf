{
  "name": "Microsoft SharePoint Server-Side Include and ViewState RCE",
  "fullname": "exploit/windows/http/sharepoint_ssi_viewstate",
  "rank": 600,
  "disclosure_date": "2020-10-13",
  "type": "exploit",
  "author": [
    "mr_me",
    "wvu <wvu@metasploit.com>"
  ],
  "description": "This module exploits a server-side include (SSI) in SharePoint to leak\n          the web.config file and forge a malicious ViewState with the extracted\n          validation key.\n\n          This exploit is authenticated and requires a user with page creation\n          privileges, which is a standard permission in SharePoint.\n\n          The web.config file will be stored in loot once retrieved, and the\n          VALIDATION_KEY option can be set to short-circuit the SSI and trigger\n          the ViewState deserialization.\n\n          Tested against SharePoint 2019 on Windows Server 2016.",
  "references": [
    "CVE-2020-16952",
    "URL-https://srcincite.io/advisories/src-2020-0022/",
    "URL-https://srcincite.io/pocs/cve-2020-16952.py.txt",
    "URL-https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16952"
  ],
  "platform": "Windows",
  "arch": "cmd, x86, x64",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Windows Command",
    "Windows Dropper",
    "PowerShell Stager"
  ],
  "mod_time": "2021-06-14 10:15:27 +0000",
  "path": "/modules/exploits/windows/http/sharepoint_ssi_viewstate.rb",
  "is_install_path": true,
  "ref_name": "windows/http/sharepoint_ssi_viewstate",
  "check": true,
  "post_auth": true,
  "notes": {
    "Reliability": [
      "unreliable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "config-changes",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
