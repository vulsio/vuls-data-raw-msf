{
  "name": "Microsoft Exchange ProxyNotShell RCE",
  "fullname": "exploit/windows/http/exchange_proxynotshell_rce",
  "rank": 600,
  "disclosure_date": "2022-09-28",
  "type": "exploit",
  "author": [
    "Orange Tsai",
    "Spencer McIntyre",
    "DA-0x43-Dx4-DA-Hx2-Tx2-TP-S-Q",
    "Piotr Bazyd≈Ço",
    "Rich Warren",
    "Soroush Dalili"
  ],
  "description": "This module chains two vulnerabilities on Microsoft Exchange Server\n          that, when combined, allow an authenticated attacker to interact with\n          the Exchange Powershell backend (CVE-2022-41040), where a\n          deserialization flaw can be leveraged to obtain code execution\n          (CVE-2022-41082). This exploit only support Exchange Server 2019.\n\n          These vulnerabilities were patched in November 2022.",
  "references": [
    "CVE-2022-41040",
    "CVE-2022-41082",
    "URL-https://www.zerodayinitiative.com/blog/2022/11/14/control-your-types-or-get-pwned-remote-code-execution-in-exchange-powershell-backend",
    "URL-https://msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/",
    "URL-https://doublepulsar.com/proxynotshell-the-story-of-the-claimed-zero-day-in-microsoft-exchange-5c63d963a9e9",
    "URL-https://rw.md/2022/11/09/ProxyNotRelay.html"
  ],
  "platform": "Windows",
  "arch": "cmd, x64, x86",
  "rport": 443,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Windows Dropper",
    "Windows Command"
  ],
  "mod_time": "2022-11-28 10:06:14 +0000",
  "path": "/modules/exploits/windows/http/exchange_proxynotshell_rce.rb",
  "is_install_path": true,
  "ref_name": "windows/http/exchange_proxynotshell_rce",
  "check": true,
  "post_auth": true,
  "notes": {
    "AKA": [
      "ProxyNotShell"
    ],
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
