{
	"name": "Softing Secure Integration Server v1.22 Remote Code Execution",
	"fullname": "exploit/windows/http/softing_sis_rce",
	"rank": 600,
	"disclosure_date": "2022-07-27",
	"type": "exploit",
	"author": [
		"Chris Anastasio (muffin) of Incite Team",
		"Steven Seeley (mr_me) of Incite Team",
		"Imran E. Dawoodjee <imrandawoodjee.infosec@gmail.com>"
	],
	"description": "This module chains two vulnerabilities (CVE-2022-1373 and CVE-2022-2334) to achieve authenticated remote code execution against Softing Secure Integration Server v1.22.\n\n          In CVE-2022-1373, the restore configuration feature is vulnerable to a directory traversal vulnerablity when processing zip files. When using the \"restore configuration\" feature to upload a zip file containing a path traversal file which is a dll called ..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\Windows\\System32\\wbem\\wbemcomn.dll. This causes the file C:\\Windows\\System32\\wbem\\wbemcomn.dll to be created and executed upon touching the disk.\n\n          In CVE-2022-2334, the planted wbemcomn.dll is used in a DLL hijacking attack when Softing Secure Integration Server restarts upon restoring configuration, which allows us to execute arbitrary code on the target system.\n\n          The chain demonstrated in Pwn2Own used a signature instead of a password. The signature was acquired by running an ARP spoofing attack against the local network where the Softing SIS server was located. A username is also required for signature authentication.\n\n          A custom DLL can be provided to use in the exploit instead of using the default MSF-generated one. Refer to the module documentation for more details.",
	"references": [
		"CVE-2022-1373",
		"CVE-2022-2334",
		"ZDI-22-1154",
		"ZDI-22-1156",
		"URL-https://industrial.softing.com/fileadmin/psirt/downloads/syt-2022-5.html",
		"URL-https://ide0x90.github.io/softing-sis-122-rce/"
	],
	"platform": "Windows",
	"arch": "x64",
	"rport": 8099,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Windows x64"
	],
	"mod_time": "2024-04-19 23:05:02 +0000",
	"path": "/modules/exploits/windows/http/softing_sis_rce.rb",
	"is_install_path": true,
	"ref_name": "windows/http/softing_sis_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
