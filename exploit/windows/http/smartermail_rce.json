{
  "name": "SmarterTools SmarterMail less than build 6985 - .NET Deserialization Remote Code Execution",
  "fullname": "exploit/windows/http/smartermail_rce",
  "rank": 600,
  "disclosure_date": "2019-04-17",
  "type": "exploit",
  "author": [
    "Soroush Dalili",
    "1F98D",
    "Ismail E. Dawoodjee"
  ],
  "description": "This module exploits a vulnerability in the SmarterTools SmarterMail\n          software for version numbers <= 16.x or for build numbers < 6985.\n          The vulnerable versions and builds expose three .NET remoting endpoints\n          on port 17001, namely /Servers, /Mail and /Spool. For example, a\n          typical installation of SmarterMail Build 6970 will have the /Servers\n          endpoint exposed to the public at tcp://0.0.0.0:17001/Servers, where\n          serialized .NET commands can be sent through a TCP socket connection.\n\n          The three endpoints perform deserialization of untrusted data\n          (CVE-2019-7214), allowing an attacker to send arbitrary commands\n          to be deserialized and executed. This module exploits this vulnerability\n          to perform .NET deserialization attacks, allowing remote code execution\n          for any unauthenticated user under the context of the SYSTEM account.\n          Successful exploitation results in full administrative control of the\n          target server under the NT AUTHORITY\\SYSTEM account.\n\n          This vulnerability was patched in Build 6985, where the 17001 port is\n          no longer publicly accessible, although it can be accessible locally\n          at 127.0.0.1:17001. Hence, this would still allow for a privilege\n          escalation vector if the server is compromised as a low-privileged user.",
  "references": [
    "CVE-2019-7214",
    "EDB-49216",
    "URL-https://research.nccgroup.com/2019/04/16/technical-advisory-multiple-vulnerabilities-in-smartermail/"
  ],
  "platform": "Windows",
  "arch": "cmd, x86, x64",
  "rport": 9998,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Windows Command",
    "x86/x64 Windows CmdStager"
  ],
  "mod_time": "2023-07-09 07:25:09 +0000",
  "path": "/modules/exploits/windows/http/smartermail_rce.rb",
  "is_install_path": true,
  "ref_name": "windows/http/smartermail_rce",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
