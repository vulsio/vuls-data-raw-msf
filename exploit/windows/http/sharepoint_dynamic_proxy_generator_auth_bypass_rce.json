{
	"name": "Sharepoint Dynamic Proxy Generator Unauth RCE",
	"fullname": "exploit/windows/http/sharepoint_dynamic_proxy_generator_auth_bypass_rce",
	"rank": 600,
	"disclosure_date": "2023-05-01",
	"type": "exploit",
	"author": [
		"Jang",
		"jheysel-r7"
	],
	"description": "This module exploits two vulnerabilities in Sharepoint 2019, an auth bypass CVE-2023-29357 which was patched\n          in June of 2023 and CVE-2023-24955, an RCE which was patched in May of 2023.\n\n          The auth bypass allows attackers to impersonate the Sharepoint Admin user. This vulnerability stems from the\n          signature validation check used to verify JSON Web Tokens (JWTs) used for OAuth authentication. If the signing\n          algorithm of the user-provided JWT is set to none, SharePoint skips the signature validation step due to a logic\n          flaw in the ReadTokenCore() method.\n\n          After impersonating the administrator user, the attacker has access to the Sharepoint API and is able to\n          exploit CVE-2023-24955. This authenticated RCE vulnerability leverages the impersonated privileged account to\n          replace the \"/BusinessDataMetadataCatalog/BDCMetadata.bdcm\" file in the webroot directory with a payload. The\n          payload is then compiled and executed by Sharepoint allowing attackers to remotely execute commands via the API.",
	"references": [
		"URL-https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-sharepoint-server-2019-may-9-2023-kb5002389-e2b77a46-2946-495f-8948-8abdc44aacc3",
		"URL-https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-sharepoint-server-2019-june-13-2023-kb5002402-c5d58925-f7be-4d16-a61b-8ce871bbe34d",
		"URL-https://testbnull.medium.com/p2o-vancouver-2023-v%C3%A0i-d%C3%B2ng-v%E1%BB%81-sharepoint-pre-auth-rce-chain-cve-2023-29357-cve-2023-24955-ed97dcab131e",
		"CVE-2023-29357",
		"CVE-2023-24955"
	],
	"platform": "Windows",
	"arch": "cmd",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Windows Command"
	],
	"mod_time": "2024-02-15 09:26:54 +0000",
	"path": "/modules/exploits/windows/http/sharepoint_dynamic_proxy_generator_auth_bypass_rce.rb",
	"is_install_path": true,
	"ref_name": "windows/http/sharepoint_dynamic_proxy_generator_auth_bypass_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
