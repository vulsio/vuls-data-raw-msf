{
	"name": "Apache Tika Header Command Injection",
	"fullname": "exploit/windows/http/apache_tika_jp2_jscript",
	"rank": 600,
	"disclosure_date": "2018-04-25",
	"type": "exploit",
	"author": [
		"h00die",
		"David Yesland",
		"Tim Allison"
	],
	"description": "This module exploits a command injection vulnerability in Apache\n        Tika 1.15 - 1.17 on Windows.  A file with the image/jp2 content-type is\n        used to bypass magic bytes checking.  When OCR is specified in the\n        request, parameters can be passed to change the parameters passed\n        at command line to allow for arbitrary JScript to execute. A\n        JScript stub is passed to execute arbitrary code. This module was\n        verified against version 1.15 - 1.17 on Windows 2012.\n        While the CVE and finding show more versions vulnerable, during\n        testing it was determined only > 1.14 was exploitable due to\n        jp2 support being added.",
	"references": [
		"EDB-46540",
		"URL-https://rhinosecuritylabs.com/application-security/exploiting-cve-2018-1335-apache-tika/",
		"URL-https://lists.apache.org/thread.html/b3ed4432380af767effd4c6f27665cc7b2686acccbefeb9f55851dca@%3Cdev.tika.apache.org%3E",
		"CVE-2018-1335"
	],
	"platform": "Windows",
	"rport": 9998,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Windows"
	],
	"mod_time": "2021-02-17 12:33:59 +0000",
	"path": "/modules/exploits/windows/http/apache_tika_jp2_jscript.rb",
	"is_install_path": true,
	"ref_name": "windows/http/apache_tika_jp2_jscript",
	"check": true
}
