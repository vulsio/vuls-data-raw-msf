{
	"name": "FortiNet FortiClient Endpoint Management Server FCTID SQLi to RCE",
	"fullname": "exploit/windows/http/forticlient_ems_fctid_sqli",
	"rank": 600,
	"disclosure_date": "2024-04-21",
	"type": "exploit",
	"author": [
		"Zach Hanley",
		"James Horseman",
		"jheysel-r7",
		"Spencer McIntyre"
	],
	"description": "An SQLi injection vulnerability exists in FortiNet FortiClient EMS (Endpoint Management Server).\n          FortiClient EMS serves as an endpoint management solution tailored for enterprises, offering a centralized\n          platform for overseeing enrolled endpoints. The SQLi is vulnerability is due to user controller strings which\n          can be sent directly into database queries.\n\n          FcmDaemon.exe is the main service responsible for communicating with enrolled clients. By default it listens on port 8013\n          and communicates with FCTDas.exe which is responsible for translating requests and sending them to the database.\n          In the message header of a specific request sent between the two services, the FCTUID parameter is vulnerable\n          SQLi. The SQLi can used to enable the xp_cmdshell which can then be used to obtain unauthenticated remote code\n          execution in the context of NT AUTHORITY\\SYSTEM\n\n          Affected versions of FortiClient EMS include:\n          7.2.0 through 7.2.2\n          7.0.1 through 7.0.10\n\n          Upgrading to either 7.2.3, 7.0.11 or above is recommended by FortiNet.\n\n          It should be noted that in order to be vulnerable, at least one endpoint needs to be enrolled / managed by FortiClient\n          EMS for the necessary vulnerable services to be available.",
	"references": [
		"URL-https://www.horizon3.ai/attack-research/attack-blogs/cve-2023-48788-fortinet-forticlientems-sql-injection-deep-dive/",
		"URL-https://github.com/horizon3ai/CVE-2023-48788/blob/main/CVE-2023-48788.py",
		"CVE-2023-48788"
	],
	"platform": "Windows",
	"arch": "cmd",
	"rport": 8013,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic Target"
	],
	"mod_time": "2024-04-12 10:00:07 +0000",
	"path": "/modules/exploits/windows/http/forticlient_ems_fctid_sqli.rb",
	"is_install_path": true,
	"ref_name": "windows/http/forticlient_ems_fctid_sqli",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
