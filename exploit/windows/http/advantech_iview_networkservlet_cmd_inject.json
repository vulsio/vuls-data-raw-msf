{
  "name": "Advantech iView NetworkServlet Command Injection",
  "fullname": "exploit/windows/http/advantech_iview_networkservlet_cmd_inject",
  "rank": 600,
  "disclosure_date": "2022-06-28",
  "type": "exploit",
  "author": [
    "rgod",
    "y4er",
    "Shelby Pace"
  ],
  "description": "Versions of Advantech iView software below `5.7.04.6469` are\n          vulnerable to an unauthenticated command injection vulnerability\n          via the `NetworkServlet` endpoint.\n          The database backup functionality passes a user-controlled parameter,\n          `backup_file` to the `mysqldump` command. The sanitization functionality only\n          tests for SQL injection attempts and directory traversal, so leveraging the\n          `-r` and `-w` `mysqldump` flags permits exploitation.\n          The command injection vulnerability is used to write a payload on the target\n          and achieve remote code execution as NT AUTHORITY\\SYSTEM.",
  "references": [
    "URL-https://y4er.com/post/cve-2022-2143-advantech-iview-networkservlet-command-inject-rce/",
    "CVE-2022-2143"
  ],
  "platform": "Windows",
  "arch": "x86, x64, cmd",
  "rport": 8080,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Windows Dropper",
    "Windows Command"
  ],
  "mod_time": "2022-08-09 16:12:54 +0000",
  "path": "/modules/exploits/windows/http/advantech_iview_networkservlet_cmd_inject.rb",
  "is_install_path": true,
  "ref_name": "windows/http/advantech_iview_networkservlet_cmd_inject",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "needs_cleanup": true
}
