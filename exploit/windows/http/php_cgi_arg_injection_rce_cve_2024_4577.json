{
	"name": "PHP CGI Argument Injection Remote Code Execution",
	"fullname": "exploit/windows/http/php_cgi_arg_injection_rce_cve_2024_4577",
	"rank": 600,
	"disclosure_date": "2024-06-06",
	"type": "exploit",
	"author": [
		"Orange Tsai",
		"watchTowr",
		"sfewer-r7"
	],
	"description": "This module exploits a PHP CGI argument injection vulnerability affecting PHP in certain configurations\n          on a Windows target. A vulnerable configuration is locale dependant (such as Chinese or Japanese), such that\n          the Unicode best-fit conversion scheme will unexpectedly convert a soft hyphen (0xAD) into a dash (0x2D)\n          character. Additionally a target web server must be configured to run PHP under CGI mode, or directly expose\n          the PHP binary. This issue has been fixed in PHP 8.3.8 (for the 8.3.x branch), 8.2.20 (for the 8.2.x branch),\n          and 8.1.29 (for the 8.1.x branch). PHP 8.0.x and below are end of life and have note received patches.\n\n          XAMPP is vulnerable in a default configuration, and we can target the /php-cgi/php-cgi.exe endpoint. To target\n          an explicit .php endpoint (e.g. /index.php), the server must be configured to run PHP scripts in CGI mode.",
	"references": [
		"CVE-2024-4577",
		"URL-https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability-en/",
		"URL-https://labs.watchtowr.com/no-way-php-strikes-again-cve-2024-4577/"
	],
	"platform": "PHP,Windows",
	"arch": "php, cmd",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Windows PHP",
		"Windows Command"
	],
	"mod_time": "2024-06-13 15:10:14 +0000",
	"path": "/modules/exploits/windows/http/php_cgi_arg_injection_rce_cve_2024_4577.rb",
	"is_install_path": true,
	"ref_name": "windows/http/php_cgi_arg_injection_rce_cve_2024_4577",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
