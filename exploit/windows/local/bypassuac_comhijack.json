{
	"name": "Windows Escalate UAC Protection Bypass (Via COM Handler Hijack)",
	"fullname": "exploit/windows/local/bypassuac_comhijack",
	"rank": 600,
	"disclosure_date": "1900-01-01",
	"type": "exploit",
	"author": [
		"Matt Nelson",
		"b33f",
		"OJ Reeves"
	],
	"description": "This module will bypass Windows UAC by creating COM handler registry entries in the\n          HKCU hive. When certain high integrity processes are loaded, these registry entries\n          are referenced resulting in the process loading user-controlled DLLs. These DLLs\n          contain the payloads that result in elevated sessions. Registry key modifications\n          are cleaned up after payload invocation.\n\n          This module requires the architecture of the payload to match the OS, but the\n          current low-privilege Meterpreter session architecture can be different. If\n          specifying EXE::Custom your DLL should call ExitProcess() after starting your\n          payload in a separate process.\n\n          This module invokes the target binary via cmd.exe on the target. Therefore if\n          cmd.exe access is restricted, this module will not run correctly.",
	"references": [
		"URL-https://wikileaks.org/ciav7p1/cms/page_13763373.html",
		"URL-https://github.com/FuzzySecurity/Defcon25/Defcon25_UAC-0day-All-Day_v1.2.pdf"
	],
	"platform": "Windows",
	"arch": "x86, x64",
	"targets": [
		"Automatic"
	],
	"mod_time": "2024-09-04 23:49:33 +0000",
	"path": "/modules/exploits/windows/local/bypassuac_comhijack.rb",
	"is_install_path": true,
	"ref_name": "windows/local/bypassuac_comhijack",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"screen-effects"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"session_types": [
		"meterpreter"
	],
	"needs_cleanup": true
}
