{
  "name": "Microsoft Windows NtUserMNDragOver Local Privilege Elevation",
  "fullname": "exploit/windows/local/ntusermndragover",
  "rank": 300,
  "disclosure_date": "2019-03-12",
  "type": "exploit",
  "author": [
    "Cl√©ment Lecigne",
    "Grant Willcox",
    "timwr"
  ],
  "description": "This module exploits a NULL pointer dereference vulnerability in\n          MNGetpItemFromIndex(), which is reachable via a NtUserMNDragOver() system call.\n\n          The NULL pointer dereference occurs because the xxxMNFindWindowFromPoint()\n          function does not effectively check the validity of the tagPOPUPMENU\n          objects it processes before passing them on to MNGetpItemFromIndex(),\n          where the NULL pointer dereference will occur.\n\n          This module has been tested against Windows 7 x86 SP0 and SP1. Offsets\n          within the solution may need to be adjusted to work with other versions\n          of Windows, such as Windows Server 2008.",
  "references": [
    "CVE-2019-0808",
    "URL-https://github.com/exodusintel/CVE-2019-0808",
    "URL-https://github.com/ze0r/cve-2019-0808-poc",
    "URL-http://blogs.360.cn/post/RootCause_CVE-2019-0808_EN.html",
    "URL-https://blog.exodusintel.com/2019/05/17/windows-within-windows/"
  ],
  "platform": "Windows",
  "targets": [
    "Windows 7 x86"
  ],
  "mod_time": "2023-05-25 12:45:30 +0000",
  "path": "/modules/exploits/windows/local/ntusermndragover.rb",
  "is_install_path": true,
  "ref_name": "windows/local/ntusermndragover",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "screen-effects"
    ],
    "Stability": [
      "crash-os-restarts"
    ]
  },
  "session_types": [
    "meterpreter"
  ]
}
