{
	"name": "Microsoft Windows DrawIconEx OOB Write Local Privilege Elevation",
	"fullname": "exploit/windows/local/cve_2020_1054_drawiconex_lpe",
	"rank": 300,
	"disclosure_date": "2020-02-20",
	"type": "exploit",
	"author": [
		"Netanel Ben-Simon",
		"Yoav Alon",
		"bee13oy",
		"timwr"
	],
	"description": "This module exploits CVE-2020-1054, an out of bounds write reachable from DrawIconEx\n          within win32k. The out of bounds write can be used to overwrite the pvbits of a\n          SURFOBJ. By utilizing this vulnerability to execute controlled writes to kernel\n          memory, an attacker can gain arbitrary code execution as the SYSTEM user.\n\n          This module has been tested against a fully updated Windows 7 x64 SP1. Offsets\n          within the exploit code may need to be adjusted to work with other versions of\n          Windows.",
	"references": [
		"CVE-2020-1054",
		"URL-https://cpr-zero.checkpoint.com/vulns/cprid-2153/",
		"URL-https://0xeb-bp.com/blog/2020/06/15/cve-2020-1054-analysis.html",
		"URL-https://github.com/DreamoneOnly/2020-1054/blob/master/x64_src/main.cpp",
		"URL-https://github.com/KaLendsi/CVE-2020-1054/blob/master/CVE-2020-1054/exploit.cpp",
		"URL-https://github.com/Iamgublin/CVE-2020-1054/blob/master/ConsoleApplication4.cpp"
	],
	"platform": "Windows",
	"targets": [
		"Windows 7 x64"
	],
	"mod_time": "2023-05-25 12:45:30 +0000",
	"path": "/modules/exploits/windows/local/cve_2020_1054_drawiconex_lpe.rb",
	"is_install_path": true,
	"ref_name": "windows/local/cve_2020_1054_drawiconex_lpe",
	"check": true,
	"notes": {
		"Reliability": [
			"unreliable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-os-restarts"
		]
	},
	"session_types": [
		"meterpreter"
	]
}
