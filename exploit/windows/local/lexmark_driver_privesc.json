{
  "name": "Lexmark Driver Privilege Escalation",
  "fullname": "exploit/windows/local/lexmark_driver_privesc",
  "rank": 300,
  "disclosure_date": "2021-07-15",
  "type": "exploit",
  "author": [
    "Jacob Baines",
    "Shelby Pace",
    "Grant Willcox"
  ],
  "description": "Various Lexmark Universal Printer drivers as listed at advisory TE953\n          allow low-privileged authenicated users to elevate their privileges to\n          SYSTEM on affected Windows systems by modifying the XML file at\n          C:\\ProgramData\\<driver name>\\Universal Color Laser.gdl\n          to replace the DLL path to unires.dll with a malicious DLL path.\n\n          When C:\\Windows\\System32\\Printing_Admin_Scripts\\en-US\\prnmngr.vbs is\n          then used to add the printer to the affected system, PrintIsolationHost.exe,\n          a Windows process running as NT AUTHORITY\\SYSTEM, will inspect the\n          C:\\ProgramData\\<driver name>\\Universal Color Laser.gdl file and will\n          load the malicious DLL from the path specified in the file. This which will\n          result in the malicious DLL executing as NT AUTHORITY\\SYSTEM.\n\n          Once this module is finished, it will use the prnmngr.vbs script\n          to remove the printer it added.",
  "references": [
    "CVE-2021-35449",
    "URL-http://support.lexmark.com/index?page=content&id=TE953",
    "URL-https://github.com/jacob-baines/concealed_position",
    "URL-https://media.defcon.org/DEF%20CON%2029/DEF%20CON%2029%20presentations/Jacob%20Baines%20-%20Bring%20Your%20Own%20Print%20Driver%20Vulnerability.pdf"
  ],
  "platform": "Windows",
  "arch": "x86, x64",
  "targets": [
    "Windows"
  ],
  "mod_time": "2023-02-08 15:20:32 +0000",
  "path": "/modules/exploits/windows/local/lexmark_driver_privesc.rb",
  "is_install_path": true,
  "ref_name": "windows/local/lexmark_driver_privesc",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk"
    ],
    "Stability": [
      "service-resource-loss"
    ]
  },
  "session_types": [
    "meterpreter"
  ],
  "needs_cleanup": true
}
