{
	"name": "Windows Escalate UAC Protection Bypass (Via SilentCleanup)",
	"fullname": "exploit/windows/local/bypassuac_silentcleanup",
	"rank": 600,
	"disclosure_date": "2019-02-24",
	"type": "exploit",
	"author": [
		"tyranid",
		"enigma0x3",
		"nyshone69",
		"lokiuox",
		"Carter Brainerd (cbrnrd)"
	],
	"description": "There's a task in Windows Task Scheduler called \"SilentCleanup\" which, while it's executed as Users, automatically runs with elevated privileges.\n        When it runs, it executes the file %windir%\\system32\\cleanmgr.exe. Since it runs as Users, and we can control user's environment variables,\n        %windir% (normally pointing to C:\\Windows) can be changed to point to whatever we want, and it'll run as admin.",
	"references": [
		"URL-https://tyranidslair.blogspot.com/2017/05/exploiting-environment-variables-in.html",
		"URL-https://enigma0x3.net/2016/07/22/bypassing-uac-on-windows-10-using-disk-cleanup/",
		"URL-https://www.reddit.com/r/hacking/comments/ajtrws/bypassing_highest_uac_level_windows_810/",
		"URL-https://forums.hak5.org/topic/45439-powershell-real-uac-bypass/"
	],
	"platform": "Windows",
	"arch": "x86, x64",
	"targets": [
		"Microsoft Windows"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/windows/local/bypassuac_silentcleanup.rb",
	"is_install_path": true,
	"ref_name": "windows/local/bypassuac_silentcleanup",
	"session_types": [
		"meterpreter",
		"shell"
	],
	"needs_cleanup": true
}
