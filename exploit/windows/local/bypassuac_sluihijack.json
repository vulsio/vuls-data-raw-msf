{
	"name": "Windows UAC Protection Bypass (Via Slui File Handler Hijack)",
	"fullname": "exploit/windows/local/bypassuac_sluihijack",
	"rank": 600,
	"disclosure_date": "2018-01-15",
	"type": "exploit",
	"author": [
		"bytecode-77",
		"gushmazuko"
	],
	"description": "This module will bypass UAC on Windows 8-10 by hijacking a special key in the Registry under\n          the Current User hive, and inserting a custom command that will get invoked when any binary\n          (.exe) application is launched. But slui.exe is an auto-elevated binary that is vulnerable\n          to file handler hijacking. When we run slui.exe with changed Registry key\n          (HKCU:\\Software\\Classes\\exefile\\shell\\open\\command), it will run our custom command as Admin\n          instead of slui.exe.\n\n          The module modifies the registry in order for this exploit to work. The modification is\n          reverted once the exploitation attempt has finished.\n\n          The module does not require the architecture of the payload to match the OS. If\n          specifying EXE::Custom your DLL should call ExitProcess() after starting the\n          payload in a different process.",
	"references": [
		"URL-https://github.com/bytecode-77/slui-file-handler-hijack-privilege-escalation",
		"URL-https://github.com/gushmazuko/WinBypass/blob/master/SluiHijackBypass.ps1"
	],
	"platform": "Windows",
	"targets": [
		"Windows x86",
		"Windows x64"
	],
	"mod_time": "2023-05-25 12:45:30 +0000",
	"path": "/modules/exploits/windows/local/bypassuac_sluihijack.rb",
	"is_install_path": true,
	"ref_name": "windows/local/bypassuac_sluihijack",
	"check": true,
	"session_types": [
		"meterpreter"
	]
}
