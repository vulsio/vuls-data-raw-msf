{
  "name": "CVE-2022-21999 SpoolFool Privesc",
  "fullname": "exploit/windows/local/cve_2022_21999_spoolfool_privesc",
  "rank": 300,
  "disclosure_date": "2022-02-08",
  "type": "exploit",
  "author": [
    "Oliver Lyak",
    "Shelby Pace"
  ],
  "description": "The Windows Print Spooler has a privilege escalation vulnerability that\n          can be leveraged to achieve code execution as SYSTEM.\n\n          The `SpoolDirectory`, a configuration setting that holds the path that\n          a printer's spooled jobs are sent to, is writable for all users, and it can\n          be configured via `SetPrinterDataEx()` provided the caller has the\n          `PRINTER_ACCESS_ADMINISTER` permission. If the `SpoolDirectory` path does not\n          exist, it will be created once the print spooler reinitializes.\n\n          Calling `SetPrinterDataEx()` with the `CopyFiles\\` registry key will load the\n          dll passed in as the `pData` argument, meaning that writing a dll to the `SpoolDirectory`\n          location can be loaded by the print spooler.\n\n          Using a directory junction and UNC path for the `SpoolDirectory`, the exploit\n          writes a payload to `C:\\Windows\\System32\\spool\\drivers\\x64\\4` and loads it\n          by calling `SetPrinterDataEx()`, resulting in code execution as SYSTEM.",
  "references": [
    "URL-https://research.ifcr.dk/spoolfool-windows-print-spooler-privilege-escalation-cve-2022-22718-bf7752b68d81",
    "CVE-2022-21999"
  ],
  "platform": "Windows",
  "arch": "x64",
  "targets": [
    "Auto"
  ],
  "mod_time": "2023-05-25 12:45:30 +0000",
  "path": "/modules/exploits/windows/local/cve_2022_21999_spoolfool_privesc.rb",
  "is_install_path": true,
  "ref_name": "windows/local/cve_2022_21999_spoolfool_privesc",
  "check": true,
  "notes": {
    "AKA": [
      "SpoolFool"
    ],
    "Reliability": [
      "unreliable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-service-restarts"
    ]
  },
  "session_types": [
    "meterpreter"
  ],
  "needs_cleanup": true
}
