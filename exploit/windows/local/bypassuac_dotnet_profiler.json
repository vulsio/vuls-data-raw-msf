{
  "name": "Windows Escalate UAC Protection Bypass (Via dot net profiler)",
  "fullname": "exploit/windows/local/bypassuac_dotnet_profiler",
  "rank": 600,
  "disclosure_date": "2017-03-17",
  "type": "exploit",
  "author": [
    "Casey Smith",
    "\"Stefan Kanthak\" <stefan.kanthak () nexgo de>",
    "bwatters-r7"
  ],
  "description": "Microsoft Windows allows for the automatic loading of a profiling COM object during\n          the launch of a CLR process based on certain environment variables ostensibly to\n          monitor execution.  In this case, we abuse the profiler by pointing to a payload DLL\n          that will be launched as the profiling thread.  This thread will run at the permission\n          level of the calling process, so an auto-elevating process will launch the DLL with\n          elevated permissions.  In this case, we use gpedit.msc as the auto-elevated CLR\n          process, but others would work, too.",
  "references": [
    "URL-https://seclists.org/fulldisclosure/2017/Jul/11",
    "URL-https://offsec.provadys.com/UAC-bypass-dotnet.html"
  ],
  "platform": "Windows",
  "targets": [
    "Windows x64"
  ],
  "mod_time": "2023-07-21 15:34:49 +0000",
  "path": "/modules/exploits/windows/local/bypassuac_dotnet_profiler.rb",
  "is_install_path": true,
  "ref_name": "windows/local/bypassuac_dotnet_profiler",
  "check": true,
  "notes": {
    "SideEffects": [
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "session_types": [
    "meterpreter"
  ],
  "needs_cleanup": true
}
