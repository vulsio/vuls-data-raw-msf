{
	"name": "Windows AlwaysInstallElevated MSI",
	"fullname": "exploit/windows/local/always_install_elevated",
	"rank": 600,
	"disclosure_date": "2010-03-18",
	"type": "exploit",
	"author": [
		"Ben Campbell <eat_meatballs@hotmail.co.uk>",
		"Parvez Anwar"
	],
	"description": "This module checks the AlwaysInstallElevated registry keys which dictates if\n        .MSI files should be installed with elevated privileges (NT AUTHORITY\\SYSTEM).\n        The generated .MSI file has an embedded executable which is extracted and run\n        by the installer. After execution the .MSI file intentionally fails installation\n        (by calling some invalid VBS) to prevent it being registered on the system.\n        By running this with the /quiet argument the error will not be seen by the user.",
	"references": [
		"URL-http://www.greyhathacker.net/?p=185",
		"URL-http://msdn.microsoft.com/en-us/library/aa367561(VS.85).aspx",
		"URL-http://rewtdance.blogspot.co.uk/2013/03/metasploit-msi-payload-generation.html"
	],
	"platform": "Windows",
	"arch": "x86, x64",
	"targets": [
		"Windows"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/windows/local/always_install_elevated.rb",
	"is_install_path": true,
	"ref_name": "windows/local/always_install_elevated",
	"check": true,
	"session_types": [
		"meterpreter"
	],
	"needs_cleanup": true
}
