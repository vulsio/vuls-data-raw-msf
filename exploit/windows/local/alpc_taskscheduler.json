{
  "name": "Microsoft Windows ALPC Task Scheduler Local Privilege Elevation",
  "fullname": "exploit/windows/local/alpc_taskscheduler",
  "rank": 300,
  "disclosure_date": "2018-08-27",
  "type": "exploit",
  "author": [
    "SandboxEscaper",
    "bwatters-r7",
    "asoto-r7",
    "Jacob Robles"
  ],
  "description": "On vulnerable versions of Windows the alpc endpoint method SchRpcSetSecurity implemented\n          by the task scheduler service can be used to write arbitrary DACLs to `.job` files located\n          in `c:\\windows\\tasks` because the scheduler does not use impersonation when checking this\n          location. Since users can create files in the `c:\\windows\\tasks` folder, a hardlink can be\n          created to a file the user has read access to. After creating a hardlink, the vulnerability\n          can be triggered to set the DACL on the linked file.\n\n          WARNING:\n          The PrintConfig.dll (%windir%\\system32\\driverstor\\filerepository\\prnms003*) on the target host\n          will be overwritten when the exploit runs.\n\n          This module has been tested against Windows 10 Pro x64.",
  "references": [
    "CVE-2018-8440",
    "URL-https://github.com/SandboxEscaper/randomrepo/"
  ],
  "platform": "Windows",
  "targets": [
    "Windows 10 x64"
  ],
  "mod_time": "2023-05-25 12:45:30 +0000",
  "path": "/modules/exploits/windows/local/alpc_taskscheduler.rb",
  "is_install_path": true,
  "ref_name": "windows/local/alpc_taskscheduler",
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "Stability": [
      "os-resource-loss"
    ]
  },
  "session_types": [
    "meterpreter"
  ]
}
