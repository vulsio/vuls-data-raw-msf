{
  "name": "Windows Unquoted Service Path Privilege Escalation",
  "fullname": "exploit/windows/local/unquoted_service_path",
  "rank": 500,
  "disclosure_date": "2001-10-25",
  "type": "exploit",
  "author": [
    "sinn3r <sinn3r@metasploit.com>",
    "h00die"
  ],
  "description": "This module exploits a logic flaw due to how the lpApplicationName parameter\n          is handled.  When the lpApplicationName contains a space, the file name is\n          ambiguous.  Take this file path as example: C:\\program files\\hello.exe;\n          The Windows API will try to interpret this as two possible paths:\n          C:\\program.exe, and C:\\program files\\hello.exe, and then execute all of them.\n          To some software developers, this is an unexpected behavior, which becomes a\n          security problem if an attacker is able to place a malicious executable in one\n          of these unexpected paths, sometimes escalate privileges if run as SYSTEM.\n          Some software such as OpenVPN 2.1.1, OpenSSH Server 5, and others have the\n          same problem.\n\n          The offensive technique is also described in Writing Secure Code (2nd Edition),\n          Chapter 23, in the section \"Calling Processes Security\" on page 676.\n\n          This technique was previously called Trusted Service Path, but is more commonly\n          known as Unquoted Service Path.\n\n          The service exploited won't start until the payload written to disk is removed.",
  "references": [
    "URL-http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx",
    "URL-http://www.microsoft.com/learning/en/us/book.aspx?id=5957&locale=en-us",
    "URL-https://medium.com/@SumitVerma101/windows-privilege-escalation-part-1-unquoted-service-path-c7a011a8d8ae"
  ],
  "platform": "Windows",
  "targets": [
    "Windows"
  ],
  "mod_time": "2023-03-13 10:31:27 +0000",
  "path": "/modules/exploits/windows/local/unquoted_service_path.rb",
  "is_install_path": true,
  "ref_name": "windows/local/unquoted_service_path",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "config-changes"
    ],
    "Stability": [
      "crash-service-down"
    ]
  },
  "session_types": [
    "meterpreter"
  ],
  "needs_cleanup": true
}
