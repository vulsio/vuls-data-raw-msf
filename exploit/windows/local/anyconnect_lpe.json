{
	"name": "Cisco AnyConnect Privilege Escalations (CVE-2020-3153 and CVE-2020-3433)",
	"fullname": "exploit/windows/local/anyconnect_lpe",
	"rank": 600,
	"disclosure_date": "2020-08-05",
	"type": "exploit",
	"author": [
		"Yorick Koster",
		"Antoine Goichot (ATGO)",
		"Christophe De La Fuente"
	],
	"description": "The installer component of Cisco AnyConnect Secure Mobility Client for Windows\n          prior to 4.8.02042 is vulnerable to path traversal and allows local attackers\n          to create/overwrite files in arbitrary locations with system level privileges.\n\n          The installer component of Cisco AnyConnect Secure Mobility Client for Windows\n          prior to 4.9.00086 is vulnerable to a DLL hijacking and allows local attackers\n          to execute code on the affected machine with with system level privileges.\n\n          Both attacks consist in sending a specially crafted IPC request to the TCP\n          port 62522 on the loopback device, which is exposed by the Cisco AnyConnect\n          Secure Mobility Agent service. This service will then launch the vulnerable\n          installer component (`vpndownloader`), which copies itself to an arbitrary\n          location (CVE-2020-3153) or with a supplied DLL (CVE-2020-3433) before being\n          executed with system privileges. Since `vpndownloader` is also vulnerable to DLL\n          hijacking, a specially crafted DLL (`dbghelp.dll`) is created at the same\n          location `vpndownloader` will be copied to get code execution with system\n          privileges.\n\n          The CVE-2020-3153 exploit has been successfully tested against Cisco AnyConnect\n          Secure Mobility Client versions 4.5.04029, 4.5.05030 and 4.7.04056 on Windows 10\n          version 1909 (x64) and Windows 7 SP1 (x86); the CVE-2020-3434 exploit has been\n          successfully tested against Cisco AnyConnect Secure Mobility Client versions\n          4.5.02036, 4.6.03049, 4.7.04056, 4.8.01090 and 4.8.03052 on Windows 10 version\n          1909 (x64) and 4.7.4056 on Windows 7 SP1 (x64).",
	"references": [
		"URL-https://ssd-disclosure.com/ssd-advisory-cisco-anyconnect-privilege-elevation-through-path-traversal/",
		"URL-https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj",
		"CVE-2020-3153",
		"URL-https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-anyconnect-dll-F26WwJW",
		"CVE-2020-3433"
	],
	"platform": "Windows",
	"arch": "x86, x64",
	"targets": [
		"Windows x86/x64 with x86 payload"
	],
	"mod_time": "2023-01-28 09:08:51 +0000",
	"path": "/modules/exploits/windows/local/anyconnect_lpe.rb",
	"is_install_path": true,
	"ref_name": "windows/local/anyconnect_lpe",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"session_types": [
		"meterpreter"
	],
	"needs_cleanup": true
}
