{
  "name": "LNK Code Execution Vulnerability",
  "fullname": "exploit/windows/local/cve_2017_8464_lnk_lpe",
  "rank": 500,
  "disclosure_date": "2017-06-13",
  "type": "exploit",
  "author": [
    "Uncredited",
    "Yorick Koster",
    "Spencer McIntyre"
  ],
  "description": "This module exploits a vulnerability in the handling of Windows Shortcut files (.LNK)\n          that contain a dynamic icon, loaded from a malicious DLL.\n\n          This vulnerability is a variant of MS15-020 (CVE-2015-0096). The created LNK file is\n          similar except an additional SpecialFolderDataBlock is included. The folder ID set\n          in this SpecialFolderDataBlock is set to the Control Panel. This is enough to bypass\n          the CPL whitelist. This bypass can be used to trick Windows into loading an arbitrary\n          DLL file.\n\n          The PATH option must be an absolute path to a writeable directory which is indexed for\n          searching. If no PATH is specified, the module defaults to %USERPROFILE%.",
  "references": [
    "CVE-2017-8464",
    "URL-https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8464",
    "URL-http://www.vxjump.net/files/vuln_analysis/cve-2017-8464.txt",
    "URL-https://msdn.microsoft.com/en-us/library/dd871305.aspx",
    "URL-http://www.geoffchappell.com/notes/security/stuxnet/ctrlfldr.htm",
    "URL-https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf"
  ],
  "platform": "Windows",
  "arch": "x86, x64",
  "targets": [
    "Windows x64",
    "Windows x86"
  ],
  "mod_time": "2023-03-13 10:31:27 +0000",
  "path": "/modules/exploits/windows/local/cve_2017_8464_lnk_lpe.rb",
  "is_install_path": true,
  "ref_name": "windows/local/cve_2017_8464_lnk_lpe",
  "check": true,
  "notes": {
    "SideEffects": [
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-service-restarts"
    ]
  },
  "needs_cleanup": true
}
