{
	"name": "Ancillary Function Driver (AFD) for WinSock Elevation of Privilege",
	"fullname": "exploit/windows/local/cve_2023_21768_afd_lpe",
	"rank": 600,
	"disclosure_date": "2023-01-10",
	"type": "exploit",
	"author": [
		"chompie",
		"b33f",
		"Yarden Shafir",
		"Christophe De La Fuente"
	],
	"description": "A vulnerability exists in the Windows Ancillary Function Driver for Winsock\n            (`afd.sys`) can be leveraged by an attacker to escalate privileges to those of\n            NT AUTHORITY\\SYSTEM. Due to a flaw in `AfdNotifyRemoveIoCompletion`, it is\n            possible to create an arbitrary kernel Write-Where primitive, which can be used\n            to manipulate internal I/O ring structures and achieve local privilege\n            escalation.\n\n            This exploit only supports Windows 11 22H2 up to build 22621.963 (patched in\n            January 2023 updates).",
	"references": [
		"CVE-2023-21768",
		"URL-https://github.com/xforcered/Windows_LPE_AFD_CVE-2023-21768",
		"URL-https://github.com/yardenshafir/IoRingReadWritePrimitive"
	],
	"platform": "Windows",
	"arch": "x64",
	"targets": [
		"Windows 11 22H2 x64"
	],
	"mod_time": "2023-04-04 09:48:51 +0000",
	"path": "/modules/exploits/windows/local/cve_2023_21768_afd_lpe.rb",
	"is_install_path": true,
	"ref_name": "windows/local/cve_2023_21768_afd_lpe",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"session_types": [
		"meterpreter"
	]
}
