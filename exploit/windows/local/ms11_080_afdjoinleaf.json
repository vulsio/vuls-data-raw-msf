{
	"name": "MS11-080 AfdJoinLeaf Privilege Escalation",
	"fullname": "exploit/windows/local/ms11_080_afdjoinleaf",
	"rank": 200,
	"disclosure_date": "2011-11-30",
	"type": "exploit",
	"author": [
		"Matteo Memelli",
		"Spencer McIntyre"
	],
	"description": "This module exploits a flaw in the AfdJoinLeaf function of the\n            afd.sys driver to overwrite data in kernel space.  An address\n            within the HalDispatchTable is overwritten and when triggered\n            with a call to NtQueryIntervalProfile will execute shellcode.\n\n            This module will elevate itself to SYSTEM, then inject the payload\n            into another SYSTEM process before restoring its own token to\n            avoid causing system instability.",
	"references": [
		"CVE-2011-2005",
		"OSVDB-76232",
		"EDB-18176",
		"MSB-MS11-080",
		"URL-http://www.offensive-security.com/vulndev/ms11-080-voyage-into-ring-zero/"
	],
	"platform": "Windows",
	"arch": "x86",
	"targets": [
		"Automatic",
		"Windows XP SP2 / SP3",
		"Windows Server 2003 SP2"
	],
	"mod_time": "2023-05-25 12:45:30 +0000",
	"path": "/modules/exploits/windows/local/ms11_080_afdjoinleaf.rb",
	"is_install_path": true,
	"ref_name": "windows/local/ms11_080_afdjoinleaf",
	"notes": {
		"SideEffects": [
			"ioc-in-logs",
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-os-restarts"
		]
	},
	"session_types": [
		"meterpreter"
	]
}
