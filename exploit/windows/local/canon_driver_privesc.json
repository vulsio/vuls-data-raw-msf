{
	"name": "Canon Driver Privilege Escalation",
	"fullname": "exploit/windows/local/canon_driver_privesc",
	"rank": 300,
	"disclosure_date": "2021-08-07",
	"type": "exploit",
	"author": [
		"Jacob Baines",
		"Shelby Pace"
	],
	"description": "Canon TR150 print drivers versions 3.71.2.10 and below allow local users to read/write files\n          within the \"CanonBJ\" directory and its subdirectories. By overwriting the DLL at\n          C:\\ProgramData\\CanonBJ\\IJPrinter\\CNMWINDOWS\\Canon TR150 series\\LanguageModules\\040C\\CNMurGE.dll\n          with a malicious DLL at the right time whilst running the C:\\Windows\\System32\\Printing_Admin_Scripts\\en-US\\prnmngr.vbs\n          script to install a new printer, a timing issue can be exploited to cause the PrintIsolationHost.exe program,\n          which runs as NT AUTHORITY\\SYSTEM, to successfully load the malicious DLL. Successful exploitation\n          will grant attackers code execution as the NT AUTHORITY\\SYSTEM user.\n\n          This module leverages the prnmngr.vbs script\n          to add and delete printers. Multiple runs of this\n          module may be required given successful exploitation\n          is time-sensitive.",
	"references": [
		"CVE-2021-38085"
	],
	"platform": "Windows",
	"arch": "x86, x64",
	"targets": [
		"Windows"
	],
	"mod_time": "2021-09-08 21:56:02 +0000",
	"path": "/modules/exploits/windows/local/canon_driver_privesc.rb",
	"is_install_path": true,
	"ref_name": "windows/local/canon_driver_privesc",
	"check": true,
	"notes": {
		"Reliability": [
			"unreliable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"service-resource-loss"
		]
	},
	"session_types": [
		"meterpreter"
	],
	"needs_cleanup": true
}
