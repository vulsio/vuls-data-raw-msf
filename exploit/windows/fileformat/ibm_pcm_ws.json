{
	"name": "IBM Personal Communications iSeries Access WorkStation 5.9 Profile",
	"fullname": "exploit/windows/fileformat/ibm_pcm_ws",
	"rank": 500,
	"disclosure_date": "2012-02-28",
	"type": "exploit",
	"author": [
		"TecR0c <roccogiovannicalvi@gmail.com>"
	],
	"description": "The IBM Personal Communications I-Series application WorkStation is susceptible to a\n      stack-based buffer overflow vulnerability within file parsing in which data copied to a\n      location in memory exceeds the size of the reserved destination area. The buffer is located\n      on the runtime program stack.\n\n      When the WorkStation file is opened it will reach the code path at 0x67575180 located in\n      pcspref.dll which conducts string manipulation and validation on the data supplied in the\n      WorkStation file. The application will first check if 'Profile' header exists and appends\n      a dot with the next parameter within the file. It will then measure the character length\n      of the header by calling strcspn with a dot as its null-terminated character.\n\n      It will then write the header into memory and ensure the header ends with a NUL character.\n      The parameter character array is passed to the strcpy() function. The application has\n      declared a 52-element character array for the destination for strcpy function. The\n      function does not perform bounds checking therefore, data can be written paste the end of\n      the buffer variable resulting in corruption of adjacent variables including other local\n      variables, program state information and function arguments. You will notice that the\n      saved RETURN address at offset 0x6c is overwritten by the data written past the buffer.\n\n      To ensure we can perform arbitrary code execution we must we provide a valid pointer at\n      0x74 which is used as an argument for the called function at 0x675751ED as an id file\n      extension parameter. Once the caller regains control we will reach our RETURN. The Ret\n      instruction will be used to pop the overwritten saved return address which was corrupted.\n\n      This exploit has been written to bypass 2 mitigations DEP and ASLR on a Windows platform.\n\n      Versions tested:\n      IBM System i Access for Windows V6R1M0 version 06.01.0001.0000a\n      Which bundles pcsws.exe version 5090.27271.709\n\n      Tested on:\n      Microsoft Windows XP     [Version 5.1.2600]\n      Microsoft Windows Vista  [Version 6.0.6002]\n      Microsoft Windows 7      [Version 6.1.7600]",
	"references": [
		"CVE-2012-0201",
		"OSVDB-79657",
		"URL-https://www-304.ibm.com/support/docview.wss?uid=swg21586166"
	],
	"platform": "Windows",
	"targets": [
		"IBM WorkStation 5.9 (Windows XP SP3)",
		"IBM WorkStation 5.9 (Windows 7, Windows Vista)"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/windows/fileformat/ibm_pcm_ws.rb",
	"is_install_path": true,
	"ref_name": "windows/fileformat/ibm_pcm_ws"
}
