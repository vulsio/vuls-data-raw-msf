{
  "name": "Mozilla Firefox \"nsTreeRange\" Dangling Pointer Vulnerability",
  "fullname": "exploit/windows/browser/mozilla_nstreerange",
  "rank": 300,
  "disclosure_date": "2011-02-02",
  "type": "exploit",
  "author": [
    "regenrecht",
    "xero"
  ],
  "description": "This module exploits a code execution vulnerability in Mozilla Firefox\n        3.6.x <= 3.6.16 and 3.5.x <= 3.5.17 found in nsTreeSelection.\n        By overwriting a subfunction of invalidateSelection it is possible to free the\n        nsTreeRange object that the function currently operates on.\n        Any further operations on the freed object can result in remote code execution.\n        Utilizing the call setup the function provides it's possible to bypass DEP\n        without the need for a ROP. Sadly this exploit is still either dependent\n        on Java or bound by ASLR because Firefox doesn't employ any ASLR-free\n        modules anymore.",
  "references": [
    "CVE-2011-0073",
    "OSVDB-72087",
    "BID-47663",
    "ZDI-11-157",
    "URL-https://bugzilla.mozilla.org/show_bug.cgi?id=630919",
    "URL-http://www.mozilla.org/security/announce/2011/mfsa2011-13.html"
  ],
  "platform": "Windows",
  "targets": [
    "Auto (Direct attack against Windows XP, otherwise through Java, if enabled)",
    "Firefox Runtime, fails with ASLR",
    "Java Runtime (7.10.3052.4), best against ASLR",
    "Java JVM (20.1.0.02)",
    "Java Regutils (6.0.260.3)"
  ],
  "mod_time": "2020-10-02 17:38:06 +0000",
  "path": "/modules/exploits/windows/browser/mozilla_nstreerange.rb",
  "is_install_path": true,
  "ref_name": "windows/browser/mozilla_nstreerange"
}
