{
	"name": "Microsoft WMI Administration Tools ActiveX Buffer Overflow",
	"fullname": "exploit/windows/browser/wmi_admintools",
	"rank": 500,
	"disclosure_date": "2010-12-21",
	"type": "exploit",
	"author": [
		"WooYun",
		"MC <mc@metasploit.com>",
		"jduck <jduck@metasploit.com>"
	],
	"description": "This module exploits a memory trust issue in the Microsoft WMI\n        Administration tools ActiveX control. When processing a specially crafted\n        HTML page, the WEBSingleView.ocx ActiveX Control (1.50.1131.0) will treat\n        the 'lCtxHandle' parameter to the 'AddContextRef' and 'ReleaseContext' methods\n        as a trusted pointer. It makes an indirect call via this pointer which leads\n        to arbitrary code execution.\n\n        This exploit utilizes a combination of heap spraying and the\n        .NET 2.0 'mscorie.dll' module to bypass DEP and ASLR. This module does not\n        opt-in to ASLR. As such, this module should be reliable on all Windows\n        versions.\n\n        The WMI Administrative Tools are a standalone download & install (linked in the\n        references).",
	"references": [
		"OSVDB-69942",
		"CVE-2010-3973",
		"BID-45546",
		"URL-http://wooyun.org/bug.php?action=view&id=1006",
		"URL-http://web.archive.org/web/20101228043011/http://secunia.com:80/advisories/42693",
		"URL-http://www.microsoft.com/downloads/en/details.aspx?FamilyID=6430f853-1120-48db-8cc5-f2abdc3ed314"
	],
	"platform": "Windows",
	"targets": [
		"Automatic",
		"Windows Universal",
		"Debug Target (Crash)"
	],
	"mod_time": "2023-03-23 10:19:30 +0000",
	"path": "/modules/exploits/windows/browser/wmi_admintools.rb",
	"is_install_path": true,
	"ref_name": "windows/browser/wmi_admintools"
}
