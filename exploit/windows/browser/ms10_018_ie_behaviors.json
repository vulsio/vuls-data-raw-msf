{
	"name": "MS10-018 Microsoft Internet Explorer DHTML Behaviors Use After Free",
	"fullname": "exploit/windows/browser/ms10_018_ie_behaviors",
	"rank": 400,
	"disclosure_date": "2010-03-09",
	"type": "exploit",
	"author": [
		"unknown",
		"Trancer <mtrancer@gmail.com>",
		"Nanika",
		"jduck <jduck@metasploit.com>"
	],
	"description": "This module exploits a use-after-free vulnerability within the DHTML behaviors\n        functionality of Microsoft Internet Explorer versions 6 and 7. This bug was\n        discovered being used in-the-wild and was previously known as the \"iepeers\"\n        vulnerability. The name comes from Microsoft's suggested workaround to block\n        access to the iepeers.dll file.\n\n        According to Nico Waisman, \"The bug itself is when trying to persist an object\n        using the setAttribute, which end up calling VariantChangeTypeEx with both the\n        source and the destination being the same variant. So if you send as a variant\n        an IDISPATCH the algorithm will try to do a VariantClear of the destination before\n        using it. This will end up on a call to PlainRelease which deref the reference\n        and clean the object.\"\n\n        NOTE: Internet Explorer 8 and Internet Explorer 5 are not affected.",
	"references": [
		"CVE-2010-0806",
		"OSVDB-62810",
		"BID-38615",
		"URL-https://web.archive.org/web/20100929225343/http://www.avertlabs.com/research/blog/index.php/2010/03/09/targeted-internet-explorer-0day-attack-announced-cve-2010-0806/",
		"URL-https://web.archive.org/web/20120627174253/http://eticanicomana.blogspot.com/2010/03/aleatory-persitent-threat.html",
		"MSB-MS10-018"
	],
	"platform": "Windows",
	"targets": [
		"(Automatic) IE6, IE7 on Windows NT, 2000, XP, 2003 and Vista",
		"IE 6 SP0-SP2 (onclick)",
		"IE 7.0 (marquee)"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/windows/browser/ms10_018_ie_behaviors.rb",
	"is_install_path": true,
	"ref_name": "windows/browser/ms10_018_ie_behaviors"
}
