{
	"name": "SonicWALL Aventail epi.dll AuthCredential Format String",
	"fullname": "exploit/windows/browser/aventail_epi_activex",
	"rank": 300,
	"disclosure_date": "2010-08-19",
	"type": "exploit",
	"author": [
		"Nikolas Sotiriu",
		"jduck <jduck@metasploit.com>"
	],
	"description": "This module exploits a format string vulnerability within version 10.0.4.x and\n        10.5.1 of the SonicWALL Aventail SSL-VPN Endpoint Interrogator/Installer ActiveX\n        control (epi.dll). By calling the 'AuthCredential' method with a specially\n        crafted Unicode format string, an attacker can cause memory corruption and\n        execute arbitrary code.\n\n        Unfortunately, it does not appear to be possible to indirectly re-use existing\n        stack data for more reliable exploitation. This is due to several particulars\n        about this vulnerability. First, the format string must be a Unicode string,\n        which uses two bytes per character. Second, the buffer is allocated on the\n        stack using the 'alloca' function. As such, each additional format specifier (%x)\n        will add four more bytes to the size allocated. This results in the inability to\n        move the read pointer outside of the buffer.\n\n        Further testing showed that using specifiers that pop more than four bytes does\n        not help. Any number of format specifiers will result in accessing the same value\n        within the buffer.\n\n        NOTE: It may be possible to leverage the vulnerability to leak memory contents.\n        However, that has not been fully investigated at this time.",
	"references": [
		"OSVDB-67286",
		"URL-http://sotiriu.de/adv/NSOADV-2010-005.txt"
	],
	"platform": "Windows",
	"targets": [
		"epi.dll v10.0.4.18 on Windows XP SP3"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/windows/browser/aventail_epi_activex.rb",
	"is_install_path": true,
	"ref_name": "windows/browser/aventail_epi_activex"
}
