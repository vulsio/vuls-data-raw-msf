{
  "name": "MS04-007 Microsoft ASN.1 Library Bitstring Heap Overflow",
  "fullname": "exploit/windows/smb/ms04_007_killbill",
  "rank": 100,
  "disclosure_date": "2004-02-10",
  "type": "exploit",
  "author": [
    "Solar Eclipse <solareclipse@phreedom.org>"
  ],
  "description": "This is an exploit for a previously undisclosed\n        vulnerability in the bit string decoding code in the\n        Microsoft ASN.1 library. This vulnerability is not related\n        to the bit string vulnerability described in eEye advisory\n        AD20040210-2. Both vulnerabilities were fixed in the\n        MS04-007 patch.  Windows 2000 SP4 Rollup 1 also patches this\n        vulnerability.\n\n        You are only allowed one attempt with this vulnerability. If\n        the payload fails to execute, the LSASS system service will\n        crash and the target system will automatically reboot itself\n        in 60 seconds. If the payload succeeds, the system will no\n        longer be able to process authentication requests, denying\n        all attempts to login through SMB or at the console. A\n        reboot is required to restore proper functioning of an\n        exploited system.\n\n        This exploit has been successfully tested with the win32/*/reverse_tcp\n        payloads, however a few problems were encountered when using the\n        equivalent bind payloads. Your mileage may vary.",
  "references": [
    "CVE-2003-0818",
    "OSVDB-3902",
    "BID-9633",
    "MSB-MS04-007"
  ],
  "platform": "Windows",
  "rport": 445,
  "autofilter_ports": [
    139,
    445
  ],
  "autofilter_services": [
    "netbios-ssn",
    "microsoft-ds"
  ],
  "targets": [
    "Windows 2000 SP2-SP4 + Windows XP SP0-SP1"
  ],
  "mod_time": "2022-07-10 00:07:26 +0000",
  "path": "/modules/exploits/windows/smb/ms04_007_killbill.rb",
  "is_install_path": true,
  "ref_name": "windows/smb/ms04_007_killbill",
  "notes": {
    "AKA": [
      "kill-bill"
    ],
    "Reliability": [
      "unreliable-session"
    ],
    "Stability": [
      "crash-os-restarts",
      "crash-service-down"
    ]
  }
}
