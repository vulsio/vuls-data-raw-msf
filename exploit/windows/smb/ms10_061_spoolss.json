{
  "name": "MS10-061 Microsoft Print Spooler Service Impersonation Vulnerability",
  "fullname": "exploit/windows/smb/ms10_061_spoolss",
  "rank": 600,
  "disclosure_date": "2010-09-14",
  "type": "exploit",
  "author": [
    "jduck <jduck@metasploit.com>",
    "hdm <x@hdm.io>"
  ],
  "description": "This module exploits the RPC service impersonation vulnerability detailed in\n        Microsoft Bulletin MS10-061. By making a specific DCE RPC request to the\n        StartDocPrinter procedure, an attacker can impersonate the Printer Spooler service\n        to create a file. The working directory at the time is %SystemRoot%\\system32.\n        An attacker can specify any file name, including directory traversal or full paths.\n        By sending WritePrinter requests, an attacker can fully control the content of\n        the created file.\n\n        In order to gain code execution, this module writes to a directory used by Windows\n        Management Instrumentation (WMI) to deploy applications. This directory (Wbem\\Mof)\n        is periodically scanned and any new .mof files are processed automatically. This is\n        the same technique employed by the Stuxnet code found in the wild.",
  "references": [
    "OSVDB-67988",
    "CVE-2010-2729",
    "MSB-MS10-061"
  ],
  "platform": "Windows",
  "rport": 445,
  "autofilter_ports": [
    139,
    445
  ],
  "autofilter_services": [
    "netbios-ssn",
    "microsoft-ds"
  ],
  "targets": [
    "Windows Universal"
  ],
  "mod_time": "2021-01-13 11:51:16 +0000",
  "path": "/modules/exploits/windows/smb/ms10_061_spoolss.rb",
  "is_install_path": true,
  "ref_name": "windows/smb/ms10_061_spoolss"
}
