{
  "name": "MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption",
  "fullname": "exploit/windows/smb/ms17_010_eternalblue",
  "aliases": [
    "exploit/windows/smb/ms17_010_eternalblue_win8"
  ],
  "rank": 200,
  "disclosure_date": "2017-03-14",
  "type": "exploit",
  "author": [
    "Equation Group",
    "Shadow Brokers",
    "sleepya",
    "Sean Dillon <sean.dillon@risksense.com>",
    "Dylan Davis <dylan.davis@risksense.com>",
    "thelightcosine",
    "wvu <wvu@metasploit.com>",
    "agalway-r7",
    "cdelafuente-r7",
    "cdelafuente-r7",
    "agalway-r7"
  ],
  "description": "This module is a port of the Equation Group ETERNALBLUE exploit, part of\n          the FuzzBunch toolkit released by Shadow Brokers.\n\n          There is a buffer overflow memmove operation in Srv!SrvOs2FeaToNt. The size\n          is calculated in Srv!SrvOs2FeaListSizeToNt, with mathematical error where a\n          DWORD is subtracted into a WORD. The kernel pool is groomed so that overflow\n          is well laid-out to overwrite an SMBv1 buffer. Actual RIP hijack is later\n          completed in srvnet!SrvNetWskReceiveComplete.\n\n          This exploit, like the original may not trigger 100% of the time, and should be\n          run continuously until triggered. It seems like the pool will get hot streaks\n          and need a cool down period before the shells rain in again.\n\n          The module will attempt to use Anonymous login, by default, to authenticate to perform the\n          exploit. If the user supplies credentials in the SMBUser, SMBPass, and SMBDomain options it will use\n          those instead.\n\n          On some systems, this module may cause system instability and crashes, such as a BSOD or\n          a reboot. This may be more likely with some payloads.",
  "references": [
    "MSB-MS17-010",
    "CVE-2017-0143",
    "CVE-2017-0144",
    "CVE-2017-0145",
    "CVE-2017-0146",
    "CVE-2017-0147",
    "CVE-2017-0148",
    "URL-https://github.com/RiskSense-Ops/MS17-010",
    "URL-https://risksense.com/wp-content/uploads/2018/05/White-Paper_Eternal-Blue.pdf",
    "EDB-42030"
  ],
  "platform": "Windows",
  "arch": "x64",
  "rport": 445,
  "targets": [
    "Automatic Target",
    "Windows 7",
    "Windows Embedded Standard 7",
    "Windows Server 2008 R2",
    "Windows 8",
    "Windows 8.1",
    "Windows Server 2012",
    "Windows 10 Pro",
    "Windows 10 Enterprise Evaluation"
  ],
  "mod_time": "2023-07-14 12:46:26 +0000",
  "path": "/modules/exploits/windows/smb/ms17_010_eternalblue.rb",
  "is_install_path": true,
  "ref_name": "windows/smb/ms17_010_eternalblue",
  "check": true,
  "notes": {
    "AKA": [
      "ETERNALBLUE"
    ]
  }
}
