{
	"name": "MS08-067 Microsoft Server Service Relative Path Stack Corruption",
	"fullname": "exploit/windows/smb/ms08_067_netapi",
	"rank": 500,
	"disclosure_date": "2008-10-28",
	"type": "exploit",
	"author": [
		"hdm <x@hdm.io>",
		"Brett Moore <brett.moore@insomniasec.com>",
		"frank2 <frank2@dc949.org>",
		"jduck <jduck@metasploit.com>"
	],
	"description": "This module exploits a parsing flaw in the path canonicalization code of\n        NetAPI32.dll through the Server Service. This module is capable of bypassing\n        NX on some operating systems and service packs. The correct target must be\n        used to prevent the Server Service (along with a dozen others in the same\n        process) from crashing. Windows XP targets seem to handle multiple successful\n        exploitation events, but 2003 targets will often crash or hang on subsequent\n        attempts. This is just the first version of this module, full support for\n        NX bypass on 2003, along with other platforms, is still in development.",
	"references": [
		"CVE-2008-4250",
		"OSVDB-49243",
		"MSB-MS08-067",
		"URL-https://www.rapid7.com/db/vulnerabilities/dcerpc-ms-netapi-netpathcanonicalize-dos/"
	],
	"platform": "Windows",
	"rport": 445,
	"autofilter_ports": [
		139,
		445
	],
	"autofilter_services": [
		"netbios-ssn",
		"microsoft-ds"
	],
	"targets": [
		"Automatic Targeting",
		"Windows 2000 Universal",
		"Windows XP SP0/SP1 Universal",
		"Windows 2003 SP0 Universal",
		"Windows XP SP2 English (AlwaysOn NX)",
		"Windows XP SP2 English (NX)",
		"Windows XP SP3 English (AlwaysOn NX)",
		"Windows XP SP3 English (NX)",
		"Windows XP SP2 Arabic (NX)",
		"Windows XP SP2 Chinese - Traditional / Taiwan (NX)",
		"Windows XP SP2 Chinese - Simplified (NX)",
		"Windows XP SP2 Chinese - Traditional (NX)",
		"Windows XP SP2 Czech (NX)",
		"Windows XP SP2 Danish (NX)",
		"Windows XP SP2 German (NX)",
		"Windows XP SP2 Greek (NX)",
		"Windows XP SP2 Spanish (NX)",
		"Windows XP SP2 Finnish (NX)",
		"Windows XP SP2 French (NX)",
		"Windows XP SP2 Hebrew (NX)",
		"Windows XP SP2 Hungarian (NX)",
		"Windows XP SP2 Italian (NX)",
		"Windows XP SP2 Japanese (NX)",
		"Windows XP SP2 Korean (NX)",
		"Windows XP SP2 Dutch (NX)",
		"Windows XP SP2 Norwegian (NX)",
		"Windows XP SP2 Polish (NX)",
		"Windows XP SP2 Portuguese - Brazilian (NX)",
		"Windows XP SP2 Portuguese (NX)",
		"Windows XP SP2 Russian (NX)",
		"Windows XP SP2 Swedish (NX)",
		"Windows XP SP2 Turkish (NX)",
		"Windows XP SP3 Arabic (NX)",
		"Windows XP SP3 Chinese - Traditional / Taiwan (NX)",
		"Windows XP SP3 Chinese - Simplified (NX)",
		"Windows XP SP3 Chinese - Traditional (NX)",
		"Windows XP SP3 Czech (NX)",
		"Windows XP SP3 Danish (NX)",
		"Windows XP SP3 German (NX)",
		"Windows XP SP3 Greek (NX)",
		"Windows XP SP3 Spanish (NX)",
		"Windows XP SP3 Finnish (NX)",
		"Windows XP SP3 French (NX)",
		"Windows XP SP3 Hebrew (NX)",
		"Windows XP SP3 Hungarian (NX)",
		"Windows XP SP3 Italian (NX)",
		"Windows XP SP3 Japanese (NX)",
		"Windows XP SP3 Korean (NX)",
		"Windows XP SP3 Dutch (NX)",
		"Windows XP SP3 Norwegian (NX)",
		"Windows XP SP3 Polish (NX)",
		"Windows XP SP3 Portuguese - Brazilian (NX)",
		"Windows XP SP3 Portuguese (NX)",
		"Windows XP SP3 Russian (NX)",
		"Windows XP SP3 Swedish (NX)",
		"Windows XP SP3 Turkish (NX)",
		"Windows 2003 SP1 English (NO NX)",
		"Windows 2003 SP1 English (NX)",
		"Windows 2003 SP1 Japanese (NO NX)",
		"Windows 2003 SP1 Spanish (NO NX)",
		"Windows 2003 SP1 Spanish (NX)",
		"Windows 2003 SP1 French (NO NX)",
		"Windows 2003 SP1 French (NX)",
		"Windows 2003 SP2 English (NO NX)",
		"Windows 2003 SP2 English (NX)",
		"Windows 2003 SP2 German (NO NX)",
		"Windows 2003 SP2 German (NX)",
		"Windows 2003 SP2 Portuguese (NX)",
		"Windows 2003 SP2 Portuguese - Brazilian (NX)",
		"Windows 2003 SP2 Spanish (NO NX)",
		"Windows 2003 SP2 Spanish (NX)",
		"Windows 2003 SP2 Japanese (NO NX)",
		"Windows 2003 SP2 French (NO NX)",
		"Windows 2003 SP2 French (NX)",
		"Windows 2003 SP2 Chinese - Simplified (NX)",
		"Windows 2003 SP2 Czech (NX)",
		"Windows 2003 SP2 Dutch (NX)",
		"Windows 2003 SP2 Hungarian (NX)",
		"Windows 2003 SP2 Italian (NX)",
		"Windows 2003 SP2 Russian (NX)",
		"Windows 2003 SP2 Swedish (NX)",
		"Windows 2003 SP2 Turkish (NX)"
	],
	"mod_time": "2023-07-10 16:54:42 +0000",
	"path": "/modules/exploits/windows/smb/ms08_067_netapi.rb",
	"is_install_path": true,
	"ref_name": "windows/smb/ms08_067_netapi",
	"check": true
}
