{
  "name": "MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow",
  "fullname": "exploit/windows/smb/ms06_040_netapi",
  "rank": 400,
  "disclosure_date": "2006-08-08",
  "type": "exploit",
  "author": [
    "hdm <x@hdm.io>"
  ],
  "description": "This module exploits a stack buffer overflow in the NetApi32 CanonicalizePathName() function\n        using the NetpwPathCanonicalize RPC call in the Server Service. It is likely that\n        other RPC calls could be used to exploit this service. This exploit will result in\n        a denial of service on Windows XP SP2 or Windows 2003 SP1. A failed exploit attempt\n        will likely result in a complete reboot on Windows 2000 and the termination of all\n        SMB-related services on Windows XP. The default target for this exploit should succeed\n        on Windows NT 4.0, Windows 2000 SP0-SP4+, Windows XP SP0-SP1 and Windows 2003 SP0.",
  "references": [
    "CVE-2006-3439",
    "OSVDB-27845",
    "BID-19409",
    "MSB-MS06-040"
  ],
  "platform": "Windows",
  "rport": 445,
  "autofilter_ports": [
    139,
    445
  ],
  "autofilter_services": [
    "netbios-ssn",
    "microsoft-ds"
  ],
  "targets": [
    "(wcscpy) Automatic (NT 4.0, 2000 SP0-SP4, XP SP0-SP1)",
    "(wcscpy) Windows NT 4.0 / Windows 2000 SP0-SP4",
    "(wcscpy) Windows XP SP0/SP1",
    "(stack)  Windows XP SP1 English",
    "(stack)  Windows XP SP1 Italian",
    "(wcscpy) Windows 2003 SP0"
  ],
  "mod_time": "2020-10-02 17:38:06 +0000",
  "path": "/modules/exploits/windows/smb/ms06_040_netapi.rb",
  "is_install_path": true,
  "ref_name": "windows/smb/ms06_040_netapi",
  "notes": {
    "Reliability": [
      "unreliable-session"
    ],
    "Stability": [
      "crash-os-restarts",
      "crash-service-down"
    ]
  }
}
