{
	"name": "Microsoft Windows RRAS Service MIBEntryGet Overflow",
	"fullname": "exploit/windows/smb/smb_rras_erraticgopher",
	"rank": 200,
	"disclosure_date": "2017-06-13",
	"type": "exploit",
	"author": [
		"Equation Group",
		"Shadow Brokers",
		"VÃ­ctor Portal",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module exploits an overflow in the Windows Routing and Remote\n          Access Service (RRAS) to execute code as SYSTEM.\n\n          The RRAS DCERPC endpoint is accessible to unauthenticated users via\n          SMBv1 browser named pipe on Windows Server 2003 and Windows XP hosts;\n          however, this module targets Windows Server 2003 only.\n\n          Since the service is hosted inside svchost.exe, a failed exploit\n          attempt can cause other system services to fail as well.\n\n          The module has been successfully tested on:\n\n          Windows Server 2003 SP0 (x86);\n          Windows Server 2003 SP1 (x86);\n          Windows Server 2003 SP2 (x86); and\n          Windows Server 2003 R2 SP2 (x86).",
	"references": [
		"CVE-2017-8461",
		"CWE-119",
		"BID-99012",
		"EDB-41929",
		"PACKETSTORM-147593",
		"URL-https://www.securitytracker.com/id/1038701",
		"URL-https://github.com/x0rz/EQGRP_Lost_in_Translation/blob/master/windows/exploits/Erraticgopher-1.0.1.0.xml",
		"URL-https://support.microsoft.com/en-us/topic/microsoft-security-advisory-4025685-guidance-for-older-platforms-june-13-2017-05151e8a-bd7f-f769-43df-38d2c24f96cd",
		"URL-https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa374540(v=vs.85)",
		"URL-https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrasm/ebc5c709-36d8-4520-a0ac-6f36d2d6c0b2",
		"URL-https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrasm/5dca234b-bea4-4e67-958e-5459a32a7b71",
		"URL-https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrasm/4305d67f-9273-49fe-a067-909b6ae8a341",
		"URL-https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrasm/3ca0723e-36ea-448a-a97e-1906dd3d07a6",
		"URL-https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrasm/dda988f0-4cce-4ffe-b8c9-d5199deafba5",
		"URL-https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrasm/169e435d-a975-4c1c-bf41-55fd2bd76125"
	],
	"platform": "Windows",
	"arch": "x86",
	"rport": 445,
	"autofilter_ports": [
		139,
		445
	],
	"autofilter_services": [
		"netbios-ssn",
		"microsoft-ds"
	],
	"targets": [
		"Automatic",
		"Windows Server 2003 SP0 (English)",
		"Windows Server 2003 SP1 (English) (NX)",
		"Windows Server 2003 SP2 (English) (NX)",
		"Windows Server 2003 R2 SP2 (English) (NX)"
	],
	"mod_time": "2021-08-27 17:15:33 +0000",
	"path": "/modules/exploits/windows/smb/smb_rras_erraticgopher.rb",
	"is_install_path": true,
	"ref_name": "windows/smb/smb_rras_erraticgopher",
	"check": true,
	"notes": {
		"AKA": [
			"ErraticGopher"
		],
		"Reliability": [
			"unreliable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-service-down"
		]
	}
}
