{
  "name": "MS06-070 Microsoft Workstation Service NetpManageIPCConnect Overflow",
  "fullname": "exploit/windows/smb/ms06_070_wkssvc",
  "disclosure_date": "2006-11-14",
  "type": "exploit",
  "author": [
    "jduck <jduck@metasploit.com>"
  ],
  "description": "This module exploits a stack buffer overflow in the NetApi32 NetpManageIPCConnect\n        function using the Workstation service in Windows 2000 SP4 and Windows XP SP2.\n\n        In order to exploit this vulnerability, you must specify the name of a\n        valid Windows DOMAIN. It may be possible to satisfy this condition by using\n        a custom DNS and LDAP setup, however that method is not covered here.\n\n        Although Windows XP SP2 is vulnerable, Microsoft reports that Administrator\n        credentials are required to reach the vulnerable code. Windows XP SP1 only\n        requires valid user credentials. Also, testing shows that a machine already\n        joined to a domain is not exploitable.",
  "references": [
    "CVE-2006-4691",
    "OSVDB-30263",
    "BID-20985",
    "MSB-MS06-070"
  ],
  "platform": "Windows",
  "rport": 445,
  "autofilter_ports": [
    139,
    445
  ],
  "autofilter_services": [
    "netbios-ssn",
    "microsoft-ds"
  ],
  "targets": [
    "Automatic Targetting",
    "Windows 2000 SP4",
    "Windows XP SP0/SP1"
  ],
  "mod_time": "2020-10-02 17:38:06 +0000",
  "path": "/modules/exploits/windows/smb/ms06_070_wkssvc.rb",
  "is_install_path": true,
  "ref_name": "windows/smb/ms06_070_wkssvc"
}
