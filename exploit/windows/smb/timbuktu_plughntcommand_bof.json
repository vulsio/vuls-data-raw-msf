{
	"name": "Timbuktu PlughNTCommand Named Pipe Buffer Overflow",
	"fullname": "exploit/windows/smb/timbuktu_plughntcommand_bof",
	"rank": 500,
	"disclosure_date": "2009-06-25",
	"type": "exploit",
	"author": [
		"bannedit <bannedit@metasploit.com>"
	],
	"description": "This module exploits a stack based buffer overflow in Timbuktu Pro version <= 8.6.6\n        in a pretty novel way.\n\n        This exploit requires two connections. The first connection is used to leak stack data\n        using the buffer overflow to overwrite the nNumberOfBytesToWrite argument. By supplying\n        a large value for this argument it is possible to cause Timbuktu to reply to the initial\n        request with leaked stack data. Using this data allows for reliable exploitation of the\n        buffer overflow vulnerability.\n\n        Props to Infamous41d for helping in finding this exploitation path.\n\n        The second connection utilizes the data from the data leak to accurately exploit\n        the stack based buffer overflow vulnerability.\n\n        TODO:\n        hdm suggested using meterpreter's migration capability and restarting the process\n        for multishot exploitation.",
	"references": [
		"CVE-2009-1394",
		"OSVDB-55436",
		"BID-35496",
		"URL-http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=809"
	],
	"platform": "Windows",
	"rport": 445,
	"autofilter_ports": [
		139,
		445
	],
	"autofilter_services": [
		"netbios-ssn",
		"microsoft-ds"
	],
	"targets": [
		"Automatic Targeting"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/windows/smb/timbuktu_plughntcommand_bof.rb",
	"is_install_path": true,
	"ref_name": "windows/smb/timbuktu_plughntcommand_bof"
}
