{
	"name": "ElasticSearch Search Groovy Sandbox Bypass",
	"fullname": "exploit/multi/elasticsearch/search_groovy_script",
	"rank": 600,
	"disclosure_date": "2015-02-11",
	"type": "exploit",
	"author": [
		"Cameron Morris",
		"Darren Martyn",
		"juan vazquez <juan.vazquez@metasploit.com>"
	],
	"description": "This module exploits a remote command execution (RCE) vulnerability in ElasticSearch,\n        exploitable by default on ElasticSearch prior to 1.4.3. The bug is found in the\n        REST API, which does not require authentication, where the search function allows\n        groovy code execution and its sandbox can be bypassed using java.lang.Math.class.forName\n        to reference arbitrary classes. It can be used to execute arbitrary Java code. This\n        module has been tested successfully on ElasticSearch 1.4.2 on Ubuntu Server 12.04.",
	"references": [
		"CVE-2015-1427",
		"URL-https://jordan-wright.github.io/blog/2015/03/08/elasticsearch-rce-vulnerability-cve-2015-1427/",
		"URL-https://github.com/XiphosResearch/exploits/tree/master/ElasticSearch",
		"URL-http://drops.wooyun.org/papers/5107"
	],
	"platform": "Java",
	"arch": "java",
	"rport": 9200,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"ElasticSearch 1.4.2"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/multi/elasticsearch/search_groovy_script.rb",
	"is_install_path": true,
	"ref_name": "multi/elasticsearch/search_groovy_script",
	"check": true,
	"needs_cleanup": true
}
