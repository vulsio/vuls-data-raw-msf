{
	"name": "Ghostscript Failed Restore Command Execution",
	"fullname": "exploit/multi/fileformat/ghostscript_failed_restore",
	"rank": 600,
	"disclosure_date": "2018-08-21",
	"type": "exploit",
	"author": [
		"Tavis Ormandy",
		"wvu <wvu@metasploit.com>"
	],
	"description": "This module exploits a -dSAFER bypass in Ghostscript to execute\n        arbitrary commands by handling a failed restore (grestore) in\n        PostScript to disable LockSafetyParams and avoid invalidaccess.\n\n        This vulnerability is reachable via libraries such as ImageMagick.",
	"references": [
		"CVE-2018-16509",
		"URL-https://seclists.org/oss-sec/2018/q3/142",
		"URL-https://bugs.chromium.org/p/project-zero/issues/detail?id=1640"
	],
	"platform": "Linux,Unix,Windows",
	"arch": "cmd, x86, x64",
	"targets": [
		"Unix (In-Memory)",
		"PowerShell (In-Memory)",
		"Linux (Dropper)"
	],
	"mod_time": "2023-03-13 10:31:27 +0000",
	"path": "/modules/exploits/multi/fileformat/ghostscript_failed_restore.rb",
	"is_install_path": true,
	"ref_name": "multi/fileformat/ghostscript_failed_restore",
	"notes": {
		"RelatedModules": [
			"exploit/unix/fileformat/ghostscript_type_confusion",
			"exploit/unix/fileformat/imagemagick_delegate"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
