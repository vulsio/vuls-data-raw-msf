{
  "name": "Bitbucket Environment Variable RCE",
  "fullname": "exploit/multi/http/bitbucket_env_var_rce",
  "rank": 600,
  "disclosure_date": "2022-11-16",
  "type": "exploit",
  "author": [
    "Ry0taK",
    "y4er",
    "Shelby Pace"
  ],
  "description": "For various versions of Bitbucket, there is an authenticated command injection\n          vulnerability that can be exploited by injecting environment\n          variables into a user name. This module achieves remote code execution\n          as the `atlbitbucket` user by injecting the `GIT_EXTERNAL_DIFF` environment\n          variable, a null character as a delimiter, and arbitrary code into a user's\n          user name. The value (payload) of the `GIT_EXTERNAL_DIFF` environment variable\n          will be run once the Bitbucket application is coerced into generating a diff.\n\n          This module requires at least admin credentials, as admins and above\n          only have the option to change their user name.",
  "references": [
    "URL-https://y4er.com/posts/cve-2022-43781-bitbucket-server-rce/",
    "URL-https://confluence.atlassian.com/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html",
    "CVE-2022-43781"
  ],
  "platform": "Linux,Unix,Windows",
  "arch": "cmd, x86, x64",
  "rport": 7990,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Linux Command",
    "Linux Dropper",
    "Windows Dropper"
  ],
  "mod_time": "2023-03-15 11:18:03 +0000",
  "path": "/modules/exploits/multi/http/bitbucket_env_var_rce.rb",
  "is_install_path": true,
  "ref_name": "multi/http/bitbucket_env_var_rce",
  "check": true,
  "post_auth": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
