{
	"name": "Apache Solr Remote Code Execution via Velocity Template",
	"fullname": "exploit/multi/http/solr_velocity_rce",
	"rank": 600,
	"disclosure_date": "2019-10-29",
	"type": "exploit",
	"author": [
		"s00py",
		"jas502n",
		"AleWong",
		"Imran E. Dawoodjee <imran@threathounds.com>"
	],
	"description": "This module exploits a vulnerability in Apache Solr <= 8.3.0 which allows remote code execution via a custom\n          Velocity template. Currently, this module only supports Solr basic authentication.\n\n          From the Tenable advisory:\n          An attacker could target a vulnerable Apache Solr instance by first identifying a list\n          of Solr core names. Once the core names have been identified, an attacker can send a specially crafted\n          HTTP POST request to the Config API to toggle the params resource loader value for the Velocity Response\n          Writer in the solrconfig.xml file to true. Enabling this parameter would allow an attacker to use the Velocity\n          template parameter in a specially crafted Solr request, leading to RCE.",
	"references": [
		"EDB-47572",
		"CVE-2019-17558",
		"URL-https://www.tenable.com/blog/apache-solr-vulnerable-to-remote-code-execution-zero-day-vulnerability",
		"URL-https://www.huaweicloud.com/en-us/notice/2018/20191104170849387.html",
		"URL-https://gist.github.com/s00py/a1ba36a3689fa13759ff910e179fc133/",
		"URL-https://github.com/jas502n/solr_rce",
		"URL-https://github.com/AleWong/Apache-Solr-RCE-via-Velocity-template"
	],
	"platform": "Linux,Unix,Windows",
	"rport": 8983,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Java (in-memory)",
		"Unix (in-memory)",
		"Linux (dropper)",
		"x86/x64 Windows PowerShell",
		"x86/x64 Windows CmdStager",
		"Windows Exec"
	],
	"mod_time": "2023-02-10 18:04:31 +0000",
	"path": "/modules/exploits/multi/http/solr_velocity_rce.rb",
	"is_install_path": true,
	"ref_name": "multi/http/solr_velocity_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"config-changes",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
