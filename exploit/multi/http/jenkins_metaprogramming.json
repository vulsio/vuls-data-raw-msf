{
  "name": "Jenkins ACL Bypass and Metaprogramming RCE",
  "fullname": "exploit/multi/http/jenkins_metaprogramming",
  "rank": 600,
  "disclosure_date": "2019-01-08",
  "type": "exploit",
  "author": [
    "Orange Tsai",
    "Mikhail Egorov",
    "George Noseevich",
    "wvu <wvu@metasploit.com>"
  ],
  "description": "This module exploits a vulnerability in Jenkins dynamic routing to\n        bypass the Overall/Read ACL and leverage Groovy metaprogramming to\n        download and execute a malicious JAR file.\n\n        When the \"Java Dropper\" target is selected, the original entry point\n        based on classLoader.parseClass is used, which requires the use of\n        Groovy metaprogramming to achieve RCE.\n\n        When the \"Unix In-Memory\" target is selected, a newer, higher-level,\n        and more universal entry point based on GroovyShell.parse is used.\n        This permits the use of in-memory arbitrary command execution.\n\n        The ACL bypass gadget is specific to Jenkins <= 2.137 and will not work\n        on later versions of Jenkins.\n\n        Tested against Jenkins 2.137 and Pipeline: Groovy Plugin 2.61.",
  "references": [
    "CVE-2018-1000861",
    "CVE-2019-1003000",
    "CVE-2019-1003001",
    "CVE-2019-1003002",
    "CVE-2019-1003005",
    "CVE-2019-1003029",
    "EDB-46427",
    "URL-https://jenkins.io/security/advisory/2019-01-08/",
    "URL-https://blog.orange.tw/2019/01/hacking-jenkins-part-1-play-with-dynamic-routing.html",
    "URL-https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html",
    "URL-https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc",
    "URL-https://twitter.com/orange_8361/status/1126829648552312832",
    "URL-https://github.com/orangetw/awesome-jenkins-rce-2019"
  ],
  "platform": "Java,Unix",
  "arch": "cmd, java",
  "rport": 8080,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Unix In-Memory",
    "Java Dropper"
  ],
  "mod_time": "2021-02-17 12:33:59 +0000",
  "path": "/modules/exploits/multi/http/jenkins_metaprogramming.rb",
  "is_install_path": true,
  "ref_name": "multi/http/jenkins_metaprogramming",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "needs_cleanup": true
}
