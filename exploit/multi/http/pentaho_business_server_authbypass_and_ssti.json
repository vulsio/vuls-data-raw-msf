{
	"name": "Pentaho Business Server Auth Bypass and Server Side Template Injection RCE",
	"fullname": "exploit/multi/http/pentaho_business_server_authbypass_and_ssti",
	"rank": 600,
	"disclosure_date": "2023-04-04",
	"type": "exploit",
	"author": [
		"Harry Withington",
		"dwbzn",
		"jheysel-r7"
	],
	"description": "Hitachi Vantara Pentaho Business Analytics Server prior to versions 9.4.0.1 and 9.3.0.2, including 8.3.x is\n          vulnerable to an authentication bypass (CVE-2022-43939) and a Server Side Template Injection (SSTI) vulnerability\n          (CVE-2022-43769) that can be chained together to achieve unauthenticated code execution as the user\n          running the Pentaho Business Analytics Server.\n\n          The first vulnerability (CVE-2022-43939) is an authentication bypass which stems from a regex that allows any\n          URL that ends in \"/\", followed by \"require\", optionally \"-js\" or \"-cfg\", any character, and then the string\n          \"js\" followed optionally by \"?\" and then any characters of the attacker's choice.\n\n          The second (CVE-2022-43769) is a server side\n          template injection. This vulnerability allows RCE by making a GET request to /api/ldap/config/ldapTreeNodeChildren and\n          setting the url parameter to ThymeLeaf template code. By abusing the ability to execute arbitrary Java classes within\n          Thymeleaf templates, an attacker can execute arbitrary commands as the user running the Pentaho Business Analytics Server.",
	"references": [
		"URL-https://github.com/dwbzn/pentaho-exploits/blob/main/cve-2022-43769.py",
		"URL-https://research.aurainfosec.io/pentest/pentah0wnage/",
		"URL-https://support.pentaho.com/hc/en-us/articles/14455561548301",
		"CVE-2022-43769",
		"CVE-2022-43939"
	],
	"platform": "Unix,Windows",
	"arch": "cmd, x86, x64",
	"rport": 8080,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Unix Command",
		"Linux Dropper",
		"Windows Command",
		"Windows Dropper"
	],
	"mod_time": "2023-05-10 13:02:02 +0000",
	"path": "/modules/exploits/multi/http/pentaho_business_server_authbypass_and_ssti.rb",
	"is_install_path": true,
	"ref_name": "multi/http/pentaho_business_server_authbypass_and_ssti",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
