{
	"name": "Shopware createInstanceFromNamedArguments PHP Object Instantiation RCE",
	"fullname": "exploit/multi/http/shopware_createinstancefromnamedarguments_rce",
	"rank": 600,
	"disclosure_date": "2019-05-09",
	"type": "exploit",
	"author": [
		"Karim Ouerghemmi",
		"mr_me <steven@srcincite.io>"
	],
	"description": "This module exploits a php object instantiation vulnerability that can lead to RCE in\n        Shopware. An authenticated backend user could exploit the vulnerability.\n\n        The vulnerability exists in the createInstanceFromNamedArguments function, where the code\n        insufficiently performs whitelist check which can be bypassed to trigger an object injection.\n\n        An attacker can leverage this to deserialize an arbitrary payload and write a webshell to\n        the target system, resulting in remote code execution.\n\n        Tested on Shopware git branches 5.6, 5.5, 5.4, 5.3.",
	"references": [
		"CVE-2019-12799",
		"CVE-2017-18357",
		"URL-https://blog.ripstech.com/2017/shopware-php-object-instantiation-to-blind-xxe/"
	],
	"platform": "PHP",
	"arch": "php",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/multi/http/shopware_createinstancefromnamedarguments_rce.rb",
	"is_install_path": true,
	"ref_name": "multi/http/shopware_createinstancefromnamedarguments_rce",
	"check": true,
	"post_auth": true,
	"needs_cleanup": true
}
