{
	"name": "Intelliants Subrion CMS 4.2.1 - Authenticated File Upload Bypass to RCE",
	"fullname": "exploit/multi/http/subrion_cms_file_upload_rce",
	"rank": 600,
	"disclosure_date": "2018-11-04",
	"type": "exploit",
	"author": [
		"Hexife",
		"Fellipe Oliveira",
		"Ismail E. Dawoodjee"
	],
	"description": "This module exploits an authenticated file upload vulnerability in\n          Subrion CMS versions 4.2.1 and lower. The vulnerability is caused by\n          the .htaccess file not preventing the execution of .pht, .phar, and\n          .xhtml files. Files with these extensions are not included in the\n          .htaccess blacklist, hence these files can be uploaded and executed\n          to achieve remote code execution. In this module, a .phar file with\n          a randomized name is uploaded and executed to receive a Meterpreter\n          session on the target, then deletes itself afterwards.",
	"references": [
		"EDB-49876",
		"CVE-2018-19422",
		"URL-https://github.com/intelliants/subrion/issues/801",
		"URL-https://github.com/intelliants/subrion/issues/840",
		"URL-https://github.com/advisories/GHSA-73xj-v6gc-g5p5"
	],
	"platform": "PHP",
	"arch": "php",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"PHP"
	],
	"mod_time": "2023-08-02 10:10:27 +0000",
	"path": "/modules/exploits/multi/http/subrion_cms_file_upload_rce.rb",
	"is_install_path": true,
	"ref_name": "multi/http/subrion_cms_file_upload_rce",
	"check": true,
	"post_auth": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
