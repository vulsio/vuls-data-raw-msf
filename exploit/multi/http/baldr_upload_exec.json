{
	"name": "Baldr Botnet Panel Shell Upload Exploit",
	"fullname": "exploit/multi/http/baldr_upload_exec",
	"rank": 600,
	"disclosure_date": "2018-12-19",
	"type": "exploit",
	"author": [
		"Ege BalcÄ± <egebalci@pm.me>"
	],
	"description": "This module exploits an arbitrary file upload vulnerability within the Baldr\n          stealer malware control panel when uploading victim log files (which are uploaded\n          as ZIP files). Attackers can turn this vulnerability into an RCE by first\n          registering a new bot to the panel and then uploading a ZIP file containing\n          malicious PHP, which will then uploaded to a publicly accessible\n          directory underneath the /logs web directory.\n\n          Note that on versions 3.0 and 3.1 the ZIP files containing the victim log files\n          are encoded by XORing them with a random 4 byte key. This exploit module gets around\n          this restriction by retrieving the IP specific XOR key from panel gate before\n          uploading the malicious ZIP file.",
	"references": [
		"URL-https://krabsonsecurity.com/2019/06/04/taking-a-look-at-baldr-stealer/",
		"URL-https://blog.malwarebytes.com/threat-analysis/2019/04/say-hello-baldr-new-stealer-market/",
		"URL-https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/baldr-vs-the-world.pdf"
	],
	"platform": "PHP",
	"arch": "php",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Auto",
		"<= v2.0",
		"v2.2",
		"v3.0 & v3.1"
	],
	"mod_time": "2021-08-27 17:15:33 +0000",
	"path": "/modules/exploits/multi/http/baldr_upload_exec.rb",
	"is_install_path": true,
	"ref_name": "multi/http/baldr_upload_exec",
	"check": true,
	"needs_cleanup": true
}
