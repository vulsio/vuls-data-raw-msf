{
	"name": "PyTorch Model Server Registration and Deserialization RCE",
	"fullname": "exploit/multi/http/torchserver_cve_2023_43654",
	"rank": 600,
	"disclosure_date": "2023-10-03",
	"type": "exploit",
	"author": [
		"Idan Levcovich",
		"Guy Kaplan",
		"Gal Elbaz",
		"Swapneil Kumar Dash",
		"Spencer McIntyre"
	],
	"description": "The PyTorch model server contains multiple vulnerabilities that can be chained together to permit an\n        unauthenticated remote attacker arbitrary Java code execution. The first vulnerability is that the management\n        interface is bound to all IP addresses and not just the loop back interface as the documentation suggests. The\n        second vulnerability (CVE-2023-43654) allows attackers with access to the management interface to register MAR\n        model files from arbitrary servers. The third vulnerability is that when an MAR file is loaded, it can contain a\n        YAML configuration file that when deserialized by snakeyaml, can lead to loading an arbitrary Java class.",
	"references": [
		"URL-https://www.oligo.security/blog/shelltorch-torchserve-ssrf-vulnerability-cve-2023-43654",
		"CVE-2023-43654",
		"URL-https://github.com/pytorch/serve/security/advisories/GHSA-8fxr-qfr9-p34w",
		"CVE-2022-1471",
		"URL-https://github.com/google/security-research/security/advisories/GHSA-mjmj-j48q-9wg2",
		"URL-https://bitbucket.org/snakeyaml/snakeyaml/issues/561/cve-2022-1471-vulnerability-in",
		"URL-https://swapneildash.medium.com/snakeyaml-deserilization-exploited-b4a2c5ac0858"
	],
	"rport": 8081,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic"
	],
	"mod_time": "2024-06-14 12:05:12 +0000",
	"path": "/modules/exploits/multi/http/torchserver_cve_2023_43654.rb",
	"is_install_path": true,
	"ref_name": "multi/http/torchserver_cve_2023_43654",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
