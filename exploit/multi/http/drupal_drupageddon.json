{
  "name": "Drupal HTTP Parameter Key/Value SQL Injection",
  "fullname": "exploit/multi/http/drupal_drupageddon",
  "rank": 600,
  "disclosure_date": "2014-10-15",
  "type": "exploit",
  "author": [
    "SektionEins",
    "WhiteWinterWolf",
    "Christian Mehlmauer <FireFart@gmail.com>",
    "Brandon Perry"
  ],
  "description": "This module exploits the Drupal HTTP Parameter Key/Value SQL Injection\n        (aka Drupageddon) in order to achieve a remote shell on the vulnerable\n        instance. This module was tested against Drupal 7.0 and 7.31 (was fixed\n        in 7.32).\n\n        Two methods are available to trigger the PHP payload on the target:\n\n        - set TARGET 0:\n          Form-cache PHP injection method (default).\n          This uses the SQLi to upload a malicious form to Drupal's cache,\n          then trigger the cache entry to execute the payload using a POP chain.\n\n        - set TARGET 1:\n          User-post injection method.\n          This creates a new Drupal user, adds it to the administrators group,\n          enable Drupal's PHP module, grant the administrators the right to\n          bundle PHP code in their post, create a new post containing the\n          payload and preview it to trigger the payload execution.",
  "references": [
    "CVE-2014-3704",
    "URL-https://www.drupal.org/SA-CORE-2014-005",
    "URL-http://www.sektioneins.de/en/advisories/advisory-012014-drupal-pre-auth-sql-injection-vulnerability.html",
    "URL-https://www.whitewinterwolf.com/posts/2017/11/16/drupageddon-revisited-a-new-path-from-sql-injection-to-remote-command-execution-cve-2014-3704/"
  ],
  "platform": "PHP",
  "arch": "php",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Drupal 7.0 - 7.31 (form-cache PHP injection method)",
    "Drupal 7.0 - 7.31 (user-post PHP injection method)"
  ],
  "mod_time": "2023-03-13 10:31:27 +0000",
  "path": "/modules/exploits/multi/http/drupal_drupageddon.rb",
  "is_install_path": true,
  "ref_name": "multi/http/drupal_drupageddon",
  "notes": {
    "AKA": [
      "Drupageddon"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
