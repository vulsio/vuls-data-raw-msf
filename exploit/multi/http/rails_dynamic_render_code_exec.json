{
  "name": "Ruby on Rails Dynamic Render File Upload Remote Code Execution",
  "fullname": "exploit/multi/http/rails_dynamic_render_code_exec",
  "rank": 600,
  "disclosure_date": "2016-10-16",
  "type": "exploit",
  "author": [
    "mr_me <mr_me@offensive-security.com>",
    "John Poulin (forced-request)"
  ],
  "description": "This module exploits a remote code execution vulnerability in the explicit render\n        method when leveraging user parameters.\n        This module has been tested across multiple versions of Ruby on Rails.\n        The technique used by this module requires the specified\n        endpoint to be using dynamic render paths, such as the following example:\n\n        def show\n          render params[:id]\n        end\n\n        Also, the vulnerable target will need a POST endpoint for the TempFile upload, this\n        can literally be any endpoint. This module doesnt use the log inclusion method of\n        exploitation due to it not being universal enough. Instead, a new code injection\n        technique was found and used whereby an attacker can upload temporary image files\n        against any POST endpoint and use them for the inclusion attack. Finally, you only\n        get one shot at this if you are testing with the builtin rails server, use caution.",
  "references": [
    "CVE-2016-0752",
    "URL-https://groups.google.com/forum/#!topic/rubyonrails-security/335P1DcLG00",
    "URL-https://nvisium.com/blog/2016/01/26/rails-dynamic-render-to-rce-cve-2016-0752/",
    "URL-https://gist.github.com/forced-request/5158759a6418e6376afb"
  ],
  "platform": "BSD,Linux",
  "arch": "x86",
  "rport": 3000,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Ruby on Rails 4.0.8 July 2, 2014"
  ],
  "mod_time": "2020-10-02 17:38:06 +0000",
  "path": "/modules/exploits/multi/http/rails_dynamic_render_code_exec.rb",
  "is_install_path": true,
  "ref_name": "multi/http/rails_dynamic_render_code_exec",
  "check": true,
  "needs_cleanup": true
}
