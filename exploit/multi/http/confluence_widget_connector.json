{
	"name": "Atlassian Confluence Widget Connector Macro Velocity Template Injection",
	"fullname": "exploit/multi/http/confluence_widget_connector",
	"rank": 600,
	"disclosure_date": "2019-03-25",
	"type": "exploit",
	"author": [
		"Daniil Dmitriev",
		"Dmitry (rrock) Shchannikov"
	],
	"description": "Widget Connector Macro is part of Atlassian Confluence Server and Data Center that\n          allows embed online videos, slideshows, photostreams and more directly into page.\n          A _template parameter can be used to inject remote Java code into a Velocity template,\n          and gain code execution. Authentication is unrequired to exploit this vulnerability.\n          By default, Java payload will be used because it is cross-platform, but you can also\n          specify which native payload you want (Linux or Windows).\n\n          Confluence before version 6.6.12, from version 6.7.0 before 6.12.3, from version\n          6.13.0 before 6.13.3 and from version 6.14.0 before 6.14.2 are affected.\n\n          This vulnerability was originally discovered by Daniil Dmitriev\n          https://twitter.com/ddv_ua.",
	"references": [
		"CVE-2019-3396",
		"URL-https://confluence.atlassian.com/doc/confluence-security-advisory-2019-03-20-966660264.html",
		"URL-https://chybeta.github.io/2019/04/06/Analysis-for-%E3%80%90CVE-2019-3396%E3%80%91-SSTI-and-RCE-in-Confluence-Server-via-Widget-Connector/",
		"URL-https://paper.seebug.org/886/"
	],
	"rport": 8090,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Java",
		"Windows",
		"Linux"
	],
	"mod_time": "2022-07-01 08:43:47 +0000",
	"path": "/modules/exploits/multi/http/confluence_widget_connector.rb",
	"is_install_path": true,
	"ref_name": "multi/http/confluence_widget_connector",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
