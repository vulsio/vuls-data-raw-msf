{
  "name": "ATutor 2.2.4 - Directory Traversal / Remote Code Execution, ",
  "fullname": "exploit/multi/http/atutor_upload_traversal",
  "rank": 600,
  "disclosure_date": "2019-05-17",
  "type": "exploit",
  "author": [
    "liquidsky (JMcPeters)",
    "Erik Wynter"
  ],
  "description": "This module exploits an arbitrary file upload vulnerability together with\n          a directory traversal flaw in ATutor versions 2.2.4, 2.2.2 and 2.2.1 in\n          order to execute arbitrary commands.\n\n          It first creates a zip archive containing a malicious PHP file. The zip\n          archive takes advantage of a directory traversal vulnerability that will\n          cause the PHP file to be dropped in the root server directory (`htdocs`\n          for Windows and `html` for Linux targets). The PHP file contains an\n          encoded payload that allows for remote command execution on the\n          target server. The zip archive can be uploaded via two vectors, the\n          `Import New Language` function and the `Patcher` function. The module\n          first uploads the archive via `Import New Language` and then attempts to\n          execute the payload via an HTTP GET request to the PHP file  in the root\n          server directory. If no session is obtained, the module creates another\n          zip archive and attempts exploitation via `Patcher`.\n\n          Valid credentials for an ATutor admin account are required. This module\n          has been successfully tested against ATutor 2.2.4 running on Windows 10\n          (XAMPP server).",
  "references": [
    "CVE-2019-12169",
    "URL-https://github.com/fuzzlove/ATutor-2.2.4-Language-Exploit/"
  ],
  "platform": "Linux,Windows",
  "arch": "x86, x64",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Auto",
    "Linux",
    "Windows"
  ],
  "mod_time": "2023-02-03 18:12:53 +0000",
  "path": "/modules/exploits/multi/http/atutor_upload_traversal.rb",
  "is_install_path": true,
  "ref_name": "multi/http/atutor_upload_traversal",
  "check": true,
  "post_auth": true,
  "notes": {
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "needs_cleanup": true
}
