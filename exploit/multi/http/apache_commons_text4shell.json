{
	"name": "Apache Commons Text RCE",
	"fullname": "exploit/multi/http/apache_commons_text4shell",
	"rank": 600,
	"disclosure_date": "2022-10-13",
	"type": "exploit",
	"author": [
		"Alvaro Muñoz",
		"Karthik UJ",
		"Gaurav Jain"
	],
	"description": "This exploit takes advantage of the StringSubstitutor interpolator class,\n          which is included in the Commons Text library. A default interpolator\n          allows for string lookups that can lead to Remote Code Execution. This\n          is due to a logic flaw that makes the “script”, “dns” and “url” lookup\n          keys interpolated by default, as opposed to what it should be, according\n          to the documentation of the StringLookupFactory class. Those keys allow\n          an attacker to execute arbitrary code via lookups primarily using the\n          \"script\" key.\n\n          In order to exploit the vulnerabilities, the following requirements must\n          be met:\n\n          Run a version of Apache Commons Text from version 1.5 to 1.9\n          Use the StringSubstitutor interpolator\n          Target should run JDK < 15",
	"references": [
		"CVE-2022-42889",
		"URL-https://sysdig.com/blog/cve-2022-42889-text4shell/",
		"URL-https://github.com/karthikuj/cve-2022-42889-text4shell-docker"
	],
	"platform": "Java,Linux,Unix,Windows",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Java (in-memory)",
		"Windows EXE Dropper",
		"Windows Command",
		"Unix Command",
		"Linux Dropper"
	],
	"mod_time": "2024-06-14 12:05:12 +0000",
	"path": "/modules/exploits/multi/http/apache_commons_text4shell.rb",
	"is_install_path": true,
	"ref_name": "multi/http/apache_commons_text4shell",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
