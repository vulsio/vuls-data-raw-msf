{
  "name": "HorizontCMS Arbitrary PHP File Upload",
  "fullname": "exploit/multi/http/horizontcms_upload_exec",
  "rank": 600,
  "disclosure_date": "2020-09-24",
  "type": "exploit",
  "author": [
    "Erik Wynter"
  ],
  "description": "This module exploits an arbitrary file upload vulnerability in\n          HorizontCMS 1.0.0-beta in order to execute arbitrary commands.\n\n          The module first attempts to authenticate to HorizontCMS. It then tries\n          to upload a malicious PHP file via an HTTP POST request to\n          `/admin/file-manager/fileupload`. The server will rename this file to a\n          random string. The module will therefore attempt to change the filename\n          back to the original name via an HTTP POST request to\n          `/admin/file-manager/rename`. For the `php` target, the payload is\n          embedded in the uploaded file and the module attempts to execute the\n          payload via an HTTP GET request to `/storage/file_name`. For the `linux`\n          and `windows` targets, the module uploads a simple PHP web shell\n          similar to `<?php system($_GET[\"cmd\"]); ?>`. Subsequently, it leverages\n          the CmdStager mixin to deliver the final payload via a series of HTTP\n          GET requests to the PHP web shell.\n\n          Valid credentials for a HorizontCMS user with permissions to use the\n          FileManager are required. This would be all users in the Admin, Manager\n          and Editor groups if HorizontCMS is configured with the default group\n          settings.This module has been successfully tested against HorizontCMS\n          1.0.0-beta running on Ubuntu 18.04.",
  "references": [
    "CVE-2020-27387"
  ],
  "platform": "Linux,PHP,Windows",
  "arch": "x86, x64, php",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "PHP",
    "Linux",
    "Windows"
  ],
  "mod_time": "2021-08-27 17:15:33 +0000",
  "path": "/modules/exploits/multi/http/horizontcms_upload_exec.rb",
  "is_install_path": true,
  "ref_name": "multi/http/horizontcms_upload_exec",
  "check": true,
  "post_auth": true
}
