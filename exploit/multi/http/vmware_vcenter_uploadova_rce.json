{
	"name": "VMware vCenter Server Unauthenticated OVA File Upload RCE",
	"fullname": "exploit/multi/http/vmware_vcenter_uploadova_rce",
	"disclosure_date": "2021-02-23",
	"type": "exploit",
	"author": [
		"Mikhail Klyuchnikov",
		"wvu <wvu@metasploit.com>",
		"mr_me",
		"Viss"
	],
	"description": "This module exploits an unauthenticated OVA file upload and path\n          traversal in VMware vCenter Server to write a JSP payload to a\n          web-accessible directory.\n\n          Fixed versions are 6.5 Update 3n, 6.7 Update 3l, and 7.0 Update 1c.\n          Note that later vulnerable versions of the Linux appliance aren't\n          exploitable via the webshell technique. Furthermore, writing an SSH\n          public key to /home/vsphere-ui/.ssh/authorized_keys works, but the\n          user's non-existent password expires 90 days after install, rendering\n          the technique nearly useless against production environments.\n\n          You'll have the best luck targeting older versions of the Linux\n          appliance. The Windows target should work ubiquitously.",
	"references": [
		"CVE-2021-21972",
		"URL-https://www.vmware.com/security/advisories/VMSA-2021-0002.html",
		"URL-https://swarm.ptsecurity.com/unauth-rce-vmware/",
		"URL-https://twitter.com/jas502n/status/1364810720261496843",
		"URL-https://twitter.com/_0xf4n9x_/status/1364905040876503045",
		"URL-https://twitter.com/HackingLZ/status/1364636303606886403",
		"URL-https://kb.vmware.com/s/article/2143838",
		"URL-https://nmap.org/nsedoc/scripts/vmware-version.html"
	],
	"platform": "Linux,Windows",
	"arch": "java",
	"rport": 443,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"VMware vCenter Server <= 6.7 Update 1b (Linux)",
		"VMware vCenter Server <= 6.7 Update 3j (Windows)"
	],
	"mod_time": "2021-07-14 15:10:25 +0000",
	"path": "/modules/exploits/multi/http/vmware_vcenter_uploadova_rce.rb",
	"is_install_path": true,
	"ref_name": "multi/http/vmware_vcenter_uploadova_rce",
	"check": true,
	"notes": {
		"RelatedModules": [
			"auxiliary/scanner/vmware/esx_fingerprint"
		],
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs",
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
