{
	"name": "UniFi Network Application Unauthenticated JNDI Injection RCE (via Log4Shell)",
	"fullname": "exploit/multi/http/ubiquiti_unifi_log4shell",
	"rank": 600,
	"disclosure_date": "2021-12-09",
	"type": "exploit",
	"author": [
		"Spencer McIntyre",
		"RageLtMan <rageltman@sempervictus>",
		"Nicholas Anastasi"
	],
	"description": "The Ubiquiti UniFi Network Application versions 5.13.29 through 6.5.53 are affected by the Log4Shell\n        vulnerability whereby a JNDI string can be sent to the server via the 'remember' field of a POST request to the\n        /api/login endpoint that will cause the server to connect to the attacker and deserialize a malicious Java\n        object. This results in OS command execution in the context of the server application.\n\n        This module will start an LDAP server that the target will need to connect to.",
	"references": [
		"CVE-2021-44228",
		"URL-https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi",
		"URL-https://github.com/puzzlepeaches/Log4jUnifi",
		"URL-https://community.ui.com/releases/UniFi-Network-Application-6-5-54/d717f241-48bb-4979-8b10-99db36ddabe1"
	],
	"rport": 8443,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Windows",
		"Unix"
	],
	"mod_time": "2022-03-11 12:22:27 +0000",
	"path": "/modules/exploits/multi/http/ubiquiti_unifi_log4shell.rb",
	"is_install_path": true,
	"ref_name": "multi/http/ubiquiti_unifi_log4shell",
	"check": true,
	"notes": {
		"AKA": [
			"Log4Shell",
			"LogJam"
		],
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
