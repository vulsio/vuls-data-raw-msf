{
  "name": "PHP-FPM Underflow RCE",
  "fullname": "exploit/multi/http/php_fpm_rce",
  "rank": 300,
  "disclosure_date": "2019-10-22",
  "type": "exploit",
  "author": [
    "neex",
    "cdelafuente-r7"
  ],
  "description": "This module exploits an underflow vulnerability in versions 7.1.x\n          below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11 of PHP-FPM on\n          Nginx. Only servers with certains Nginx + PHP-FPM configurations are\n          exploitable. This is a port of the original neex's exploit code (see\n          refs.). First, it detects the correct parameters (Query String Length\n          and custom header length) needed to trigger code execution. This step\n          determines if the target is actually vulnerable (Check method). Then,\n          the exploit sets a series of PHP INI directives to create a file\n          locally on the target, which enables code execution through a query\n          string parameter. This is used to execute normal payload stagers.\n          Finally, this module does some cleanup by killing local PHP-FPM\n          workers (those are spawned automatically once killed) and removing\n          the created local file.",
  "references": [
    "CVE-2019-11043",
    "EDB-47553",
    "URL-https://github.com/neex/phuip-fpizdam",
    "URL-https://bugs.php.net/bug.php?id=78599",
    "URL-https://blog.orange.tw/2019/10/an-analysis-and-thought-about-recently.html"
  ],
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "PHP",
    "Shell Command"
  ],
  "mod_time": "2022-06-03 11:23:53 +0000",
  "path": "/modules/exploits/multi/http/php_fpm_rce.rb",
  "is_install_path": true,
  "ref_name": "multi/http/php_fpm_rce",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-service-restarts"
    ]
  }
}
