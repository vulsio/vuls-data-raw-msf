{
	"name": "Apache Struts ClassLoader Manipulation Remote Code Execution",
	"fullname": "exploit/multi/http/struts_code_exec_classloader",
	"disclosure_date": "2014-03-06",
	"type": "exploit",
	"author": [
		"Mark Thomas",
		"Przemyslaw Celej",
		"Redsadic <julian.vilas@gmail.com>",
		"Matthew Hall <hallm@sec-1.com>"
	],
	"description": "This module exploits a remote command execution vulnerability in Apache Struts versions\n        1.x (<= 1.3.10) and 2.x (< 2.3.16.2). In Struts 1.x the problem is related with\n        the ActionForm bean population mechanism while in case of Struts 2.x the vulnerability is due\n        to the ParametersInterceptor. Both allow access to 'class' parameter that is directly\n        mapped to getClass() method and allows ClassLoader manipulation. As a result, this can\n        allow remote attackers to execute arbitrary Java code via crafted parameters.",
	"references": [
		"CVE-2014-0094",
		"CVE-2014-0112",
		"CVE-2014-0114",
		"URL-http://www.pwntester.com/blog/2014/04/24/struts2-0day-in-the-wild/",
		"URL-http://struts.apache.org/release/2.3.x/docs/s2-020.html",
		"URL-http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Update-your-Struts-1-ClassLoader-manipulation-filters/ba-p/6639204",
		"URL-https://github.com/rgielen/struts1filter/tree/develop"
	],
	"platform": "Linux,Windows",
	"rport": 8080,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Java",
		"Linux",
		"Windows",
		"Windows / Tomcat 6 & 7 and GlassFish 4 (Remote SMB Resource)"
	],
	"mod_time": "2022-05-11 12:40:43 +0000",
	"path": "/modules/exploits/multi/http/struts_code_exec_classloader.rb",
	"is_install_path": true,
	"ref_name": "multi/http/struts_code_exec_classloader",
	"needs_cleanup": true
}
