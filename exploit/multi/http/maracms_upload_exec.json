{
  "name": "MaraCMS Arbitrary PHP File Upload",
  "fullname": "exploit/multi/http/maracms_upload_exec",
  "rank": 600,
  "disclosure_date": "2020-08-31",
  "type": "exploit",
  "author": [
    "Michele Cisternino",
    "Erik Wynter"
  ],
  "description": "This module exploits an arbitrary file upload vulnerability in\n          MaraCMS 7.5 and prior in order to execute arbitrary commands.\n\n          The module first attempts to authenticate to MaraCMS. It then tries\n          to upload a malicious PHP file to the web root via an HTTP POST\n          request to `codebase/handler.php.` If the `php` target is selected,\n          the payload is embedded in the uploaded file and the module attempts\n          to execute the payload via an HTTP GET request to this file. For the\n          `linux` and `windows` targets, the module uploads a simple PHP web\n          shell similar to `<?php system($_GET[\"cmd\"]); ?>`. Subsequently, it\n          leverages the CmdStager mixin to deliver the final payload via a\n          series of HTTP GET requests to the PHP web shell.\n\n          Valid credentials for a MaraCMS `admin` or `manager` account are\n          required. This module has been successfully tested against MaraCMS\n          7.5 running on Windows Server 2012 (XAMPP server).",
  "references": [
    "CVE-2020-25042",
    "EDB-48780"
  ],
  "platform": "Linux,PHP,Windows",
  "arch": "x86, x64, php",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "PHP",
    "Linux",
    "Windows"
  ],
  "mod_time": "2021-08-27 17:15:33 +0000",
  "path": "/modules/exploits/multi/http/maracms_upload_exec.rb",
  "is_install_path": true,
  "ref_name": "multi/http/maracms_upload_exec",
  "check": true,
  "post_auth": true,
  "needs_cleanup": true
}
