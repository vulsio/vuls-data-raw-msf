{
	"name": "APISIX Admin API default access token RCE",
	"fullname": "exploit/multi/http/apache_apisix_api_default_token_rce",
	"rank": 600,
	"disclosure_date": "2020-12-07",
	"type": "exploit",
	"author": [
		"Heyder Andrade <eu@heyderandrade.org>",
		"YuanSheng Wang <membphis@gmail.com>"
	],
	"description": "Apache APISIX has a default, built-in API token edd1c9f034335f136f87ad84b625c8f1 that can be used to access\n          all of the admin API, which leads to remote LUA code execution through the script parameter added in the 2.x\n          version. This module also leverages another vulnerability to bypass the IP restriction plugin.",
	"references": [
		"CVE-2020-13945",
		"CVE-2022-24112",
		"URL-https://github.com/apache/apisix/pull/2244",
		"URL-https://seclists.org/oss-sec/2020/q4/187",
		"URL-https://www.openwall.com/lists/oss-security/2022/02/11/3"
	],
	"platform": "Unix",
	"arch": "cmd",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic"
	],
	"mod_time": "2022-03-21 15:22:00 +0000",
	"path": "/modules/exploits/multi/http/apache_apisix_api_default_token_rce.rb",
	"is_install_path": true,
	"ref_name": "multi/http/apache_apisix_api_default_token_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
