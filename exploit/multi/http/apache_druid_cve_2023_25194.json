{
  "name": "Apache Druid JNDI Injection RCE",
  "fullname": "exploit/multi/http/apache_druid_cve_2023_25194",
  "rank": 600,
  "disclosure_date": "2023-02-07",
  "type": "exploit",
  "author": [
    "RedWay Security <info@redwaysecurity.com>",
    "Jari Jääskelä <https://github.com/jarijaas>"
  ],
  "description": "This module is designed to exploit the JNDI injection vulnerability\n        in Druid. The vulnerability specifically affects the indexer/v1/sampler\n        interface of Druid, enabling an attacker to execute arbitrary commands\n        on the targeted server.\n\n        The vulnerability is found in Apache Kafka clients versions ranging from\n        2.3.0 to 3.3.2. If an attacker can manipulate the sasl.jaas.config\n        property of any of the connector's Kafka clients to com.sun.security.auth.module.JndiLoginModule,\n        it allows the server to establish a connection with the attacker's LDAP server\n        and deserialize the LDAP response. This provides the attacker with the capability\n        to execute java deserialization gadget chains on the Kafka connect server,\n        potentially leading to unrestricted deserialization of untrusted data or even\n        remote code execution (RCE) if there are relevant gadgets in the classpath.\n\n        To facilitate the exploitation process, this module will initiate an LDAP server\n        that the target server needs to connect to in order to carry out the attack.",
  "references": [
    "CVE-2023-25194",
    "URL-https://hackerone.com/reports/1529790",
    "URL-https://lists.apache.org/thread/vy1c7fqcdqvq5grcqp6q5jyyb302khyz"
  ],
  "rport": 8888,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Automatic",
    "Windows",
    "Linux"
  ],
  "mod_time": "2023-06-23 09:36:50 +0000",
  "path": "/modules/exploits/multi/http/apache_druid_cve_2023_25194.rb",
  "is_install_path": true,
  "ref_name": "multi/http/apache_druid_cve_2023_25194",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
