{
	"name": "Cacti Import Packages RCE",
	"fullname": "exploit/multi/http/cacti_package_import_rce",
	"rank": 600,
	"disclosure_date": "2024-05-12",
	"type": "exploit",
	"author": [
		"Egidio Romano",
		"Christophe De La Fuente"
	],
	"description": "This exploit module leverages an arbitrary file write vulnerability\n          (CVE-2024-25641) in Cacti versions prior to 1.2.27 to achieve RCE. It\n          abuses the `Import Packages` feature to upload a specially crafted\n          package that embeds a PHP file. Cacti will extract this file to an\n          accessible location. The module finally triggers the payload to execute\n          arbitrary PHP code in the context of the user running the web server.\n\n          Authentication is needed and the account must have access to the\n          `Import Packages` feature. This is granted by setting the `Import\n          Templates` permission in the `Template Editor` section.",
	"references": [
		"URL-https://karmainsecurity.com/KIS-2024-04",
		"URL-https://github.com/Cacti/cacti/security/advisories/GHSA-7cmj-g5qc-pj88",
		"CVE-2024-25641"
	],
	"platform": "Windows",
	"arch": "php, cmd",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"PHP",
		"Linux Command",
		"Windows Command"
	],
	"mod_time": "2024-06-12 19:15:01 +0000",
	"path": "/modules/exploits/multi/http/cacti_package_import_rce.rb",
	"is_install_path": true,
	"ref_name": "multi/http/cacti_package_import_rce",
	"check": true,
	"post_auth": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
