{
  "name": "Spring Framework Class property RCE (Spring4Shell)",
  "fullname": "exploit/multi/http/spring_framework_rce_spring4shell",
  "disclosure_date": "2022-03-31",
  "type": "exploit",
  "author": [
    "vleminator <vleminator@gmail.com>"
  ],
  "description": "Spring Framework versions 5.3.0 to 5.3.17, 5.2.0 to 5.2.19, and older versions when running on JDK 9 or above\n          and specifically packaged as a traditional WAR and deployed in a standalone Tomcat instance are vulnerable\n          to remote code execution due to an unsafe data binding used to populate an object from request parameters\n          to set a Tomcat specific ClassLoader. By crafting a request to the application and referencing the\n          org.apache.catalina.valves.AccessLogValve class through the classLoader with parameters such as the following:\n          class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp, an unauthenticated attacker can\n          gain remote code execution.",
  "references": [
    "CVE-2022-22965",
    "URL-https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement",
    "URL-https://github.com/spring-projects/spring-framework/issues/28261",
    "URL-https://tanzu.vmware.com/security/cve-2022-22965"
  ],
  "platform": "Linux,Windows",
  "rport": 8080,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Java",
    "Linux",
    "Windows"
  ],
  "mod_time": "2022-05-13 09:16:01 +0000",
  "path": "/modules/exploits/multi/http/spring_framework_rce_spring4shell.rb",
  "is_install_path": true,
  "ref_name": "multi/http/spring_framework_rce_spring4shell",
  "check": true,
  "notes": {
    "AKA": [
      "Spring4Shell",
      "SpringShell"
    ],
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "needs_cleanup": true
}
