{
  "name": "MyBB Admin Control Code Injection RCE",
  "fullname": "exploit/multi/http/mybb_rce_cve_2022_24734",
  "rank": 600,
  "disclosure_date": "2022-03-09",
  "type": "exploit",
  "author": [
    "Cillian Collins",
    "Altelus",
    "Christophe De La Fuente"
  ],
  "description": "This exploit module leverages an improper input validation\n          vulnerability in MyBB prior to `1.8.30` to execute arbitrary code in\n          the context of the user running the application.\n\n          MyBB Admin Control setting page calls PHP `eval` function with an\n          unsanitized user input. The exploit adds a new setting, injecting the\n          payload in the vulnerable field, and triggers its execution with a\n          second request. Finally, it takes care of cleaning up and removes the\n          setting.\n\n          Note that authentication is required for this exploit to work and the\n          account must have rights to add or update settings (typically, myBB\n          administrator role).",
  "references": [
    "URL-https://github.com/mybb/mybb/security/advisories/GHSA-876v-gwgh-w57f",
    "URL-https://www.zerodayinitiative.com/advisories/ZDI-22-503/",
    "URL-https://github.com/Altelus1/CVE-2022-24734",
    "CVE-2022-24734"
  ],
  "platform": "Linux,PHP,Unix,Windows",
  "arch": "php, cmd, x86, x64",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "PHP",
    "Unix (In-Memory)",
    "Linux (Dropper)",
    "Windows (In-Memory)",
    "Windows (Dropper)"
  ],
  "mod_time": "2022-05-30 16:24:18 +0000",
  "path": "/modules/exploits/multi/http/mybb_rce_cve_2022_24734.rb",
  "is_install_path": true,
  "ref_name": "multi/http/mybb_rce_cve_2022_24734",
  "check": true,
  "post_auth": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "config-changes",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
