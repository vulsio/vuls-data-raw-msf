{
  "name": "ManageEngine Desktop Central / Password Manager LinkViewFetchServlet.dat SQL Injection",
  "fullname": "exploit/multi/http/manage_engine_dc_pmp_sqli",
  "rank": 600,
  "disclosure_date": "2014-06-08",
  "type": "exploit",
  "author": [
    "Pedro Ribeiro <pedrib@gmail.com>"
  ],
  "description": "This module exploits an unauthenticated blind SQL injection in LinkViewFetchServlet,\n        which is exposed in ManageEngine Desktop Central v7 build 70200 to v9 build 90033 and\n        Password Manager Pro v6 build 6500 to v7 build 7002 (including the MSP versions). The\n        SQL injection can be used to achieve remote code execution as SYSTEM in Windows or as\n        the user in Linux. This module exploits both PostgreSQL (newer builds) and MySQL (older\n        or upgraded builds). MySQL targets are more reliable due to the use of relative paths;\n        with PostgreSQL you should find the web root path via other means and specify it with\n        WEB_ROOT.\n\n        The injection is only exploitable via a GET request, which means that the payload\n        has to be sent in chunks smaller than 8000 characters (URL size limitation). Small\n        payloads and the use of exe-small is recommended, as you can only do between 10 and\n        20 injections before using up all the available ManagedConnections until the next\n        server restart.\n\n        This vulnerability exists in all versions released since 2006, however builds below\n        DC v7 70200 and PMP v6 6500 do not ship with a JSP compiler. You can still try your\n        luck using the MySQL targets as a JDK might be installed in the $PATH.",
  "references": [
    "CVE-2014-3996",
    "OSVDB-110198",
    "URL-https://seclists.org/fulldisclosure/2014/Aug/55"
  ],
  "platform": "Linux,Windows",
  "arch": "x86",
  "rport": 8020,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Automatic",
    "Desktop Central v8 >= b80200 / v9 < b90039 (PostgreSQL) on Windows",
    "Desktop Central MSP v8 >= b80200 / v9 < b90039 (PostgreSQL) on Windows",
    "Desktop Central [MSP] v7 >= b70200 / v8 / v9 < b90039 (MySQL) on Windows",
    "Password Manager Pro [MSP] v6 >= b6800 / v7 < b7003 (PostgreSQL) on Windows",
    "Password Manager Pro v6 >= b6500 / v7 < b7003 (MySQL) on Windows",
    "Password Manager Pro [MSP] v6 >= b6800 / v7 < b7003 (PostgreSQL) on Linux",
    "Password Manager Pro v6 >= b6500 / v7 < b7003 (MySQL) on Linux"
  ],
  "mod_time": "2021-02-17 12:33:59 +0000",
  "path": "/modules/exploits/multi/http/manage_engine_dc_pmp_sqli.rb",
  "is_install_path": true,
  "ref_name": "multi/http/manage_engine_dc_pmp_sqli",
  "check": true,
  "needs_cleanup": true
}
