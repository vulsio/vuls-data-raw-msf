{
	"name": "Log4Shell HTTP Header Injection",
	"fullname": "exploit/multi/http/log4shell_header_injection",
	"rank": 600,
	"disclosure_date": "2021-12-09",
	"type": "exploit",
	"author": [
		"Michael Schierl",
		"juan vazquez <juan.vazquez@metasploit.com>",
		"sinn3r <sinn3r@metasploit.com>",
		"Spencer McIntyre",
		"RageLtMan <rageltman@sempervictus>"
	],
	"description": "Versions of Apache Log4j2 impacted by CVE-2021-44228 which allow JNDI features used in configuration,\n        log messages, and parameters, do not protect against attacker controlled LDAP and other JNDI related endpoints.\n\n        This module will exploit an HTTP end point with the Log4Shell vulnerability by injecting a format message that\n        will trigger an LDAP connection to Metasploit and load a payload.\n\n        The Automatic target delivers a Java payload using remote class loading. This requires Metasploit to run an HTTP\n        server in addition to the LDAP server that the target can connect to. The targeted application must have the\n        trusted code base option enabled for this technique to work.\n\n        The non-Automatic targets deliver a payload via a serialized Java object. This does not require Metasploit to\n        run an HTTP server and instead leverages the LDAP server to deliver the serialized object. The target\n        application in this case must be compatible with the user-specified JAVA_GADGET_CHAIN option.",
	"references": [
		"CVE-2021-44228"
	],
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic",
		"Windows",
		"Linux"
	],
	"mod_time": "2022-12-15 12:51:30 +0000",
	"path": "/modules/exploits/multi/http/log4shell_header_injection.rb",
	"is_install_path": true,
	"ref_name": "multi/http/log4shell_header_injection",
	"check": true,
	"notes": {
		"AKA": [
			"Log4Shell",
			"LogJam"
		],
		"RelatedModules": [
			"auxiliary/scanner/http/log4shell_scanner"
		],
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
