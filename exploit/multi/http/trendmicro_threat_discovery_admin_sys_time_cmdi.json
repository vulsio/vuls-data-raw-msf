{
	"name": "Trend Micro Threat Discovery Appliance admin_sys_time.cgi Remote Command Execution",
	"fullname": "exploit/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi",
	"rank": 600,
	"disclosure_date": "2017-04-10",
	"type": "exploit",
	"author": [
		"mr_me <steventhomasseeley@gmail.com>",
		"Roberto Suggi Liverani <Roberto Suggi Liverani @malerisch>"
	],
	"description": "This module exploits two vulnerabilities the Trend Micro Threat Discovery Appliance.\n          The first is an authentication bypass vulnerability via a file delete in logoff.cgi\n          which resets the admin password back to 'admin' upon a reboot (CVE-2016-7552).\n          The second is a cmdi flaw using the timezone parameter in the admin_sys_time.cgi\n          interface (CVE-2016-7547).\n\n          Note: You have the option to use the authentication bypass or not since it requires\n          that the server is rebooted. The password reset will render the authentication useless.\n          Typically, if an administrator cant login, they will bounce the box. Therefore, this\n          module performs a heartbeat request until the box is bounced and then attempts to login\n          and to perform the command injection. This module has been tested on version 2.6.1062r1\n          of the appliance.",
	"references": [
		"URL-https://asciinema.org/a/112480",
		"CVE-2016-7552",
		"CVE-2016-7547"
	],
	"platform": "Linux",
	"arch": "x86",
	"rport": 443,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Trend Micro Threat Discovery Appliance 2.6.1062r1"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi.rb",
	"is_install_path": true,
	"ref_name": "multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi",
	"check": true,
	"post_auth": true,
	"needs_cleanup": true
}
