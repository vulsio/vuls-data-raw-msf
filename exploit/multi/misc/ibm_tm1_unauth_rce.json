{
  "name": "IBM TM1 / Planning Analytics Unauthenticated Remote Code Execution",
  "fullname": "exploit/multi/misc/ibm_tm1_unauth_rce",
  "rank": 600,
  "disclosure_date": "2019-12-19",
  "type": "exploit",
  "author": [
    "Pedro Ribeiro <pedrib@gmail.com>",
    "Gareth Batchelor <gbatchelor@cloudtrace.com.au>"
  ],
  "description": "This module exploits a vulnerability in IBM TM1 / Planning Analytics that allows\n          an unauthenticated attacker to perform a configuration overwrite.\n          It starts by querying the Admin server for the available applications, picks one,\n          and then exploits it. You can also provide an application name to bypass this step,\n          and exploit the application directly.\n          The configuration overwrite is used to change an application server authentication\n          method to \"CAM\", a proprietary IBM auth method, which is simulated by the exploit.\n          The exploit then performs a fake authentication as admin, and finally abuses TM1\n          scripting to perform a command injection as root or SYSTEM.\n          Testing was done on IBM PA 2.0.6 and IBM TM1 10.2.2 on Windows and Linux.\n          Versions up to and including PA 2.0.8 are vulnerable. It is likely that versions\n          earlier than TM1 10.2.2 are also vulnerable (10.2.2 was released in 2014).",
  "references": [
    "CVE-2019-4716",
    "URL-https://www.ibm.com/support/pages/node/1127781",
    "URL-https://github.com/pedrib/PoC/blob/master/advisories/IBM/ibm_tm1_rce.md",
    "URL-https://seclists.org/fulldisclosure/2020/Mar/44"
  ],
  "rport": 5498,
  "targets": [
    "Windows",
    "Windows (Command)",
    "Linux",
    "Linux (Command)",
    "AIX (Command)"
  ],
  "mod_time": "2023-02-08 15:46:07 +0000",
  "path": "/modules/exploits/multi/misc/ibm_tm1_unauth_rce.rb",
  "is_install_path": true,
  "ref_name": "multi/misc/ibm_tm1_unauth_rce",
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "config-changes",
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "needs_cleanup": true
}
