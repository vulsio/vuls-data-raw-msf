{
	"name": "PostgreSQL COPY FROM PROGRAM Command Execution",
	"fullname": "exploit/multi/postgres/postgres_copy_from_program_cmd_exec",
	"rank": 600,
	"disclosure_date": "2019-03-20",
	"type": "exploit",
	"author": [
		"Jacob Wilkin"
	],
	"description": "Installations running Postgres 9.3 and above have functionality which allows for the superuser\n        and users with 'pg_execute_server_program' to pipe to and from an external program using COPY.\n        This allows arbitrary command execution as though you have console access.\n\n        This module attempts to create a new table, then execute system commands in the context of\n        copying the command output into the table.\n\n        This module should work on all Postgres systems running version 9.3 and above.\n\n        For Linux & OSX systems, target 1 is used with cmd payloads such as: cmd/unix/reverse_perl\n\n        For Windows Systems, target 2 is used with powershell payloads such as: cmd/windows/powershell_reverse_tcp\n        Alternativly target 3 can be used to execute generic commands, such as a web_delivery meterpreter powershell payload\n        or other customised command.",
	"references": [
		"CVE-2019-9193",
		"URL-https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5",
		"URL-https://www.postgresql.org/docs/9.3/release-9-3.html"
	],
	"platform": "Linux,OSX,Unix,Windows",
	"arch": "cmd",
	"autofilter_ports": [
		5432
	],
	"autofilter_services": [
		"postgres"
	],
	"targets": [
		"Automatic",
		"Unix/OSX/Linux",
		"Windows - PowerShell (In-Memory)",
		"Windows (CMD)"
	],
	"mod_time": "2024-02-19 10:57:53 +0000",
	"path": "/modules/exploits/multi/postgres/postgres_copy_from_program_cmd_exec.rb",
	"is_install_path": true,
	"ref_name": "multi/postgres/postgres_copy_from_program_cmd_exec",
	"check": true,
	"post_auth": true,
	"session_types": [
		"postgresql"
	]
}
