{
	"name": "Firefox MCallGetProperty Write Side Effects Use After Free Exploit",
	"fullname": "exploit/multi/browser/firefox_jit_use_after_free",
	"disclosure_date": "2020-11-18",
	"type": "exploit",
	"author": [
		"360 ESG Vulnerability Research Institute",
		"maxpl0it",
		"timwr"
	],
	"description": "This modules exploits CVE-2020-26950, a use after free exploit in Firefox.\n          The MCallGetProperty opcode can be emitted with unmet assumptions resulting\n          in an exploitable use-after-free condition.\n\n          This exploit uses a somewhat novel technique of spraying ArgumentsData\n          structures in order to construct primitives. The shellcode is forced into\n          executable memory via the JIT compiler, and executed by writing to the JIT\n          region pointer.\n\n          This exploit does not contain a sandbox escape, so firefox must be run\n          with the MOZ_DISABLE_CONTENT_SANDBOX environment variable set, in order\n          for the shellcode to run successfully.\n\n          This vulnerability affects Firefox < 82.0.3, Firefox ESR < 78.4.1, and\n          Thunderbird < 78.4.2, however only Firefox <= 79 is supported as a target.\n          Additional work may be needed to support other versions such as Firefox 82.0.1.",
	"references": [
		"CVE-2020-26950",
		"URL-https://www.mozilla.org/en-US/security/advisories/mfsa2020-49/#CVE-2020-26950",
		"URL-https://bugzilla.mozilla.org/show_bug.cgi?id=1675905",
		"URL-https://www.sentinelone.com/labs/firefox-jit-use-after-frees-exploiting-cve-2020-26950/"
	],
	"platform": "Linux,Windows",
	"arch": "x64",
	"targets": [
		"Automatic"
	],
	"mod_time": "2022-02-26 12:35:38 +0000",
	"path": "/modules/exploits/multi/browser/firefox_jit_use_after_free.rb",
	"is_install_path": true,
	"ref_name": "multi/browser/firefox_jit_use_after_free",
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
