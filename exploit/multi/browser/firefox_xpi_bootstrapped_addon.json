{
  "name": "Mozilla Firefox Bootstrapped Addon Social Engineering Code Execution",
  "fullname": "exploit/multi/browser/firefox_xpi_bootstrapped_addon",
  "rank": 600,
  "disclosure_date": "2007-06-27",
  "type": "exploit",
  "author": [
    "mihi",
    "joev <joev@metasploit.com>"
  ],
  "description": "Mozilla Firefox before version 41 allowed users to install\n        unsigned browser extensions from arbitrary web servers.\n\n        This module dynamically creates an unsigned .xpi addon file.\n        The resulting bootstrapped Firefox addon is presented to\n        the victim via a web page. The victim's Firefox browser\n        will pop a dialog asking if they trust the addon.\n\n        Once the user clicks \"install\", the addon is installed and\n        executes the payload with full user permissions. As of Firefox\n        4, this will work without a restart as the addon is marked to\n        be \"bootstrapped\". As the addon will execute the payload after\n        each Firefox restart, an option can be given to automatically\n        uninstall the addon once the payload has been executed.\n\n        As of Firefox 41, unsigned extensions can still be installed\n        on Firefox Nightly, Unbranded and Development builds when\n        configured with `xpinstall.signatures.required` set to `false`.\n\n        Note: this module generates legacy extensions which are\n        supported only in Firefox before version 57.",
  "references": [
    "URL-https://blog.mozilla.org/addons/2015/02/10/extension-signing-safer-experience/",
    "URL-https://blog.mozilla.org/addons/2015/04/15/the-case-for-extension-signing/",
    "URL-https://support.mozilla.org/en-US/kb/frequently-asked-questions-firefox-addon",
    "URL-https://web.archive.org/web/20170727035940/https://developer.mozilla.org/en-US/Add-ons/Bootstrapped_extensions",
    "URL-https://web.archive.org/web/20160322014439/https://dvlabs.tippingpoint.com/blog/2007/06/27/xpi-the-next-malware-vector"
  ],
  "platform": "Java,Linux,OSX,Solaris,Windows",
  "targets": [
    "Universal (Javascript XPCOM Shell)",
    "Native Payload"
  ],
  "mod_time": "2022-09-05 02:23:37 +0000",
  "path": "/modules/exploits/multi/browser/firefox_xpi_bootstrapped_addon.rb",
  "is_install_path": true,
  "ref_name": "multi/browser/firefox_xpi_bootstrapped_addon",
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "artifacts-on-disk",
      "screen-effects"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
