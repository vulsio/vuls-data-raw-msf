{
	"name": "Firefox 5.0 - 15.0.1 __exposedProps__ XCS Code Execution",
	"fullname": "exploit/multi/browser/firefox_proto_crmfrequest",
	"rank": 600,
	"disclosure_date": "2013-08-06",
	"type": "exploit",
	"author": [
		"Mariusz Mlynski",
		"moz_bug_r_a4",
		"joev <joev@metasploit.com>"
	],
	"description": "On versions of Firefox from 5.0 to 15.0.1, the InstallTrigger global, when given\n        invalid input, would throw an exception that did not have an __exposedProps__\n        property set. By re-setting this property on the exception object's prototype,\n        the chrome-based defineProperty method is made available.\n\n        With the defineProperty method, functions belonging to window and document can be\n        overridden with a function that gets called from chrome-privileged context. From here,\n        another vulnerability in the crypto.generateCRMFRequest function is used to \"peek\"\n        into the context's private scope. Since the window does not have a chrome:// URL,\n        the insecure parts of Components.classes are not available, so instead the AddonManager\n        API is invoked to silently install a malicious plugin.",
	"references": [
		"CVE-2012-3993",
		"URL-https://bugzilla.mozilla.org/show_bug.cgi?id=768101",
		"CVE-2013-1710"
	],
	"platform": "Java,Linux,OSX,Solaris,Windows",
	"targets": [
		"Universal (Javascript XPCOM Shell)",
		"Native Payload"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/multi/browser/firefox_proto_crmfrequest.rb",
	"is_install_path": true,
	"ref_name": "multi/browser/firefox_proto_crmfrequest"
}
