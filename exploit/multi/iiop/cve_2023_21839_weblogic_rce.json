{
	"name": "Oracle Weblogic PreAuth Remote Command Execution via ForeignOpaqueReference IIOP Deserialization",
	"fullname": "exploit/multi/iiop/cve_2023_21839_weblogic_rce",
	"rank": 600,
	"disclosure_date": "2023-01-17",
	"type": "exploit",
	"author": [
		"4ra1n",
		"14m3ta7k",
		"Grant Willcox"
	],
	"description": "Oracle Weblogic 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0 prior to the Jan 2023 security update are vulnerable to an unauthenticated\n          remote code execution vulnerability due to a post deserialization vulnerability. This occurs when an attacker serializes\n          a \"ForeignOpaqueReference\" class object, deserializes it on the target, and then post deserialization, calls the\n          object's \"getReferent()\" method, which will make use of the \"ForeignOpaqueReference\" class's \"remoteJNDIName\" variable,\n          which is under the attackers control, to do a remote loading of the JNDI address specified by \"remoteJNDIName\" via\n          the \"lookup()\" function.\n\n          This can in turn lead to a deserialization vulnerability whereby an attacker supplies the address of a HTTP server hosting\n          a malicious Java class file, which will then be loaded into the Oracle Weblogic process's memory and an attempt to\n          create a new instance of the attacker's class will be made. Attackers can utilize this to execute arbitrary Java\n          code during the instantiation of the object, thereby getting remote code execution as the \"oracle\" user.\n\n          This module exploits this vulnerability to trigger the JNDI connection to a LDAP server we control. The LDAP server will\n          then respond with a remote reference response that points to a HTTP server that we control, where the malicious Java\n          class file will be hosted. Oracle Weblogic will then make a HTTP request to retrieve the malicious Java class file,\n          at which point our HTTP server will serve up the malicious class file and Oracle Weblogic will instantiate\n          an instance of that class, granting us RCE as the \"oracle\" user.\n\n          This vulnerability was exploited in the wild as noted by KEV on May 1st 2023: https://www.fortiguard.com/outbreak-alert/oracle-weblogic-server-vulnerability",
	"references": [
		"CVE-2023-21839",
		"URL-https://www.oracle.com/security-alerts/cpujan2023.html",
		"URL-https://github.com/gobysec/Weblogic/blob/main/WebLogic_CVE-2023-21931_en_US.md",
		"URL-https://github.com/gobysec/Weblogic/blob/main/Weblogic_Serialization_Vulnerability_and_IIOP_Protocol_en_US.md",
		"URL-https://github.com/4ra1n/CVE-2023-21839",
		"URL-https://www.fortiguard.com/outbreak-alert/oracle-weblogic-server-vulnerability"
	],
	"rport": 7001,
	"targets": [
		"Linux"
	],
	"mod_time": "2023-06-09 12:24:35 +0000",
	"path": "/modules/exploits/multi/iiop/cve_2023_21839_weblogic_rce.rb",
	"is_install_path": true,
	"ref_name": "multi/iiop/cve_2023_21839_weblogic_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
