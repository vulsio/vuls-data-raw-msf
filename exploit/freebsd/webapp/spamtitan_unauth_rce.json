{
	"name": "SpamTitan Unauthenticated RCE",
	"fullname": "exploit/freebsd/webapp/spamtitan_unauth_rce",
	"rank": 300,
	"disclosure_date": "2020-04-17",
	"type": "exploit",
	"author": [
		"Christophe De La Fuente",
		"Felipe Molina"
	],
	"description": "TitanHQ SpamTitan Gateway is an anti-spam appliance that protects against\n          unwanted emails and malwares. This module exploits an improper input\n          sanitization in versions 7.01, 7.02, 7.03 and 7.07 to inject command directives\n          into the SNMP configuration file and get remote code execution as root. Note\n          that only version 7.03 needs authentication and no authentication is required\n          for versions 7.01, 7.02 and 7.07.\n\n          First, it sends an HTTP POST request to the `snmp-x.php` page with an `SNMPD`\n          command directives (`extend` + command) passed to the `community` parameter.\n          This payload is then added to `snmpd.conf` by the application. Finally, the\n          module triggers the execution of this command by querying the SNMP server for\n          the correct OID.\n\n          This exploit module has been successfully tested against versions 7.01, 7.02,\n          7.03, and 7.07.",
	"references": [
		"EDB-48856",
		"URL-https://www.titanhq.com/spamtitan/spamtitangateway/",
		"CVE-2020-11698"
	],
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Unix In-Memory",
		"FreeBSD Dropper (x64)",
		"FreeBSD Dropper (x86)"
	],
	"mod_time": "2021-08-27 17:15:33 +0000",
	"path": "/modules/exploits/freebsd/webapp/spamtitan_unauth_rce.rb",
	"is_install_path": true,
	"ref_name": "freebsd/webapp/spamtitan_unauth_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"config-changes",
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
