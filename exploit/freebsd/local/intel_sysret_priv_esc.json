{
	"name": "FreeBSD Intel SYSRET Privilege Escalation",
	"fullname": "exploit/freebsd/local/intel_sysret_priv_esc",
	"rank": 500,
	"disclosure_date": "2012-06-12",
	"type": "exploit",
	"author": [
		"Rafal Wojtczuk",
		"John Baldwin",
		"iZsh",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module exploits a vulnerability in the FreeBSD kernel,\n          when running on 64-bit Intel processors.\n\n          By design, 64-bit processors following the X86-64 specification will\n          trigger a general protection fault (GPF) when executing a SYSRET\n          instruction with a non-canonical address in the RCX register.\n\n          However, Intel processors check for a non-canonical address prior to\n          dropping privileges, causing a GPF in privileged mode. As a result,\n          the current userland RSP stack pointer is restored and executed,\n          resulting in privileged code execution.\n\n          This module has been tested successfully on:\n\n          FreeBSD 8.3-RELEASE (amd64); and\n          FreeBSD 9.0-RELEASE (amd64).",
	"references": [
		"BID-53856",
		"CVE-2012-0217",
		"EDB-28718",
		"PACKETSTORM-113584",
		"URL-https://www.freebsd.org/security/patches/SA-12:04/sysret.patch",
		"URL-https://blog.xenproject.org/2012/06/13/the-intel-sysret-privilege-escalation/",
		"URL-https://github.com/iZsh/exploits/blob/master/stash/CVE-2012-0217-sysret/CVE-2012-0217-sysret_FreeBSD.c",
		"URL-https://fail0verflow.com/blog/2012/cve-2012-0217-intel-sysret-freebsd/",
		"URL-http://security.freebsd.org/advisories/FreeBSD-SA-12:04.sysret.asc",
		"URL-https://www.slideshare.net/nkslides/exploiting-the-linux-kernel-via-intels-sysret-implementation"
	],
	"platform": "BSD",
	"arch": "x64",
	"targets": [
		"Automatic"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/freebsd/local/intel_sysret_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "freebsd/local/intel_sysret_priv_esc",
	"check": true,
	"session_types": [
		"shell"
	],
	"needs_cleanup": true
}
