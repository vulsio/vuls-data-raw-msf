{
	"name": "FreeBSD rtld execl() Privilege Escalation",
	"fullname": "exploit/freebsd/local/rtld_execl_priv_esc",
	"rank": 600,
	"disclosure_date": "2009-11-30",
	"type": "exploit",
	"author": [
		"Kingcope",
		"stealth",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module exploits a vulnerability in the FreeBSD\n          run-time link-editor (rtld).\n\n          The rtld `unsetenv()` function fails to remove `LD_*`\n          environment variables if `__findenv()` fails.\n\n          This can be abused to load arbitrary shared objects using\n          `LD_PRELOAD`, resulting in privileged code execution.\n\n          This module has been tested successfully on:\n\n          FreeBSD 7.2-RELEASE (amd64); and\n          FreeBSD 8.0-RELEASE (amd64).",
	"references": [
		"BID-37154",
		"CVE-2009-4146",
		"CVE-2009-4147",
		"SOUNDTRACK-https://www.youtube.com/watch?v=dDnhthI27Fg",
		"URL-https://seclists.org/fulldisclosure/2009/Nov/371",
		"URL-https://c-skills.blogspot.com/2009/11/always-check-return-value.html",
		"URL-https://lists.freebsd.org/pipermail/freebsd-announce/2009-December/001286.html",
		"URL-https://xorl.wordpress.com/2009/12/01/freebsd-ld_preload-security-bypass/",
		"URL-https://securitytracker.com/id/1023250"
	],
	"platform": "BSD",
	"arch": "x86, x64, armle, aarch64, ppc, mipsle, mipsbe",
	"targets": [
		"Automatic"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/freebsd/local/rtld_execl_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "freebsd/local/rtld_execl_priv_esc",
	"check": true,
	"session_types": [
		"shell"
	],
	"needs_cleanup": true
}
