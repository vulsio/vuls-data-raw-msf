{
	"name": "Mac OS X TimeMachine (tmdiagnose) Command Injection Privilege Escalation",
	"fullname": "exploit/osx/local/timemachine_cmd_injection",
	"rank": 600,
	"disclosure_date": "2019-04-13",
	"type": "exploit",
	"author": [
		"CodeColorist",
		"timwr"
	],
	"description": "This module exploits a command injection in TimeMachine on macOS <= 10.14.3 in\n        order to run a payload as root. The tmdiagnose binary on OSX <= 10.14.3 suffers\n        from a command injection vulnerability that can be exploited by creating a\n        specially crafted disk label.\n\n          The tmdiagnose binary uses awk to list every mounted volume, and composes\n        shell commands based on the volume labels. By creating a volume label with the\n        backtick character, we can have our own binary executed with root priviledges.",
	"references": [
		"CVE-2019-8513",
		"URL-https://medium.com/0xcc/rootpipe-reborn-part-i-cve-2019-8513-timemachine-root-command-injection-47e056b3cb43",
		"URL-https://support.apple.com/en-in/HT209600",
		"URL-https://github.com/ChiChou/sploits"
	],
	"targets": [
		"Mac OS X x64 (Native Payload)",
		"Python payload",
		"Command payload"
	],
	"mod_time": "2021-02-17 12:33:59 +0000",
	"path": "/modules/exploits/osx/local/timemachine_cmd_injection.rb",
	"is_install_path": true,
	"ref_name": "osx/local/timemachine_cmd_injection",
	"check": true,
	"needs_cleanup": true
}
