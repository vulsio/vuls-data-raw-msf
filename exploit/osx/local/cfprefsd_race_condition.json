{
  "name": "macOS cfprefsd Arbitrary File Write Local Privilege Escalation",
  "fullname": "exploit/osx/local/cfprefsd_race_condition",
  "rank": 600,
  "disclosure_date": "2020-03-18",
  "type": "exploit",
  "author": [
    "Yonghwi Jin <jinmoteam@gmail.com>",
    "Jungwon Lim <setuid0@protonmail.com>",
    "Insu Yun <insu@gatech.edu>",
    "Taesoo Kim <taesoo@gatech.edu>",
    "timwr"
  ],
  "description": "This module exploits an arbitrary file write in cfprefsd on macOS <= 10.15.4 in\n          order to run a payload as root. The CFPreferencesSetAppValue function, which is\n          reachable from most unsandboxed processes, can be exploited with a race condition\n          in order to overwrite an arbitrary file as root. By overwriting /etc/pam.d/login\n          a user can then login as root with the `login root` command without a password.",
  "references": [
    "CVE-2020-9839",
    "URL-https://github.com/sslab-gatech/pwn2own2020"
  ],
  "platform": "OSX",
  "arch": "x64",
  "targets": [
    "Mac OS X x64 (Native Payload)"
  ],
  "mod_time": "2021-09-08 21:56:02 +0000",
  "path": "/modules/exploits/osx/local/cfprefsd_race_condition.rb",
  "is_install_path": true,
  "ref_name": "osx/local/cfprefsd_race_condition",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "config-changes"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "needs_cleanup": true
}
