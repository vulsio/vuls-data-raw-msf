{
  "name": "Safari User-Assisted Download and Run Attack",
  "fullname": "exploit/osx/browser/safari_user_assisted_download_launch",
  "disclosure_date": "2014-03-10",
  "type": "exploit",
  "author": [
    "joev <joev@metasploit.com>"
  ],
  "description": "This module abuses some Safari functionality to force the download of a\n        zipped .app OSX application containing our payload. The app is then\n        invoked using a custom URL scheme. At this point, the user is presented\n        with Gatekeeper's prompt:\n\n        \"APP_NAME\" is an application downloaded from the internet. Are you sure you\n        want to open it?\n\n        If the user clicks \"Open\", the app and its payload are executed.\n\n        If the user has the \"Only allow applications downloaded from Mac App Store\n        and identified developers (on by default on OS 10.8+), the user will see\n        an error dialog containing \"can't be opened because it is from an unidentified\n        developer.\" To work around this issue, you will need to manually build and sign\n        an OSX app containing your payload with a custom URL handler called \"openurl\".\n\n        You can put newlines and unicode in your APP_NAME, although you must be careful not\n        to create a prompt that is too tall, or the user will not be able to click\n        the buttons, and will have to either logout or kill the CoreServicesUIAgent\n        process.",
  "targets": [
    "Mac OS X x86 (Native Payload)",
    "Mac OS X x64 (Native Payload)"
  ],
  "mod_time": "2020-10-02 17:38:06 +0000",
  "path": "/modules/exploits/osx/browser/safari_user_assisted_download_launch.rb",
  "is_install_path": true,
  "ref_name": "osx/browser/safari_user_assisted_download_launch"
}
