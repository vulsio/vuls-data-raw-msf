{
	"name": "Safari Proxy Object Type Confusion",
	"fullname": "exploit/osx/browser/safari_proxy_object_type_confusion",
	"disclosure_date": "2018-03-15",
	"type": "exploit",
	"author": [
		"saelo"
	],
	"description": "This module exploits a type confusion bug in the Javascript Proxy object in\n        WebKit. The DFG JIT does not take into account that, through the use of a Proxy,\n        it is possible to run arbitrary JS code during the execution of a CreateThis\n        operation. This makes it possible to change the structure of e.g. an argument\n        without causing a bailout, leading to a type confusion (CVE-2018-4233).\n\n          The JIT region is then replaced with shellcode which loads the second stage.\n        The second stage exploits a logic error in libxpc, which uses command execution\n        via the launchd's \"spawn_via_launchd\" API (CVE-2018-4404).",
	"references": [
		"CVE-2018-4233",
		"CVE-2018-4404",
		"URL-https://github.com/saelo/cve-2018-4233",
		"URL-https://github.com/saelo/pwn2own2018",
		"URL-https://saelo.github.io/presentations/blackhat_us_18_attacking_client_side_jit_compilers.pdf"
	],
	"platform": "OSX",
	"arch": "python, cmd",
	"targets": [
		"Python payload",
		"Command payload"
	],
	"mod_time": "2021-02-17 12:33:59 +0000",
	"path": "/modules/exploits/osx/browser/safari_proxy_object_type_confusion.rb",
	"is_install_path": true,
	"ref_name": "osx/browser/safari_proxy_object_type_confusion"
}
