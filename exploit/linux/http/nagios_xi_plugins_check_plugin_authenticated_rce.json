{
	"name": "Nagios XI Prior to 5.6.6 getprofile.sh Authenticated Remote Command Execution",
	"fullname": "exploit/linux/http/nagios_xi_plugins_check_plugin_authenticated_rce",
	"aliases": [
		"exploit/linux/http/nagios_xi_authenticated_rce"
	],
	"rank": 600,
	"disclosure_date": "2019-07-29",
	"type": "exploit",
	"author": [
		"Jak Gibb",
		"Erik Wynter"
	],
	"description": "This module exploits a vulnerability in the getprofile.sh script\n          of Nagios XI prior to 5.6.6 in order to upload a malicious check_ping\n          plugin and thereby execute arbitrary commands.\n\n          For Nagios XI 5.2.0-5.4.13, the commands are run as the nagios user.\n          For versions 5.5.0-5.6.5 the commands are run as root. Note that versions\n          prior to 5.2.0 will still be marked as being vulnerable however this\n          module does not presently support exploiting these targets.\n\n          The module uploads a malicious check_ping plugin to the Nagios XI server via\n          /admin/monitoringplugins.php and then executes this plugin by issuing\n          a HTTP GET request to download a system profile from the server.\n          For all supported targets except Linux (cmd), the module uses a command\n          stager to write the exploit to the target via the malicious plugin.\n          This may not work if Nagios XI is running in a restricted Unix environment,\n          so in that case the target must be set to Linux (cmd). The module then\n          writes the payload to the malicious plugin while avoiding commands\n          that may not be supported.\n\n          Valid credentials for a user with administrative privileges are\n          required. This module was successfully tested on Nagios XI 5.3.0 and\n          Nagios 5.6.5, both running on CentOS 7. For vulnerable versions before\n          5.5.0, it may take a significant amount of time for the payload to get\n          back (up to 5 minutes). If exploitation fails against an older system,\n          it is recommended to increase the WfsDelay setting (default is 300\n          seconds). See the documentation for more information.",
	"references": [
		"CVE-2019-15949",
		"URL-https://github.com/jakgibb/nagiosxi-root-rce-exploit"
	],
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Linux (x86)",
		"Linux (x64)",
		"Linux (cmd)"
	],
	"mod_time": "2023-04-01 14:28:37 +0000",
	"path": "/modules/exploits/linux/http/nagios_xi_plugins_check_plugin_authenticated_rce.rb",
	"is_install_path": true,
	"ref_name": "linux/http/nagios_xi_plugins_check_plugin_authenticated_rce",
	"check": true,
	"post_auth": true,
	"notes": {
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs",
			"config-changes"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
