{
  "name": "TerraMaster TOS 4.2.15 or lower - RCE chain from unauthenticated to root via session crafting.",
  "fullname": "exploit/linux/http/terramaster_unauth_rce_cve_2021_45837",
  "rank": 600,
  "disclosure_date": "2021-12-24",
  "type": "exploit",
  "author": [
    "h00die-gr3y <h00die.gr3y@gmail.com>",
    "n0tme"
  ],
  "description": "Terramaster chained exploit that performs session crafting to achieve escalated privileges that allows\n          an attacker to access vulnerable code execution flaws. TOS versions 4.2.15 and below are affected.\n          CVE-2021-45839 is exploited to obtain the first administrator's hash set up on the system as well as other\n          information such as MAC address, by performing a request to the `/module/api.php?mobile/webNasIPS` endpoint.\n          This information is used to craft an unauthenticated admin session using CVE-2021-45841 where an attacker\n          can self-sign session cookies by knowing the target MAC address and the user password hash.\n          Guest users (disabled by default) can be abused using a null/empty hash and allow an unauthenticated attacker\n          to login as guest.\n          Finally, CVE-2021-45837 is exploited to execute arbitrary commands as root by sending a specifically crafted\n          input to vulnerable endpoint `/tos/index.php?app/del`.",
  "references": [
    "CVE-2021-45837",
    "CVE-2021-45839",
    "CVE-2021-45841",
    "URL-https://thatsn0tmy.site/posts/2021/12/how-to-summon-rces/",
    "PACKETSTORM-165399",
    "URL-https://attackerkb.com/topics/8rNXrrjQNy/cve-2021-45837"
  ],
  "platform": "Linux,Unix",
  "arch": "cmd, x64, x86, aarch64",
  "rport": 8181,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Unix Command",
    "Linux Dropper"
  ],
  "mod_time": "2023-06-08 21:25:40 +0000",
  "path": "/modules/exploits/linux/http/terramaster_unauth_rce_cve_2021_45837.rb",
  "is_install_path": true,
  "ref_name": "linux/http/terramaster_unauth_rce_cve_2021_45837",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "needs_cleanup": true
}
