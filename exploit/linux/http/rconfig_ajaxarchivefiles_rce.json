{
	"name": "Rconfig 3.x Chained Remote Code Execution",
	"fullname": "exploit/linux/http/rconfig_ajaxarchivefiles_rce",
	"rank": 400,
	"disclosure_date": "2020-03-11",
	"type": "exploit",
	"author": [
		"Jean-Pascal Thomas",
		"Orange Cyberdefense"
	],
	"description": "This module exploits multiple vulnerabilities in rConfig version 3.9\n          in order to execute arbitrary commands.\n          This module takes advantage of a command injection vulnerability in the\n          `path` parameter of the ajax archive file functionality within the rConfig web\n          interface in order to execute the payload.\n          Valid credentials for a user with administrative privileges are required.\n          However, this module can bypass authentication via SQLI.\n          This module has been successfully tested on Rconfig 3.9.3 and 3.9.4.\n          The steps are:\n          1. SQLi on /commands.inc.php allows us to add an administrative user.\n          2. An authenticated session is established with the newly added user\n          3. Command Injection on /lib/ajaxHandlers/ajaxArchiveFiles.php allows us to\n          execute the payload.\n          4. Remove the added admin user.\n          Tips : once you get a shell, look at the CVE-2019-19585.\n          You will probably get root because rConfig install script add Apache user to\n          sudoers with nopasswd ;-)",
	"references": [
		"CVE-2019-19509",
		"CVE-2020-10220",
		"EDB-47982",
		"EDB-48208",
		"URL-https://github.com/v1k1ngfr/exploits-rconfig/blob/master/rconfig_CVE-2019-19509.py",
		"URL-https://github.com/v1k1ngfr/exploits-rconfig/blob/master/rconfig_CVE-2020-10220.py"
	],
	"platform": "Linux,Unix",
	"arch": "cmd",
	"rport": 443,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Auto"
	],
	"mod_time": "2021-02-24 20:24:57 +0000",
	"path": "/modules/exploits/linux/http/rconfig_ajaxarchivefiles_rce.rb",
	"is_install_path": true,
	"ref_name": "linux/http/rconfig_ajaxarchivefiles_rce",
	"check": true
}
