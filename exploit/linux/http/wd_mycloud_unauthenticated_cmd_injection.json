{
  "name": "Western Digital MyCloud unauthenticated command injection",
  "fullname": "exploit/linux/http/wd_mycloud_unauthenticated_cmd_injection",
  "rank": 600,
  "disclosure_date": "2016-12-14",
  "type": "exploit",
  "author": [
    "Erik Wynter",
    "Steven Campbell",
    "Remco Vermeulen"
  ],
  "description": "This module exploits authentication bypass (CVE-2018-17153) and\n          command injection (CVE-2016-10108) vulnerabilities in Western\n          Digital MyCloud before 2.30.196 in order to achieve\n          unauthenticated remote code execution as the root user.\n\n          The module first performs a check to see if the target is\n          WD MyCloud. If so, it attempts to trigger an authentication\n          bypass (CVE-2018-17153) via a crafted GET request to\n          /cgi-bin/network_mgr.cgi. If the server responds as expected,\n          the module assesses the vulnerability status by attempting to\n          exploit a commend injection vulnerability (CVE-2016-10108) in\n          order to print a random string via the echo command. This is\n          done via a crafted POST request to /web/google_analytics.php.\n\n          If the server is vulnerable, the same command injection vector\n          is leveraged to execute the payload.\n\n          This module has been successfully tested against Western Digital\n          MyCloud version 2.30.183.\n\n          Note: based on the available disclosures, it seems that the\n          command injection vector (CVE-2016-10108) might be exploitable\n          without the authentication bypass (CVE-2018-17153) on versions\n          before 2.21.126. The obtained results on 2.30.183 imply that\n          the patch for CVE-2016-10108 did not actually remove the command\n          injection vector, but only prevented unauthenticated access to it.",
  "references": [
    "CVE-2016-10108",
    "CVE-2018-17153",
    "URL-https://www.securify.nl/advisory/authentication-bypass-vulnerability-in-western-digital-my-cloud-allows-escalation-to-admin-privileges/",
    "URL-https://web.archive.org/web/20170315123948/https://www.stevencampbell.info/2016/12/command-injection-in-western-digital-mycloud-nas/"
  ],
  "platform": "Linux,Unix",
  "arch": "armle, cmd",
  "rport": 443,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Unix In-Memory",
    "Linux Dropper"
  ],
  "mod_time": "2023-07-27 23:09:50 +0000",
  "path": "/modules/exploits/linux/http/wd_mycloud_unauthenticated_cmd_injection.rb",
  "is_install_path": true,
  "ref_name": "linux/http/wd_mycloud_unauthenticated_cmd_injection",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
