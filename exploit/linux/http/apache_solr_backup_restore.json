{
	"name": "Apache Solr Backup/Restore APIs RCE",
	"fullname": "exploit/linux/http/apache_solr_backup_restore",
	"rank": 600,
	"disclosure_date": "2024-02-24",
	"type": "exploit",
	"author": [
		"l3yx",
		"jheysel-r7"
	],
	"description": "Apache Solr from 6.0.0 through 8.11.2, from 9.0.0 before 9.4.1 is affected by an Unrestricted Upload of File\n          with Dangerous Type vulnerability which can result in remote code execution in the context of the user running\n          Apache Solr. When Apache Solr creates a Collection, it will use a specific directory as the classpath and load\n          some classes from it. The backup function of the Collection can export malicious class files uploaded by\n          attackers to the directory, allowing Solr to load custom classes and create arbitrary Java code. Execution\n          can further bypass the Java sandbox configured by Solr, ultimately causing arbitrary command execution.",
	"references": [
		"URL-https://xz.aliyun.com/t/13637?time__1311=mqmxnQ0QiQi%3DDtKDsD7md0%3DnxeqjghDMxTD",
		"URL-https://github.com/rapid7/metasploit-framework/issues/18919",
		"URL-https://github.com/vvmdx/Apache-Solr-RCE_CVE-2023-50386_POC",
		"CVE-2023-50386"
	],
	"platform": "Linux,Unix",
	"arch": "cmd",
	"rport": 8983,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Unix Command"
	],
	"mod_time": "2024-04-04 13:41:08 +0000",
	"path": "/modules/exploits/linux/http/apache_solr_backup_restore.rb",
	"is_install_path": true,
	"ref_name": "linux/http/apache_solr_backup_restore",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"config-changes"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
