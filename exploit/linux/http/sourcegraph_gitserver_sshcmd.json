{
	"name": "Sourcegraph gitserver sshCommand RCE",
	"fullname": "exploit/linux/http/sourcegraph_gitserver_sshcmd",
	"rank": 600,
	"disclosure_date": "2022-02-18",
	"type": "exploit",
	"author": [
		"Altelus1",
		"Spencer McIntyre"
	],
	"description": "A vulnerability exists within Sourcegraph's gitserver component that allows a remote attacker to execute\n          arbitrary OS commands by modifying the core.sshCommand value within the git configuration. This command can\n          then be triggered on demand by executing a git push operation. The vulnerability was patched by introducing a\n          feature flag in version 3.37.0. This flag must be enabled for the protections to be in place which filter the\n          commands that are able to be executed through the git exec REST API.",
	"references": [
		"CVE-2022-23642",
		"URL-https://github.com/sourcegraph/sourcegraph/security/advisories/GHSA-qcmp-fx72-q8q9",
		"URL-https://github.com/Altelus1/CVE-2022-23642"
	],
	"platform": "Linux,Unix",
	"arch": "cmd, x86, x64",
	"rport": 3178,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic",
		"Unix Command",
		"Linux Dropper"
	],
	"mod_time": "2022-07-11 09:48:08 +0000",
	"path": "/modules/exploits/linux/http/sourcegraph_gitserver_sshcmd.rb",
	"is_install_path": true,
	"ref_name": "linux/http/sourcegraph_gitserver_sshcmd",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs",
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
