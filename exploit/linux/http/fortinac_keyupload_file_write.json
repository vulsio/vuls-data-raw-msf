{
	"name": "Fortinet FortiNAC keyUpload.jsp arbitrary file write",
	"fullname": "exploit/linux/http/fortinac_keyupload_file_write",
	"rank": 600,
	"disclosure_date": "2023-02-16",
	"type": "exploit",
	"author": [
		"Gwendal Gu√©gniaud",
		"Zach Hanley",
		"jheysel-r7"
	],
	"description": "This module uploads a payload to the /tmp directory in addition to a cron job\n          to /etc/cron.d which executes the payload in the context of the root user.\n\n          The core vulnerability is an arbitrary file write issue in /configWizard/keyUpload.jsp which\n          is accessible remotely and without authentication. When you send the vulnerable\n          endpoint a ZIP file, it will extract an attacker controlled file to a directory\n          of the attackers choice on the target system.\n\n          This issue is exploitable on the following versions of FortiNAC:\n\n          FortiNAC version 9.4 prior to 9.4.1\n          FortiNAC version 9.2 prior to 9.2.6\n          FortiNAC version 9.1 prior to 9.1.8\n          FortiNAC 8.8 all versions\n          FortiNAC 8.7 all versions\n          FortiNAC 8.6 all versions\n          FortiNAC 8.5 all versions\n          FortiNAC 8.3 all versions",
	"references": [
		"URL-https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs/",
		"URL-https://www.fortiguard.com/psirt/FG-IR-22-300",
		"URL-https://github.com/horizon3ai/CVE-2022-39952",
		"URL-https://attackerkb.com/topics/9BvxYuiHYJ/cve-2022-39952",
		"CVE-2022-39952"
	],
	"platform": "Linux,Unix",
	"arch": "cmd, x64, x86",
	"rport": 8443,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"CMD",
		"Linux x86",
		"Linux x64"
	],
	"mod_time": "2023-03-13 15:46:42 +0000",
	"path": "/modules/exploits/linux/http/fortinac_keyupload_file_write.rb",
	"is_install_path": true,
	"ref_name": "linux/http/fortinac_keyupload_file_write",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
