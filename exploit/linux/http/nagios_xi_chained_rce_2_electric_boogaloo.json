{
  "name": "Nagios XI Chained Remote Code Execution",
  "fullname": "exploit/linux/http/nagios_xi_chained_rce_2_electric_boogaloo",
  "disclosure_date": "2018-04-17",
  "type": "exploit",
  "author": [
    "Cale Smith",
    "Benny Husted",
    "Jared Arave"
  ],
  "description": "This module exploits a few different vulnerabilities in Nagios XI 5.2.6-5.4.12 to gain remote root access.\n        The steps are:\n          1. Issue a POST request to /nagiosql/admin/settings.php which sets the database user to root.\n          2. SQLi on /nagiosql/admin/helpedit.php allows us to enumerate API keys.\n          3. The API keys are then used to add an administrative user.\n          4. An authenticated session is established with the newly added user\n          5. Command Injection on /nagiosxi/backend/index.php allows us to execute the payload with nopasswd sudo,\n          giving us a root shell.\n          6. Remove the added admin user and reset the database user.",
  "references": [
    "EDB-44560",
    "CVE-2018-8733",
    "CVE-2018-8734",
    "CVE-2018-8735",
    "CVE-2018-8736",
    "URL-http://blog.redactedsec.net/exploits/2018/04/26/nagios.html"
  ],
  "platform": "Linux",
  "arch": "x86",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Nagios XI 5.2.6 <= 5.4.12"
  ],
  "mod_time": "2021-02-17 12:33:59 +0000",
  "path": "/modules/exploits/linux/http/nagios_xi_chained_rce_2_electric_boogaloo.rb",
  "is_install_path": true,
  "ref_name": "linux/http/nagios_xi_chained_rce_2_electric_boogaloo",
  "check": true
}
