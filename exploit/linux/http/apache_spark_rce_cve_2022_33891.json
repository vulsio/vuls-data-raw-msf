{
	"name": "Apache Spark Unauthenticated Command Injection RCE",
	"fullname": "exploit/linux/http/apache_spark_rce_cve_2022_33891",
	"rank": 600,
	"disclosure_date": "2022-07-18",
	"type": "exploit",
	"author": [
		"Kostya Kortchinsky",
		"h00die-gr3y <h00die.gr3y@gmail.com>"
	],
	"description": "This module exploits an unauthenticated command injection vulnerability in Apache Spark.\n          Successful exploitation results in remote code execution under the context of the Spark application user.\n\n          The command injection occurs because Spark checks the group membership of the user passed\n          in the ?doAs parameter by using a raw Linux command.\n\n          It is triggered by a non-default setting called spark.acls.enable.\n          This configuration setting spark.acls.enable should be set true in the Spark configuration to make the application vulnerable for this attack.\n\n          Apache Spark versions 3.0.3 and earlier, versions 3.1.1 to 3.1.2, and versions 3.2.0 to 3.2.1 are affected by this vulnerability.",
	"references": [
		"URL-https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc",
		"URL-https://attackerkb.com/topics/5FyKBES4BL/cve-2022-33891",
		"CVE-2022-33891"
	],
	"platform": "Linux,Unix",
	"arch": "cmd, x86, x64",
	"rport": 8080,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Unix (In-Memory)",
		"Linux Dropper"
	],
	"mod_time": "2022-09-07 12:45:13 +0000",
	"path": "/modules/exploits/linux/http/apache_spark_rce_cve_2022_33891.rb",
	"is_install_path": true,
	"ref_name": "linux/http/apache_spark_rce_cve_2022_33891",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
