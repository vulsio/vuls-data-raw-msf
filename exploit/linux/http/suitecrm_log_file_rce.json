{
	"name": "SuiteCRM Log File Remote Code Execution",
	"fullname": "exploit/linux/http/suitecrm_log_file_rce",
	"rank": 400,
	"disclosure_date": "2021-04-28",
	"type": "exploit",
	"author": [
		"M. Cory Billington"
	],
	"description": "This module exploits an input validation error on the log file extension parameter. It does\n          not properly validate upper/lower case characters. Once this occurs, the application log file\n          will be treated as a php file. The log file can then be populated with php code by changing the\n          username of a valid user, as this info is logged. The php code in the file can then be executed\n          by sending an HTTP request to the log file. A similar issue was reported by the same researcher\n          where a blank file extension could be supplied and the extension could be provided in the file\n          name. This exploit will work on those versions as well, and those references are included.",
	"references": [
		"CVE-2021-42840",
		"CVE-2020-28328",
		"EDB-49001",
		"URL-https://theyhack.me/CVE-2020-28320-SuiteCRM-RCE/",
		"URL-https://theyhack.me/SuiteCRM-RCE-2/"
	],
	"platform": "Linux,Unix",
	"arch": "ARCH_X64, ARCH_CMD, ARCH_X86",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Linux (x64)",
		"Linux (cmd)"
	],
	"mod_time": "2021-10-22 22:11:51 +0000",
	"path": "/modules/exploits/linux/http/suitecrm_log_file_rce.rb",
	"is_install_path": true,
	"ref_name": "linux/http/suitecrm_log_file_rce",
	"check": true,
	"post_auth": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
