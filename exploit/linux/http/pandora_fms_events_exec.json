{
  "name": "Pandora FMS Events Remote Command Execution",
  "fullname": "exploit/linux/http/pandora_fms_events_exec",
  "rank": 600,
  "disclosure_date": "2020-06-04",
  "type": "exploit",
  "author": [
    "Fernando Catoira",
    "Julio Sanchez",
    "Erik Wynter"
  ],
  "description": "This module exploits a vulnerability (CVE-2020-13851) in Pandora\n          FMS versions 7.0 NG 742, 7.0 NG 743, and 7.0 NG 744 (and perhaps\n          older versions) in order to execute arbitrary commands.\n\n          This module takes advantage of a command injection vulnerability in the\n          `Events` feature of Pandora FMS. This flaw allows users to execute\n          arbitrary commands via the `target` parameter in HTTP POST requests to\n          the `Events` function. After authenticating to the target, the module\n          attempts to exploit this flaw by issuing such an HTTP POST request,\n          with the `target` parameter set to contain the payload. If a shell is\n          obtained, the module will try to obtain the local MySQL database\n          password via a simple `grep` command on the plaintext\n          `/var/www/html/pandora_console/include/config.php` file.\n\n          Valid credentials for a Pandora FMS account are required. The account\n          does not need to have admin privileges.\n          This module has been successfully tested on Pandora 7.0 NG 744 running\n          on CentOS 7 (the official virtual appliance ISO for this version).",
  "references": [
    "CVE-2020-13851",
    "URL-https://www.coresecurity.com/core-labs/advisories/pandora-fms-community-multiple-vulnerabilities"
  ],
  "platform": "Linux,Unix",
  "arch": "x86, x64, cmd",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Linux (x86)",
    "Linux (x64)",
    "Linux (cmd)"
  ],
  "mod_time": "2023-02-08 15:46:07 +0000",
  "path": "/modules/exploits/linux/http/pandora_fms_events_exec.rb",
  "is_install_path": true,
  "ref_name": "linux/http/pandora_fms_events_exec",
  "check": true,
  "post_auth": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
