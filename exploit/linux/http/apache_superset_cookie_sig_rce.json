{
	"name": "Apache Superset Signed Cookie RCE",
	"fullname": "exploit/linux/http/apache_superset_cookie_sig_rce",
	"rank": 400,
	"disclosure_date": "2023-09-06",
	"type": "exploit",
	"author": [
		"h00die",
		"paradoxis",
		"Spencer McIntyre",
		"Naveen Sunkavally"
	],
	"description": "Apache Superset versions <= 2.0.0 utilize Flask with a known default secret key which is used to sign HTTP cookies.\n          These cookies can therefore be forged. If a user is able to login to the site, they can decode the cookie, set their user_id to that\n          of an administrator, and re-sign the cookie. This valid cookie can then be used to login as the targeted user. From there the\n          Superset database is mounted, and credentials are pulled. A dashboard is then created. Lastly a pickled python payload can be\n          set for that dashboard within Superset's database which will trigger the RCE.\n\n          An attempt to clean up ALL of the dashboard key values and reset them to their previous values happens during the cleanup phase.",
	"references": [
		"URL-https://github.com/Paradoxis/Flask-Unsign",
		"URL-https://vulcan.io/blog/cve-2023-27524-in-apache-superset-what-you-need-to-know/",
		"URL-https://www.horizon3.ai/cve-2023-27524-insecure-default-configuration-in-apache-superset-leads-to-remote-code-execution/",
		"URL-https://www.horizon3.ai/apache-superset-part-ii-rce-credential-harvesting-and-more/",
		"URL-https://github.com/horizon3ai/CVE-2023-27524/blob/main/CVE-2023-27524.py",
		"EDB-51447",
		"CVE-2023-27524",
		"CVE-2023-37941",
		"CVE-2023-39265"
	],
	"platform": "Python",
	"arch": "python",
	"rport": 8088,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic Target"
	],
	"mod_time": "2024-07-24 16:42:43 +0000",
	"path": "/modules/exploits/linux/http/apache_superset_cookie_sig_rce.rb",
	"is_install_path": true,
	"ref_name": "linux/http/apache_superset_cookie_sig_rce",
	"check": true,
	"post_auth": true,
	"notes": {
		"RelatedModules": [
			"auxiliary/gather/apache_superset_cookie_sig_priv_esc"
		],
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"config-changes"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
