{
	"name": "Pyload RCE (CVE-2024-39205) with js2py sandbox escape (CVE-2024-28397)",
	"fullname": "exploit/linux/http/pyload_js2py_cve_2024_39205",
	"rank": 600,
	"disclosure_date": "2024-10-28",
	"type": "exploit",
	"author": [
		"Marven11",
		"Spencer McIntyre",
		"jheysel-r7"
	],
	"description": "CVE-2024-28397 is sandbox escape in js2py (<=0.74) which is a popular python package that can evaluate\n          javascript code inside a python interpreter. The vulnerability allows for an attacker to obtain a reference\n          to a python object in the js2py environment enabling them to escape the sandbox, bypass pyimport restrictions\n          and execute arbitrary commands on the host. At the time of writing no patch has been released, version 0.74\n          is the latest version of js2py which was released Nov 6, 2022.\n\n          CVE-2024-39205 is an remote code execution vulnerability in Pyload (<=0.5.0b3.dev85) which is an open-source\n          download manager designed to automate file downloads from various online sources. Pyload is vulnerable because\n          it exposes the vulnerable js2py functionality mentioned above on the /flash/addcrypted2 API endpoint.\n          This endpoint was designed to only accept connections from localhost but by manipulating the HOST header we\n          can bypass this restriction in order to access the API to achieve unauth RCE.",
	"references": [
		"CVE-2024-39205",
		"CVE-2024-28397",
		"URL-https://github.com/Marven11/CVE-2024-39205-Pyload-RCE",
		"URL-https://github.com/pyload/pyload/security/advisories/GHSA-w7hq-f2pj-c53g",
		"URL-https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape"
	],
	"platform": "Linux,Unix",
	"arch": "cmd, x86, x64",
	"rport": 9666,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Unix Command",
		"Linux Dropper"
	],
	"mod_time": "2024-11-14 12:47:35 +0000",
	"path": "/modules/exploits/linux/http/pyload_js2py_cve_2024_39205.rb",
	"is_install_path": true,
	"ref_name": "linux/http/pyload_js2py_cve_2024_39205",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs",
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
