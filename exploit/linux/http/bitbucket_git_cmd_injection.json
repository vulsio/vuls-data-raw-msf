{
  "name": "Bitbucket Git Command Injection",
  "fullname": "exploit/linux/http/bitbucket_git_cmd_injection",
  "rank": 600,
  "disclosure_date": "2022-08-24",
  "type": "exploit",
  "author": [
    "TheGrandPew",
    "Ron Bowes",
    "Jang",
    "Shelby Pace"
  ],
  "description": "Various versions of Bitbucket Server and Data Center are vulnerable to\n          an unauthenticated command injection vulnerability in multiple API endpoints.\n\n          The `/rest/api/latest/projects/{projectKey}/repos/{repositorySlug}/archive` endpoint\n          creates an archive of the repository, leveraging the `git-archive` command to do so.\n          Supplying NULL bytes to the request enables the passing of additional arguments to the\n          command, ultimately enabling execution of arbitrary commands.",
  "references": [
    "URL-https://blog.assetnote.io/2022/09/14/rce-in-bitbucket-server/",
    "URL-https://confluence.atlassian.com/bitbucketserver/bitbucket-server-and-data-center-advisory-2022-08-24-1155489835.html",
    "URL-https://attackerkb.com/topics/iJIxJ6JUow/cve-2022-36804/rapid7-analysis",
    "URL-https://www.rapid7.com/blog/post/2022/09/20/cve-2022-36804-easily-exploitable-vulnerability-in-atlassian-bitbucket-server-and-data-center/",
    "CVE-2022-36804"
  ],
  "platform": "Linux",
  "arch": "x86, x64, cmd",
  "rport": 7990,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Linux Dropper",
    "Unix Command"
  ],
  "mod_time": "2022-10-01 17:54:59 +0000",
  "path": "/modules/exploits/linux/http/bitbucket_git_cmd_injection.rb",
  "is_install_path": true,
  "ref_name": "linux/http/bitbucket_git_cmd_injection",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
