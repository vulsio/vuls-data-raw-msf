{
  "name": "Apache Airflow 1.10.10 - Example DAG Remote Code Execution",
  "fullname": "exploit/linux/http/apache_airflow_dag_rce",
  "rank": 600,
  "disclosure_date": "2020-07-14",
  "type": "exploit",
  "author": [
    "xuxiang",
    "Pepe Berba",
    "Ismail E. Dawoodjee"
  ],
  "description": "This module exploits an unauthenticated command injection vulnerability\n          by combining two critical vulnerabilities in Apache Airflow 1.10.10.\n          The first, CVE-2020-11978, is an authenticated command injection vulnerability\n          found in one of Airflow's example DAGs, \"example_trigger_target_dag\", which\n          allows any authenticated user to run arbitrary OS commands as the user\n          running Airflow Worker/Scheduler. The second, CVE-2020-13927, is a default\n          setting of Airflow 1.10.10 that allows unauthenticated access to Airflow's\n          Experimental REST API to perform malicious actions such as creating the\n          vulnerable DAG above. The two CVEs taken together allow vulnerable DAG creation\n          and command injection, leading to unauthenticated remote code execution.",
  "references": [
    "EDB-49927",
    "CVE-2020-11978",
    "CVE-2020-13927",
    "URL-https://github.com/pberba/CVE-2020-11978/",
    "URL-https://lists.apache.org/thread/cn57zwylxsnzjyjztwqxpmly0x9q5ljx",
    "URL-https://lists.apache.org/thread/mq1bpqf3ztg1nhyc5qbrjobfrzttwx1d"
  ],
  "platform": "Linux,Unix",
  "arch": "cmd",
  "rport": 8080,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Unix Command"
  ],
  "mod_time": "2023-09-17 22:42:07 +0000",
  "path": "/modules/exploits/linux/http/apache_airflow_dag_rce.rb",
  "is_install_path": true,
  "ref_name": "linux/http/apache_airflow_dag_rce",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
