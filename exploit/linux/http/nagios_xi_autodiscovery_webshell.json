{
	"name": "Nagios XI Autodiscovery Webshell Upload",
	"fullname": "exploit/linux/http/nagios_xi_autodiscovery_webshell",
	"rank": 600,
	"disclosure_date": "2021-07-15",
	"type": "exploit",
	"author": [
		"Claroty Team82",
		"jbaines-r7"
	],
	"description": "This module exploits a path traversal issue in Nagios XI before version 5.8.5 (CVE-2021-37343).\n          The path traversal allows a remote and authenticated administrator to upload a PHP web shell\n          and execute code as `www-data`. The module achieves this by creating an autodiscovery job\n          with an `id` field containing a path traversal to a writable and remotely accessible directory,\n          and `custom_ports` field containing the web shell. A cron file will be created using the chosen\n          path and file name, and the web shell is embedded in the file.\n\n          After the web shell has been written to the victim, this module will then use the web shell to\n          establish a Meterpreter session or a reverse shell. By default, the web shell is deleted by\n          the module, and the autodiscovery job is removed as well.",
	"references": [
		"CVE-2021-37343",
		"URL-https://claroty.com/2021/09/21/blog-research-securing-network-management-systems-nagios-xi/"
	],
	"platform": "Linux,Unix",
	"arch": "cmd, x86, x64",
	"rport": 443,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Unix Command",
		"Linux Dropper"
	],
	"mod_time": "2023-04-01 14:28:37 +0000",
	"path": "/modules/exploits/linux/http/nagios_xi_autodiscovery_webshell.rb",
	"is_install_path": true,
	"ref_name": "linux/http/nagios_xi_autodiscovery_webshell",
	"check": true,
	"post_auth": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs",
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
