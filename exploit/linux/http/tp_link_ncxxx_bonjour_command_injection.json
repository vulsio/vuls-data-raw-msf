{
  "name": "TP-Link Cloud Cameras NCXXX Bonjour Command Injection",
  "fullname": "exploit/linux/http/tp_link_ncxxx_bonjour_command_injection",
  "rank": 600,
  "disclosure_date": "2020-04-29",
  "type": "exploit",
  "author": [
    "Pietro Oliva <pietroliva@gmail.com>"
  ],
  "description": "TP-Link cloud cameras NCXXX series (NC200, NC210, NC220, NC230,\n          NC250, NC260, NC450) are vulnerable to an authenticated command\n          injection. In all devices except NC210, despite a check on the name length in\n          swSystemSetProductAliasCheck, no other checks are in place in order\n          to prevent shell metacharacters from being introduced. The system name\n          would then be used in swBonjourStartHTTP as part of a shell command\n          where arbitrary commands could be injected and executed as root. NC210 devices\n          cannot be exploited directly via /setsysname.cgi due to proper input\n          validation. NC210 devices are still vulnerable since swBonjourStartHTTP\n          did not perform any validation when reading the alias name from the\n          configuration file. The configuration file can be written, and code\n          execution can be achieved by combining this issue with CVE-2020-12110.",
  "references": [
    "URL-https://nvd.nist.gov/vuln/detail/CVE-2020-12109",
    "URL-https://seclists.org/fulldisclosure/2020/May/2",
    "CVE-2020-12109"
  ],
  "platform": "Linux",
  "arch": "mipsle",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "TP-Link NC200, NC220, NC230, NC250",
    "TP-Link NC260, NC450"
  ],
  "mod_time": "2022-04-19 16:40:57 +0000",
  "path": "/modules/exploits/linux/http/tp_link_ncxxx_bonjour_command_injection.rb",
  "is_install_path": true,
  "ref_name": "linux/http/tp_link_ncxxx_bonjour_command_injection",
  "post_auth": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
