{
  "name": "H2 Web Interface Create Alias RCE",
  "fullname": "exploit/linux/http/h2_webinterface_rce",
  "rank": 600,
  "disclosure_date": "2018-04-09",
  "type": "exploit",
  "author": [
    "h00die",
    "gambler",
    "h4ckNinja",
    "Nairuz Abulhul"
  ],
  "description": "The H2 database contains an alias function which allows for arbitrary Java code to be used.\n          This functionality can be abused to create an exec functionality to pull our payload down\n          and execute it. H2's web interface contains restricts MANY characters, so injecting a payload\n          directly is not favorable. A valid database connection is required. If the database engine\n          was configured to allow creation of databases, the module default can be used which\n          utilizes an in memory database. Some Docker instances of H2 don't allow writing to\n          folders such as /tmp, so we default to writing to the working directory of the software.\n\n          This module was tested against H2 version 2.1.214, 2.0.204, 1.4.199 (version detection fails)",
  "references": [
    "EDB-44422",
    "EDB-45506",
    "URL-https://medium.com/r3d-buck3t/chaining-h2-database-vulnerabilities-for-rce-9b535a9621a2",
    "URL-https://www.h2database.com/html/commands.html#create_alias"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "rport": 8082,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Automatic Target"
  ],
  "mod_time": "2023-08-08 15:28:34 +0000",
  "path": "/modules/exploits/linux/http/h2_webinterface_rce.rb",
  "is_install_path": true,
  "ref_name": "linux/http/h2_webinterface_rce",
  "check": true,
  "post_auth": true,
  "notes": {
    "NOCVE": [
      "abusing a feature"
    ],
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
