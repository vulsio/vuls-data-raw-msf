{
  "name": "Apache Druid 0.20.0 Remote Command Execution",
  "fullname": "exploit/linux/http/apache_druid_js_rce",
  "rank": 600,
  "disclosure_date": "2021-01-21",
  "type": "exploit",
  "author": [
    "Litch1, Security Team of Alibaba Cloud",
    "je5442804"
  ],
  "description": "Apache Druid includes the ability to execute user-provided JavaScript code embedded in\n          various types of requests; however, that feature is disabled by default.\n\n          In Druid versions prior to `0.20.1`, an authenticated user can send a specially-crafted request\n          that both enables the JavaScript code-execution feature and executes the supplied code all\n          at once, allowing for code execution on the server with the privileges of the Druid Server process.\n          More critically, authentication is not enabled in Apache Druid by default.\n\n          Tested on the following Apache Druid versions:\n\n          * 0.15.1\n          * 0.16.0-iap8\n          * 0.17.1\n          * 0.18.0-iap3\n          * 0.19.0-iap7\n          * 0.20.0-iap4.1\n          * 0.20.0\n          * 0.21.0-iap3",
  "references": [
    "CVE-2021-25646",
    "URL-https://lists.apache.org/thread.html/rfda8a3aa6ac06a80c5cbfdeae0fc85f88a5984e32ea05e6dda46f866%40%3Cdev.druid.apache.org%3E",
    "URL-https://github.com/yaunsky/cve-2021-25646/blob/main/cve-2021-25646.py"
  ],
  "platform": "Linux,Unix",
  "arch": "cmd, x86, x64",
  "rport": 8888,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Linux (dropper)",
    "Unix (in-memory)"
  ],
  "mod_time": "2022-04-19 20:42:23 +0000",
  "path": "/modules/exploits/linux/http/apache_druid_js_rce.rb",
  "is_install_path": true,
  "ref_name": "linux/http/apache_druid_js_rce",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
