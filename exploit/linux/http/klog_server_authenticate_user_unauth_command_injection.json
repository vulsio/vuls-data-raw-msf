{
	"name": "Klog Server authenticate.php user Unauthenticated Command Injection",
	"fullname": "exploit/linux/http/klog_server_authenticate_user_unauth_command_injection",
	"rank": 600,
	"disclosure_date": "2020-12-27",
	"type": "exploit",
	"author": [
		"b3kc4t",
		"Metin Yunus Kandemir",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module exploits an unauthenticated command injection vulnerability\n          in Klog Server versions 2.4.1 and prior.\n\n          The `authenticate.php` file uses the `user` HTTP POST parameter in a call\n          to the `shell_exec()` PHP function without appropriate input validation,\n          allowing arbitrary command execution as the apache user.\n\n          The sudo configuration permits the apache user to execute any command\n          as root without providing a password, resulting in privileged command\n          execution as root.\n\n          This module has been successfully tested on Klog Server version 2.4.1\n          virtual appliance.",
	"references": [
		"CVE-2020-35729",
		"CWE-78",
		"EDB-49366",
		"EDB-49474",
		"PACKETSTORM-160798",
		"PACKETSTORM-161123",
		"URL-https://github.com/mustgundogdu/Research/tree/main/KLOG_SERVER",
		"URL-https://docs.unsafe-inline.com/0day/klog-server-unauthentication-command-injection"
	],
	"platform": "Linux,Unix",
	"rport": 443,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Linux (x86)",
		"Linux (x64)",
		"Linux (cmd)"
	],
	"mod_time": "2021-08-27 17:15:33 +0000",
	"path": "/modules/exploits/linux/http/klog_server_authenticate_user_unauth_command_injection.rb",
	"is_install_path": true,
	"ref_name": "linux/http/klog_server_authenticate_user_unauth_command_injection",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
