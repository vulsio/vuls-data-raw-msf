{
  "name": "VMware vCenter Server Analytics (CEIP) Service File Upload",
  "fullname": "exploit/linux/http/vmware_vcenter_analytics_file_upload",
  "rank": 600,
  "disclosure_date": "2021-09-21",
  "type": "exploit",
  "author": [
    "George Noseevich",
    "Sergey Gerasimov",
    "VMware",
    "Derek Abdine",
    "wvu <wvu@metasploit.com>"
  ],
  "description": "This module exploits a file upload in VMware vCenter Server's\n          analytics/telemetry (CEIP) service to write a system crontab and\n          execute shell commands as the root user.\n\n          Note that CEIP must be enabled for the target to be exploitable by\n          this module. CEIP is enabled by default.",
  "references": [
    "CVE-2021-22005",
    "URL-https://www.vmware.com/security/advisories/VMSA-2021-0020.html",
    "URL-https://attackerkb.com/topics/15E0q0tdEZ/cve-2021-22005/rapid7-analysis",
    "URL-https://censys.io/blog/vmware-cve-2021-22005-technical-impact-analysis/",
    "URL-https://testbnull.medium.com/quick-note-of-vcenter-rce-cve-2021-22005-4337d5a817ee"
  ],
  "platform": "Linux,Unix",
  "arch": "cmd, x86, x64",
  "rport": 443,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Unix Command",
    "Linux Dropper"
  ],
  "mod_time": "2021-10-20 14:16:46 +0000",
  "path": "/modules/exploits/linux/http/vmware_vcenter_analytics_file_upload.rb",
  "is_install_path": true,
  "ref_name": "linux/http/vmware_vcenter_analytics_file_upload",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
