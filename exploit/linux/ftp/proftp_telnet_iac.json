{
	"name": "ProFTPD 1.3.2rc3 - 1.3.3b Telnet IAC Buffer Overflow (Linux)",
	"fullname": "exploit/linux/ftp/proftp_telnet_iac",
	"rank": 500,
	"disclosure_date": "2010-11-01",
	"type": "exploit",
	"author": [
		"jduck <jduck@metasploit.com>"
	],
	"description": "This module exploits a stack-based buffer overflow in versions of ProFTPD\n        server between versions 1.3.2rc3 and 1.3.3b. By sending data containing a\n        large number of Telnet IAC commands, an attacker can corrupt memory and\n        execute arbitrary code.\n\n        The Debian Squeeze version of the exploit uses a little ROP stub to indirectly\n        transfer the flow of execution to a pool buffer (the cmd_rec \"res\" in\n        \"pr_cmd_read\").\n\n        The Ubuntu version uses a ROP stager to mmap RWX memory, copy a small stub\n        to it, and execute the stub. The stub then copies the remainder of the payload\n        in and executes it.\n\n        NOTE: Most Linux distributions either do not ship a vulnerable version of\n        ProFTPD, or they ship a version compiled with stack smashing protection.\n\n        Although SSP significantly reduces the probability of a single attempt\n        succeeding, it will not prevent exploitation. Since the daemon forks in a\n        default configuration, the cookie value will remain the same despite\n        some attempts failing. By making repeated requests, an attacker can eventually\n        guess the cookie value and exploit the vulnerability.\n\n        The cookie in Ubuntu has 24-bits of entropy. This reduces the effectiveness\n        and could allow exploitation in semi-reasonable amount of time.",
	"references": [
		"CVE-2010-4221",
		"OSVDB-68985",
		"BID-44562"
	],
	"platform": "Linux",
	"rport": 21,
	"targets": [
		"Automatic Targeting",
		"Debug",
		"ProFTPD 1.3.3a Server (Debian) - Squeeze Beta1",
		"ProFTPD 1_3_3a Server (Debian) - Squeeze Beta1 (Debug)",
		"ProFTPD 1.3.2c Server (Ubuntu 10.04)"
	],
	"mod_time": "2021-03-17 06:51:08 +0000",
	"path": "/modules/exploits/linux/ftp/proftp_telnet_iac.rb",
	"is_install_path": true,
	"ref_name": "linux/ftp/proftp_telnet_iac",
	"check": true
}
