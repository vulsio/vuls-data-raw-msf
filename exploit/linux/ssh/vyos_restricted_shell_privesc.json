{
  "name": "VyOS restricted-shell Escape and Privilege Escalation",
  "fullname": "exploit/linux/ssh/vyos_restricted_shell_privesc",
  "rank": 500,
  "disclosure_date": "2018-11-05",
  "type": "exploit",
  "author": [
    "Rich Mirch",
    "bcoles <bcoles@gmail.com>"
  ],
  "description": "This module exploits command injection vulnerabilities and an insecure\n          default sudo configuration on VyOS versions 1.0.0 <= 1.1.8 to execute\n          arbitrary system commands as root.\n\n          VyOS features a `restricted-shell` system shell intended for use by\n          low privilege users with operator privileges. This module exploits\n          a vulnerability in the `telnet` command to break out of the restricted\n          shell, then uses sudo to exploit a command injection vulnerability in\n          `/opt/vyatta/bin/sudo-users/vyatta-show-lldp.pl` to execute commands\n          with root privileges.\n\n          This module has been tested successfully on VyOS 1.1.8 amd64 and\n          VyOS 1.0.0 i386.",
  "references": [
    "CVE-2018-18556",
    "URL-https://blog.vyos.io/the-operator-level-is-proved-insecure-and-will-be-removed-in-the-next-releases",
    "URL-https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/",
    "URL-https://github.com/mirchr/security-research/blob/master/vulnerabilities/VyOS/CVE-2018-18556.sh"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "rport": 22,
  "targets": [
    "Automatic"
  ],
  "mod_time": "2022-04-18 23:36:23 +0000",
  "path": "/modules/exploits/linux/ssh/vyos_restricted_shell_privesc.rb",
  "is_install_path": true,
  "ref_name": "linux/ssh/vyos_restricted_shell_privesc",
  "check": true,
  "post_auth": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
