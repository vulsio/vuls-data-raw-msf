{
	"name": "Asterisk AMI Originate Authenticated RCE",
	"fullname": "exploit/linux/misc/asterisk_ami_originate_auth_rce",
	"rank": 500,
	"disclosure_date": "2024-08-08",
	"type": "exploit",
	"author": [
		"Brendan Coles <bcoles@gmail.com>",
		"h00die",
		"NielsGaljaard"
	],
	"description": "On Asterisk, prior to versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk\n          versions 18.9-cert11 and 20.7-cert2, an AMI user with 'write=originate' may change\n          all configuration files in the '/etc/asterisk/' directory. Writing a new extension\n          can be created which performs a system command to achieve RCE as the asterisk service\n          user (typically asterisk).\n          Default parking lot in FreePBX is called \"Default lot\" on the website interface,\n          however its actually 'parkedcalls'.\n          Tested against Asterisk 19.8.0 and 18.16.0 on Freepbx SNG7-PBX16-64bit-2302-1.",
	"references": [
		"URL-https://github.com/asterisk/asterisk/security/advisories/GHSA-c4cg-9275-6w44",
		"CVE-2024-42365"
	],
	"platform": "Unix",
	"rport": 5038,
	"targets": [
		"Unix Command"
	],
	"mod_time": "2024-11-28 20:24:25 +0000",
	"path": "/modules/exploits/linux/misc/asterisk_ami_originate_auth_rce.rb",
	"is_install_path": true,
	"ref_name": "linux/misc/asterisk_ami_originate_auth_rce",
	"check": true,
	"post_auth": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs",
			"config-changes"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
