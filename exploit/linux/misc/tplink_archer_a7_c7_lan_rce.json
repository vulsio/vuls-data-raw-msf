{
	"name": "TP-Link Archer A7/C7 Unauthenticated LAN Remote Code Execution",
	"fullname": "exploit/linux/misc/tplink_archer_a7_c7_lan_rce",
	"rank": 600,
	"disclosure_date": "2020-03-25",
	"type": "exploit",
	"author": [
		"Pedro Ribeiro <pedrib@gmail.com>",
		"Radek Domanski <radek.domanski <Radek Domanski <radek.domanski@gmail.com> @RabbitPro>"
	],
	"description": "This module exploits a command injection vulnerability in the tdpServer daemon (/usr/bin/tdpServer), running on\n          the router TP-Link Archer A7/C7 (AC1750), hardware version 5, MIPS Architecture, firmware version 190726.\n          The vulnerability can only be exploited by an attacker on the LAN side of the router, but the attacker does\n          not need any authentication to abuse it. After exploitation, an attacker will be able to execute any command\n          as root, including downloading and executing a binary from another host.\n          This vulnerability was discovered and exploited at Pwn2Own Tokyo 2019 by the Flashback team (Pedro Ribeiro +\n          Radek Domanski).\n          This module was updated in November 2020, after a bypass was discovered for the patch TP-Link issued. The new\n          injection technique works on older firmware too. All firmware versions up to (but excluding) releases 201029 and\n          201030 are exploitable.",
	"references": [
		"URL-https://www.thezdi.com/blog/2020/4/6/exploiting-the-tp-link-archer-c7-at-pwn2own-tokyo",
		"URL-https://github.com/pedrib/PoC/blob/master/advisories/Pwn2Own/Tokyo_2019/lao_bomb/lao_bomb.md",
		"URL-https://github.com/rdomanski/Exploits_and_Advisories/blob/master/advisories/Pwn2Own/Tokyo2019/lao_bomb.md",
		"URL-https://github.com/pedrib/PoC/blob/master/advisories/Pwn2Own/Tokyo_2020/minesweeper.md",
		"URL-https://github.com/rdomanski/Exploits_and_Advisories/blob/master/advisories/Pwn2Own/Tokyo2020/minesweeper.md",
		"CVE-2020-10882",
		"CVE-2020-10883",
		"CVE-2020-10884",
		"CVE-2020-28347",
		"ZDI-20-334",
		"ZDI-20-335",
		"ZDI-20-336"
	],
	"platform": "Linux",
	"arch": "mipsbe",
	"rport": 20002,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"TP-Link Archer A7/C7 (AC1750) v5 (firmware up to 201029/30)"
	],
	"mod_time": "2024-07-24 16:42:43 +0000",
	"path": "/modules/exploits/linux/misc/tplink_archer_a7_c7_lan_rce.rb",
	"is_install_path": true,
	"ref_name": "linux/misc/tplink_archer_a7_c7_lan_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
