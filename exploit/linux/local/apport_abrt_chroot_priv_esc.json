{
  "name": "Apport / ABRT chroot Privilege Escalation",
  "fullname": "exploit/linux/local/apport_abrt_chroot_priv_esc",
  "rank": 600,
  "disclosure_date": "2015-03-31",
  "type": "exploit",
  "author": [
    "St√©phane Graber",
    "Tavis Ormandy",
    "Ricardo F. Teixeira",
    "bcoles <bcoles@gmail.com>"
  ],
  "description": "This module attempts to gain root privileges on Linux systems by\n        invoking the default coredump handler inside a namespace (\"container\").\n\n        Apport versions 2.13 through 2.17.x before 2.17.1 on Ubuntu are\n        vulnerable, due to a feature which allows forwarding reports to\n        a container's Apport by changing the root directory before loading\n        the crash report, causing `usr/share/apport/apport` within the crashed\n        task's directory to be executed.\n\n        Similarly, Fedora is vulnerable when the kernel crash handler is\n        configured to change root directory before executing ABRT, causing\n        `usr/libexec/abrt-hook-ccpp` within the crashed task's directory to be\n        executed.\n\n        In both instances, the crash handler does not drop privileges,\n        resulting in code execution as root.\n\n        This module has been tested successfully on Apport 2.14.1 on\n        Ubuntu 14.04.1 LTS x86 and x86_64 and ABRT on Fedora 19 and 20 x86_64.",
  "references": [
    "CVE-2015-1318",
    "URL-http://www.openwall.com/lists/oss-security/2015/04/14/4",
    "EDB-36782",
    "EDB-36746",
    "URL-https://gist.github.com/taviso/0f02c255c13c5c113406",
    "URL-https://bugzilla.redhat.com/show_bug.cgi?id=1211223",
    "URL-https://bugzilla.redhat.com/show_bug.cgi?id=1211835",
    "URL-https://usn.ubuntu.com/usn/USN-2569-1/",
    "URL-https://code.launchpad.net/~stgraber/apport/pidns-support/+merge/200893",
    "URL-https://bugs.launchpad.net/ubuntu/+source/apport/+bug/1438758",
    "URL-http://bazaar.launchpad.net/~apport-hackers/apport/trunk/revision/2943"
  ],
  "platform": "Linux",
  "arch": "x86, x64",
  "targets": [
    "Auto"
  ],
  "mod_time": "2021-07-08 09:03:42 +0000",
  "path": "/modules/exploits/linux/local/apport_abrt_chroot_priv_esc.rb",
  "is_install_path": true,
  "ref_name": "linux/local/apport_abrt_chroot_priv_esc",
  "check": true,
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
