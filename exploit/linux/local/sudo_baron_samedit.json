{
  "name": "Sudo Heap-Based Buffer Overflow",
  "fullname": "exploit/linux/local/sudo_baron_samedit",
  "rank": 600,
  "disclosure_date": "2021-01-26",
  "type": "exploit",
  "author": [
    "Qualys",
    "Spencer McIntyre",
    "bwatters-r7",
    "smashery",
    "blasty <blasty@fail0verflow.com>",
    "worawit",
    "Alexander Krog"
  ],
  "description": "A heap based buffer overflow exists in the sudo command line utility that can be exploited by a local attacker\n          to gain elevated privileges. The vulnerability was introduced in July of 2011 and affects version 1.8.2\n          through 1.8.31p2 as well as 1.9.0 through 1.9.5p1 in their default configurations. The technique used by this\n          implementation leverages the overflow to overwrite a service_user struct in memory to reference an attacker\n          controlled library which results in it being loaded with the elevated privileges held by sudo.",
  "references": [
    "URL-https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit",
    "URL-https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt",
    "URL-https://www.kalmarunionen.dk/writeups/sudo/",
    "URL-https://github.com/blasty/CVE-2021-3156/blob/main/hax.c",
    "CVE-2021-3156"
  ],
  "platform": "Linux,Unix",
  "arch": "x64",
  "targets": [
    "Automatic",
    "Ubuntu 20.04 x64 (sudo v1.8.31, libc v2.31)",
    "Ubuntu 20.04 x64 (sudo v1.8.31, libc v2.31) - alternative",
    "Ubuntu 19.04 x64 (sudo v1.8.27, libc v2.29)",
    "Ubuntu 18.04 x64 (sudo v1.8.21, libc v2.27)",
    "Ubuntu 18.04 x64 (sudo v1.8.21, libc v2.27) - alternative",
    "Ubuntu 16.04 x64 (sudo v1.8.16, libc v2.23)",
    "Ubuntu 14.04 x64 (sudo v1.8.9p5, libc v2.19)",
    "Debian 10 x64 (sudo v1.8.27, libc v2.28)",
    "Debian 10 x64 (sudo v1.8.27, libc v2.28) - alternative",
    "CentOS 8 x64 (sudo v1.8.25p1, libc v2.28)",
    "CentOS 7 x64 (sudo v1.8.23, libc v2.17)",
    "CentOS 7 x64 (sudo v1.8.23, libc v2.17) - alternative",
    "Fedora 27 x64 (sudo v1.8.21p2, libc v2.26)",
    "Fedora 26 x64 (sudo v1.8.20p2, libc v2.25)",
    "Fedora 25 x64 (sudo v1.8.18, libc v2.24)",
    "Fedora 24 x64 (sudo v1.8.16, libc v2.23)",
    "Fedora 23 x64 (sudo v1.8.14p3, libc v2.22)",
    "Manual"
  ],
  "mod_time": "2023-02-08 15:20:32 +0000",
  "path": "/modules/exploits/linux/local/sudo_baron_samedit.rb",
  "is_install_path": true,
  "ref_name": "linux/local/sudo_baron_samedit",
  "check": true,
  "notes": {
    "AKA": [
      "Baron Samedit"
    ],
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
