{
  "name": "2021 Ubuntu Overlayfs LPE",
  "fullname": "exploit/linux/local/cve_2021_3493_overlayfs",
  "rank": 500,
  "disclosure_date": "2021-04-12",
  "type": "exploit",
  "author": [
    "ssd-disclosure",
    "bwatters-r7"
  ],
  "description": "This module exploits a vulnerability in Ubuntu's implementation of overlayfs. The\n          vulnerability is the result of failing to verify the ability of a user to set the\n          attributes in a running executable. Specifically, when Overlayfs sends the set attributes\n          data to the underlying file system via `vfs_setxattr`, it fails to first verify the data\n          by calling `cap_convert_nscap`.\n          This vulnerability was patched by moving the call to `cap_convert_nscap`\n          into the `vfs_setxattr` function that sets the attribute, forcing verification every time the\n          `vfs_setxattr` is called rather than trusting the data was already verified.",
  "references": [
    "CVE-2021-3493",
    "URL-https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/",
    "URL-https://github.com/briskets/CVE-2021-3493"
  ],
  "platform": "Linux",
  "targets": [
    "x86_64",
    "aarch64"
  ],
  "mod_time": "2023-02-02 18:17:02 +0000",
  "path": "/modules/exploits/linux/local/cve_2021_3493_overlayfs.rb",
  "is_install_path": true,
  "ref_name": "linux/local/cve_2021_3493_overlayfs",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
