{
	"name": "vmwgfx Driver File Descriptor Handling Priv Esc",
	"fullname": "exploit/linux/local/vmwgfx_fd_priv_esc",
	"rank": 400,
	"disclosure_date": "2022-01-28",
	"type": "exploit",
	"author": [
		"h00die",
		"Mathias Krause"
	],
	"description": "If the vmwgfx driver fails to copy the 'fence_rep' object to userland, it tries to\n          recover by deallocating the (already populated) file descriptor. This is\n          wrong, as the fd gets released via put_unused_fd() which shouldn't be used,\n          as the fd table slot was already populated via the previous call to\n          fd_install(). This leaves userland with a valid fd table entry pointing to\n          a free'd 'file' object.\n\n          We use this bug to overwrite a SUID binary with our payload and gain root.\n          Linux kernel 4.14-rc1 - 5.17-rc1 are vulnerable.\n\n          Successfully tested against Ubuntu 22.04.01 with kernel 5.13.12-051312-generic.",
	"references": [
		"URL-https://grsecurity.net/exploiting_and_defending_against_same_type_object_reuse",
		"URL-https://github.com/opensrcsec/same_type_object_reuse_exploits",
		"CVE-2022-22942"
	],
	"platform": "Linux",
	"arch": "x86, x64",
	"targets": [
		"Auto"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/linux/local/vmwgfx_fd_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/vmwgfx_fd_priv_esc",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk",
			"ioc-in-logs"
		],
		"Stability": [
			"crash-os-down"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
