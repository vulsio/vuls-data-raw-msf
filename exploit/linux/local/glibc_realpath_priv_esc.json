{
	"name": "glibc 'realpath()' Privilege Escalation",
	"fullname": "exploit/linux/local/glibc_realpath_priv_esc",
	"rank": 300,
	"disclosure_date": "2018-01-16",
	"type": "exploit",
	"author": [
		"halfdog",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module attempts to gain root privileges on Linux systems by abusing\n          a vulnerability in GNU C Library (glibc) version 2.26 and prior.\n\n          This module uses halfdog's RationalLove exploit to exploit a buffer\n          underflow in glibc realpath() and create a SUID root shell. The exploit\n          has offsets for glibc versions 2.23-0ubuntu9 and 2.24-11+deb9u1.\n\n          The target system must have unprivileged user namespaces enabled.\n\n          This module has been tested successfully on Ubuntu Linux 16.04.3 (x86_64)\n          with glibc version 2.23-0ubuntu9; and Debian 9.0 (x86_64) with glibc\n          version 2.24-11+deb9u1.",
	"references": [
		"BID-102525",
		"CVE-2018-1000001",
		"EDB-43775",
		"URL-https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/",
		"URL-http://www.openwall.com/lists/oss-security/2018/01/11/5",
		"URL-https://securitytracker.com/id/1040162",
		"URL-https://sourceware.org/bugzilla/show_bug.cgi?id=22679",
		"URL-https://usn.ubuntu.com/3534-1/",
		"URL-https://bugzilla.redhat.com/show_bug.cgi?id=1533836"
	],
	"platform": "Linux",
	"arch": "x86, x64",
	"targets": [
		"Auto"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/linux/local/glibc_realpath_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/glibc_realpath_priv_esc",
	"check": true,
	"notes": {
		"AKA": [
			"RationalLove.c"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
