{
  "name": "Linux Kernel UDP Fragmentation Offset (UFO) Privilege Escalation",
  "fullname": "exploit/linux/local/ufo_privilege_escalation",
  "rank": 400,
  "disclosure_date": "2017-08-10",
  "type": "exploit",
  "author": [
    "Andrey Konovalov",
    "h00die",
    "bcoles <bcoles@gmail.com>"
  ],
  "description": "This module attempts to gain root privileges on Linux systems by abusing\n        UDP Fragmentation Offload (UFO).\n\n        This exploit targets only systems using Ubuntu (Trusty / Xenial) kernels\n        4.4.0-21 <= 4.4.0-89 and 4.8.0-34 <= 4.8.0-58, including Linux distros\n        based on Ubuntu, such as Linux Mint.\n\n        The target system must have unprivileged user namespaces enabled\n        and SMAP disabled.\n\n        Bypasses for SMEP and KASLR are included. Failed exploitation\n        may crash the kernel.\n\n        This module has been tested successfully on various Ubuntu and Linux\n        Mint systems, including:\n\n        Ubuntu 14.04.5 4.4.0-31-generic x64 Desktop;\n        Ubuntu 16.04 4.8.0-53-generic;\n        Linux Mint 17.3 4.4.0-89-generic;\n        Linux Mint 18 4.8.0-58-generic",
  "references": [
    "CVE-2017-1000112",
    "EDB-43418",
    "BID-100262",
    "URL-https://seclists.org/oss-sec/2017/q3/277",
    "URL-https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-1000112/poc.c",
    "URL-https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=85f1bd9a7b5a79d5baa8bf44af19658f7bf77bfa",
    "URL-https://people.canonical.com/~ubuntu-security/cve/CVE-2017-1000112",
    "URL-https://securingtomorrow.mcafee.com/mcafee-labs/linux-kernel-vulnerability-can-lead-to-privilege-escalation-analyzing-cve-2017-1000112/",
    "URL-https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html",
    "URL-https://github.com/bcoles/kernel-exploits/commits/cve-2017-1000112"
  ],
  "platform": "Linux",
  "arch": "x64",
  "targets": [
    "Auto"
  ],
  "mod_time": "2023-02-02 18:17:02 +0000",
  "path": "/modules/exploits/linux/local/ufo_privilege_escalation.rb",
  "is_install_path": true,
  "ref_name": "linux/local/ufo_privilege_escalation",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "Stability": [
      "crash-os-down"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
