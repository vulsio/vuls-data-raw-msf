{
	"name": "Desktop Linux Password Stealer and Privilege Escalation",
	"fullname": "exploit/linux/local/desktop_privilege_escalation",
	"rank": 600,
	"disclosure_date": "2014-08-07",
	"type": "exploit",
	"author": [
		"Jakob Lell"
	],
	"description": "This module steals the user password of an administrative user on a desktop Linux system\n        when it is entered for unlocking the screen or for doing administrative actions using\n        PolicyKit. Then, it escalates to root privileges using sudo and the stolen user password.\n        It exploits the design weakness that there is no trusted channel for transferring the\n        password from the keyboard to the actual password verification against the shadow file\n        (which is running as root since /etc/shadow is only readable to the root user). Both\n        screensavers (xscreensaver/gnome-screensaver) and PolicyKit use a component running under\n        the current user account to query for the password and then pass it to a setuid-root binary\n        to do the password verification. Therefore, it is possible to inject a password stealer\n        after compromising the user account. Since sudo requires only the user password (and not\n        the root password of the system), stealing the user password of an administrative user\n        directly allows escalating to root privileges. Please note, you have to start a handler\n        as a background job before running this exploit since the exploit will only create a shell\n        when the user actually enters the password (which may be hours after launching the exploit).\n        Using exploit/multi/handler with the option ExitOnSession set to false should do the job.",
	"platform": "Linux",
	"arch": "x86, x64",
	"targets": [
		"Linux x86",
		"Linux x86_64"
	],
	"mod_time": "2020-09-22 02:56:51 +0000",
	"path": "/modules/exploits/linux/local/desktop_privilege_escalation.rb",
	"is_install_path": true,
	"ref_name": "linux/local/desktop_privilege_escalation",
	"check": true,
	"session_types": [
		"shell",
		"meterpreter"
	]
}
