{
  "name": "AF_PACKET packet_set_ring Privilege Escalation",
  "fullname": "exploit/linux/local/af_packet_packet_set_ring_priv_esc",
  "rank": 400,
  "disclosure_date": "2017-03-29",
  "type": "exploit",
  "author": [
    "Andrey Konovalov",
    "bcoles <bcoles@gmail.com>"
  ],
  "description": "This module exploits a heap-out-of-bounds write in the packet_set_ring\n        function in net/packet/af_packet.c (AF_PACKET) in the Linux kernel\n        to execute code as root (CVE-2017-7308).\n\n        The bug was initially introduced in 2011 and patched in version 4.10.6,\n        potentially affecting a large number of kernels; however this exploit\n        targets only systems using Ubuntu Xenial kernels 4.8.0 < 4.8.0-46,\n        including Linux distros based on Ubuntu Xenial, such as Linux Mint.\n\n        The target system must have unprivileged user namespaces enabled and\n        two or more CPU cores.\n\n        Bypasses for SMEP, SMAP and KASLR are included. Failed exploitation\n        may crash the kernel.\n\n        This module has been tested successfully on Linux Mint 18 (x86_64)\n        with kernel versions:\n\n        4.8.0-34-generic;\n        4.8.0-36-generic;\n        4.8.0-39-generic;\n        4.8.0-41-generic;\n        4.8.0-42-generic;\n        4.8.0-44-generic;\n        4.8.0-45-generic.",
  "references": [
    "EDB-41994",
    "CVE-2017-7308",
    "BID-97234",
    "URL-https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html",
    "URL-https://www.coresecurity.com/blog/solving-post-exploitation-issue-cve-2017-7308",
    "URL-https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-7308.html",
    "URL-https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-7308/poc.c",
    "URL-https://github.com/bcoles/kernel-exploits/blob/cve-2017-7308/CVE-2017-7308/poc.c"
  ],
  "platform": "Linux",
  "arch": "x86, x64",
  "targets": [
    "Auto"
  ],
  "mod_time": "2023-02-02 18:17:02 +0000",
  "path": "/modules/exploits/linux/local/af_packet_packet_set_ring_priv_esc.rb",
  "is_install_path": true,
  "ref_name": "linux/local/af_packet_packet_set_ring_priv_esc",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "Stability": [
      "crash-os-down"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
