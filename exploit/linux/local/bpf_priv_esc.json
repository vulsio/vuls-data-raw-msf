{
	"name": "Linux BPF doubleput UAF Privilege Escalation",
	"fullname": "exploit/linux/local/bpf_priv_esc",
	"rank": 400,
	"disclosure_date": "2016-05-04",
	"type": "exploit",
	"author": [
		"jannh <jannh@google.com>",
		"h00die <mike@shorebreaksecurity.com>"
	],
	"description": "Linux kernel 4.4 < 4.5.5 extended Berkeley Packet Filter (eBPF)\n          does not properly reference count file descriptors, resulting\n          in a use-after-free, which can be abused to escalate privileges.\n\n          The target system must be compiled with `CONFIG_BPF_SYSCALL`\n          and must not have `kernel.unprivileged_bpf_disabled` set to 1.\n\n          Note, this module will overwrite the first few lines\n          of `/etc/crontab` with a new cron job. The job will\n          need to be manually removed.\n\n          This module has been tested successfully on Ubuntu 16.04 (x64)\n          kernel 4.4.0-21-generic (default kernel).",
	"references": [
		"BID-90309",
		"CVE-2016-4557",
		"EDB-39772",
		"URL-https://bugs.chromium.org/p/project-zero/issues/detail?id=808",
		"URL-https://usn.ubuntu.com/2965-1/",
		"URL-https://launchpad.net/bugs/1578705",
		"URL-http://changelogs.ubuntu.com/changelogs/pool/main/l/linux/linux_4.4.0-22.39/changelog",
		"URL-https://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-4557.html",
		"URL-https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=8358b02bf67d3a5d8a825070e1aa73f25fb2e4c7"
	],
	"platform": "Linux",
	"arch": "x86, x64",
	"targets": [
		"Linux x86",
		"Linux x64"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/linux/local/bpf_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/bpf_priv_esc",
	"check": true,
	"notes": {
		"AKA": [
			"double-fdput",
			"doubleput.c"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
