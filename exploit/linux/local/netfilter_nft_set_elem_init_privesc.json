{
	"name": "Netfilter nft_set_elem_init Heap Overflow Privilege Escalation",
	"fullname": "exploit/linux/local/netfilter_nft_set_elem_init_privesc",
	"rank": 200,
	"disclosure_date": "2022-02-07",
	"type": "exploit",
	"author": [
		"Arthur Mongodin <amongodin <Arthur Mongodin <amongodin@randorisec.fr> (@_Aleknight_)>",
		"Redouane NIBOUCHA <rniboucha@yahoo.fr>"
	],
	"description": "An issue was discovered in the Linux kernel through 5.18.9.\n          A type confusion bug in nft_set_elem_init (leading to a buffer overflow)\n          could be used by a local attacker to escalate privileges.\n          The attacker can obtain root access, but must start with an unprivileged\n          user namespace to obtain CAP_NET_ADMIN access.\n          The issue exists in nft_setelem_parse_data in net/netfilter/nf_tables_api.c.",
	"references": [
		"CVE-2022-34918",
		"URL-https://nvd.nist.gov/vuln/detail/CVE-2022-34918",
		"URL-https://ubuntu.com/security/CVE-2022-34918",
		"URL-https://www.randorisec.fr/crack-linux-firewall/",
		"URL-https://github.com/randorisec/CVE-2022-34918-LPE-PoC"
	],
	"platform": "Linux",
	"arch": "x64",
	"targets": [
		"Auto"
	],
	"mod_time": "2022-09-30 09:57:54 +0000",
	"path": "/modules/exploits/linux/local/netfilter_nft_set_elem_init_privesc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/netfilter_nft_set_elem_init_privesc",
	"check": true,
	"notes": {
		"Reliability": [
			"unreliable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"os-resource-loss",
			"crash-os-down"
		]
	},
	"session_types": [
		"meterpreter",
		"shell"
	],
	"needs_cleanup": true
}
