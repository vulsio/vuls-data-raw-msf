{
	"name": "Dirty Pipe Local Privilege Escalation via CVE-2022-0847",
	"fullname": "exploit/linux/local/cve_2022_0847_dirtypipe",
	"rank": 600,
	"disclosure_date": "2022-02-20",
	"type": "exploit",
	"author": [
		"Max Kellermann",
		"timwr"
	],
	"description": "This exploit targets a vulnerability in the Linux kernel since 5.8, that allows\n          writing of read only or immutable memory.\n\n          The vulnerability was fixed in Linux 5.16.11, 5.15.25 and 5.10.102.\n          The module exploits this vulnerability by overwriting a suid binary with the\n          payload, executing it, and then writing the original data back.\n\n          There are two major limitations of this exploit: the offset cannot be on a page\n          boundary (it needs to write one byte before the offset to add a reference to\n          this page to the pipe), and the write cannot cross a page boundary.\n          This means the payload must be less than the page size (4096 bytes).",
	"references": [
		"CVE-2022-0847",
		"URL-https://dirtypipe.cm4all.com",
		"URL-https://haxx.in/files/dirtypipez.c"
	],
	"platform": "Linux",
	"arch": "x64, x86, armle, aarch64",
	"targets": [
		"Automatic"
	],
	"mod_time": "2022-03-10 10:39:32 +0000",
	"path": "/modules/exploits/linux/local/cve_2022_0847_dirtypipe.rb",
	"is_install_path": true,
	"ref_name": "linux/local/cve_2022_0847_dirtypipe",
	"check": true,
	"notes": {
		"AKA": [
			"Dirty Pipe"
		],
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
