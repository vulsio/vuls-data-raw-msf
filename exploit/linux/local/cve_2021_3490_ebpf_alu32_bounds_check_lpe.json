{
  "name": "Linux eBPF ALU32 32-bit Invalid Bounds Tracking LPE",
  "fullname": "exploit/linux/local/cve_2021_3490_ebpf_alu32_bounds_check_lpe",
  "rank": 500,
  "disclosure_date": "2021-05-11",
  "type": "exploit",
  "author": [
    "Manfred Paul",
    "chompie1337",
    "Grant Willcox"
  ],
  "description": "Linux kernels from 5.7-rc1 prior to 5.13-rc4, 5.12.4, 5.11.21, and\n          5.10.37 are vulnerable to a bug in the eBPF verifier's verification\n          of ALU32 operations in the scalar32_min_max_and function when performing\n          AND operations, whereby under certain conditions the bounds of a\n          32 bit register would not be properly updated.\n\n          This can be abused by attackers to conduct an out of bounds read\n          and write in the Linux kernel and therefore achieve arbitrary\n          code execution as the root user.\n\n          The target system must be compiled with eBPF support and not have\n          kernel.unprivileged_bpf_disabled set, which prevents unprivileged\n          users from loading eBPF programs into the kernel. Note that if\n          kernel.unprivileged_bpf_disabled is enabled this module can still be\n          utilized to bypass protections such as SELinux, however the user\n          must already be logged as a privileged user such as root.",
  "references": [
    "CVE-2021-3490",
    "URL-https://www.openwall.com/lists/oss-security/2021/05/11/11",
    "URL-https://github.com/chompie1337/Linux_LPE_eBPF_CVE-2021-3490",
    "URL-https://www.zerodayinitiative.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification",
    "URL-https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=049c4e13714ecbca567b4d5f6d563f05d431c80e",
    "URL-https://www.graplsecurity.com/post/kernel-pwning-with-ebpf-a-love-story",
    "URL-https://www.zerodayinitiative.com/advisories/ZDI-21-606/",
    "URL-https://ubuntu.com/security/notices/USN-4950-1",
    "URL-https://ubuntu.com/security/notices/USN-4949-1"
  ],
  "platform": "Linux",
  "arch": "x86, x64",
  "targets": [
    "Auto"
  ],
  "mod_time": "2023-02-02 18:17:02 +0000",
  "path": "/modules/exploits/linux/local/cve_2021_3490_ebpf_alu32_bounds_check_lpe.rb",
  "is_install_path": true,
  "ref_name": "linux/local/cve_2021_3490_ebpf_alu32_bounds_check_lpe",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "Stability": [
      "crash-os-down"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
