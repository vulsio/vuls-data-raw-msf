{
	"name": "Libuser roothelper Privilege Escalation",
	"fullname": "exploit/linux/local/libuser_roothelper_priv_esc",
	"rank": 500,
	"disclosure_date": "2015-07-24",
	"type": "exploit",
	"author": [
		"Qualys",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module attempts to gain root privileges on Red Hat based Linux\n          systems, including RHEL, Fedora and CentOS, by exploiting a newline\n          injection vulnerability in libuser and userhelper versions prior to\n          0.56.13-8 and version 0.60 before 0.60-7.\n\n          This module makes use of the roothelper.c exploit from Qualys to\n          insert a new user with UID=0 in /etc/passwd.\n\n          Note, the password for the current user is required by userhelper.\n\n          Note, on some systems, such as Fedora 11, the user entry for the\n          current user in /etc/passwd will become corrupted and exploitation\n          will fail.\n\n          This module has been tested successfully on libuser packaged versions\n          0.56.13-4.el6 on CentOS 6.0 (x86_64);\n          0.56.13-5.el6 on CentOS 6.5 (x86_64);\n          0.60-5.el7 on CentOS 7.1-1503 (x86_64);\n          0.56.16-1.fc13 on Fedora 13 (i686);\n          0.59-1.fc19 on Fedora Desktop 19 (x86_64);\n          0.60-3.fc20 on Fedora Desktop 20 (x86_64);\n          0.60-6.fc21 on Fedora Desktop 21 (x86_64);\n          0.60-6.fc22 on Fedora Desktop 22 (x86_64);\n          0.56.13-5.el6 on Red Hat 6.6 (x86_64); and\n          0.60-5.el7 on Red Hat 7.0 (x86_64).\n\n          RHEL 5 is vulnerable, however the installed version of glibc (2.5)\n          is missing various functions required by roothelper.c.",
	"references": [
		"EDB-37706",
		"CVE-2015-3245",
		"CVE-2015-3246",
		"BID-76021",
		"BID-76022",
		"URL-https://seclists.org/oss-sec/2015/q3/185",
		"URL-https://access.redhat.com/articles/1537873"
	],
	"platform": "Linux",
	"arch": "x86, x64",
	"targets": [
		"Auto"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/linux/local/libuser_roothelper_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/libuser_roothelper_priv_esc",
	"check": true,
	"post_auth": true,
	"notes": {
		"AKA": [
			"roothelper.c"
		],
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"service-resource-loss"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
