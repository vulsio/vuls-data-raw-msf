{
  "name": "Apache Tomcat on RedHat Based Systems Insecure Temp Config Privilege Escalation",
  "fullname": "exploit/linux/local/tomcat_rhel_based_temp_priv_esc",
  "disclosure_date": "2016-10-10",
  "type": "exploit",
  "author": [
    "h00die",
    "Dawid Golunski <dawid@legalhackers.com>"
  ],
  "description": "This module exploits a vulnerability in RedHat based systems where\n          improper file permissions are applied to /usr/lib/tmpfiles.d/tomcat.conf\n          for Apache Tomcat versions before 7.0.54-8.  This may also work against\n\n          The configuration files in tmpfiles.d are used by systemd-tmpfiles to manage\n          temporary files including their creation.\n\n          With this weak permission, we're able to inject commands into systemd-tmpfiles\n          service to write a cron job to execute our payload.\n\n          systemd-tmpfiles is executed by default on boot on RedHat-based systems\n          through systemd-tmpfiles-setup.service. Depending on the system in use,\n          the execution of systemd-tmpfiles could also be triggered by other\n          services, cronjobs, startup scripts etc.\n\n          This module was tested against Tomcat 7.0.54-3 on Fedora 21.",
  "references": [
    "EDB-40488",
    "URL-https://access.redhat.com/security/cve/CVE-2016-5425",
    "URL-http://legalhackers.com/advisories/Tomcat-RedHat-Pkgs-Root-PrivEsc-Exploit-CVE-2016-5425.html",
    "URL-https://www.freedesktop.org/software/systemd/man/tmpfiles.d.html",
    "CVE-2016-5425"
  ],
  "platform": "Linux",
  "arch": "x86, x64",
  "targets": [
    "Auto"
  ],
  "mod_time": "2023-03-13 14:42:26 +0000",
  "path": "/modules/exploits/linux/local/tomcat_rhel_based_temp_priv_esc.rb",
  "is_install_path": true,
  "ref_name": "linux/local/tomcat_rhel_based_temp_priv_esc",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "config-changes",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
