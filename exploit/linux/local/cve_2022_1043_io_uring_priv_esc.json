{
  "name": "io_uring Same Type Object Reuse Priv Esc",
  "fullname": "exploit/linux/local/cve_2022_1043_io_uring_priv_esc",
  "rank": 500,
  "disclosure_date": "2022-03-22",
  "type": "exploit",
  "author": [
    "h00die",
    "Ryota Shiga",
    "Mathias Krause"
  ],
  "description": "This module exploits a bug in io_uring leading to an additional put_cred()\n          that can be exploited to hijack credentials of other processes.\n\n          We spawn SUID programs to get the free'd cred object reallocated by a\n          privileged process and abuse them to create a SUID root binary ourselves\n          that'll pop a shell.\n\n          The dangling cred pointer will, however, lead to a kernel panic as soon as\n          the task terminates and its credentials are destroyed. We therefore detach\n          from the controlling terminal, block all signals and rest in silence until\n          the system shuts down and we get killed hard, just to cry in vain, seeing\n          the kernel collapse.\n\n          The bug affected kernels from v5.12-rc3 to v5.14-rc7.\n\n          More than 1 CPU is required for exploitation.\n\n          Successfully tested against Ubuntu 22.04.01 with kernel 5.13.12-051312-generic",
  "references": [
    "URL-https://grsecurity.net/exploiting_and_defending_against_same_type_object_reuse",
    "URL-https://github.com/opensrcsec/same_type_object_reuse_exploits",
    "URL-https://github.com/torvalds/linux/commit/a30f895ad3239f45012e860d4f94c1a388b36d14",
    "CVE-2022-1043"
  ],
  "platform": "Linux",
  "arch": "x86, x64",
  "targets": [
    "Auto"
  ],
  "mod_time": "2023-03-22 12:52:15 +0000",
  "path": "/modules/exploits/linux/local/cve_2022_1043_io_uring_priv_esc.rb",
  "is_install_path": true,
  "ref_name": "linux/local/cve_2022_1043_io_uring_priv_esc",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
