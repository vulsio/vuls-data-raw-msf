{
  "name": "Linux Kernel 4.6.3 Netfilter Privilege Escalation",
  "fullname": "exploit/linux/local/netfilter_priv_esc_ipv4",
  "rank": 400,
  "disclosure_date": "2016-06-03",
  "type": "exploit",
  "author": [
    "h00die <mike@stcyrsecurity.com>",
    "vnik",
    "Jesse Hertz",
    "Tim Newsham"
  ],
  "description": "This module attempts to exploit a netfilter bug on Linux Kernels before 4.6.3, and currently\n          only works against Ubuntu 16.04 (not 16.04.1) with kernel 4.4.0-21-generic.\n\n          Several conditions have to be met for successful exploitation:\n          Ubuntu:\n          1. ip_tables.ko (ubuntu), iptable_raw (fedora) has to be loaded (root running iptables -L will do such)\n          2. libc6-dev-i386 (ubuntu), glibc-devel.i686 & libgcc.i686 (fedora) needs to be installed to compile\n          Kernel 4.4.0-31-generic and newer are not vulnerable. This exploit does not bypass SMEP/SMAP.\n\n          We write the ascii files and compile on target instead of locally since metasm bombs for not\n          having cdefs.h (even if locally installed)",
  "references": [
    "EDB-40049",
    "CVE-2016-4997",
    "CVE-2016-4998",
    "URL-https://www.openwall.com/lists/oss-security/2016/06/24/5",
    "URL-http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ce683e5f9d045e5d67d1312a42b359cb2ab2a13c",
    "URL-https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6e94e0cfb0887e4013b3b930fa6ab1fe6bb6ba91"
  ],
  "platform": "Linux",
  "arch": "x86, x64",
  "targets": [
    "Ubuntu"
  ],
  "mod_time": "2020-10-02 17:38:06 +0000",
  "path": "/modules/exploits/linux/local/netfilter_priv_esc_ipv4.rb",
  "is_install_path": true,
  "ref_name": "linux/local/netfilter_priv_esc_ipv4",
  "check": true,
  "notes": {
    "Reliability": [
      "unreliable-session"
    ],
    "Stability": [
      "crash-os-down"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ],
  "needs_cleanup": true
}
