{
	"name": "AF_PACKET chocobo_root Privilege Escalation",
	"fullname": "exploit/linux/local/af_packet_chocobo_root_priv_esc",
	"rank": 400,
	"disclosure_date": "2016-08-12",
	"type": "exploit",
	"author": [
		"rebel",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module exploits a race condition and use-after-free in the\n        packet_set_ring function in net/packet/af_packet.c (AF_PACKET) in\n        the Linux kernel to execute code as root (CVE-2016-8655).\n\n        The bug was initially introduced in 2011 and patched in 2016 in version\n        4.4.0-53.74, potentially affecting a large number of kernels; however\n        this exploit targets only systems using Ubuntu (Trusty / Xenial) kernels\n        4.4.0 < 4.4.0-53, including Linux distros based on Ubuntu, such as\n        Linux Mint.\n\n        The target system must have unprivileged user namespaces enabled,\n        two or more CPU cores, and SMAP must be disabled.\n\n        Bypasses for SMEP and KASLR are included. Failed exploitation\n        may crash the kernel.\n\n        This module has been tested successfully on\n\n        Linux Mint 17.3 (x86_64);\n        Linux Mint 18 (x86_64);\n        Ubuntu 16.04 (x86_64); and\n        Ubuntu 16.04.2 (x86_64).",
	"references": [
		"EDB-40871",
		"CVE-2016-8655",
		"BID-94692",
		"URL-https://seclists.org/oss-sec/2016/q4/607",
		"URL-https://seclists.org/oss-sec/2016/q4/att-621/chocobo_root_c.bin",
		"URL-https://github.com/bcoles/kernel-exploits/blob/master/CVE-2016-8655/chocobo_root.c",
		"URL-https://bitbucket.org/externalist/1day_exploits/src/master/CVE-2016-8655/CVE-2016-8655_chocobo_root_commented.c",
		"URL-https://usn.ubuntu.com/3151-1/",
		"URL-https://www.securitytracker.com/id/1037403",
		"URL-https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=84ac7260236a49c79eede91617700174c2c19b0c"
	],
	"platform": "Linux",
	"arch": "x86, x64",
	"targets": [
		"Auto"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/linux/local/af_packet_chocobo_root_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/af_packet_chocobo_root_priv_esc",
	"check": true,
	"notes": {
		"AKA": [
			"chocobo_root.c"
		],
		"Reliability": [
			"repeatable-session"
		],
		"Stability": [
			"crash-os-down"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
