{
	"name": "Sudoedit Extra Arguments Priv Esc",
	"fullname": "exploit/linux/local/sudoedit_bypass_priv_esc",
	"rank": 600,
	"disclosure_date": "2023-01-18",
	"type": "exploit",
	"author": [
		"h00die",
		"Matthieu Barjole",
		"Victor Cutillas"
	],
	"description": "This exploit takes advantage of a vulnerability in sudoedit, part of the sudo package.\n          The sudoedit (aka sudo -e) feature mishandles extra arguments passed in the user-provided\n          environment variables (SUDO_EDITOR, VISUAL, and EDITOR), allowing a local attacker to\n          append arbitrary entries to the list of files to process. This can lead to privilege escalation.\n          by appending extra entries on /etc/sudoers allowing for execution of an arbitrary payload with root\n          privileges.\n\n          Affected versions are 1.8.0 through 1.9.12.p1. However THIS module only works against Ubuntu\n          22.04 and 22.10.\n\n          This module was tested against sudo 1.9.9-1ubuntu2 on Ubuntu 22.04, and\n          1.9.11p3-1ubuntu1 on Ubuntu 22.10.",
	"references": [
		"EDB-51217",
		"URL-https://github.com/M4fiaB0y/CVE-2023-22809/blob/main/exploit.sh",
		"URL-https://raw.githubusercontent.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc/main/exploit.sh",
		"URL-https://www.vicarius.io/vsociety/blog/cve-2023-22809-sudoedit-bypass-analysis",
		"URL-https://medium.com/@dev.nest/how-to-bypass-sudo-exploit-cve-2023-22809-vulnerability-296ef10a1466",
		"URL-https://www.synacktiv.com/sites/default/files/2023-01/sudo-CVE-2023-22809.pdf",
		"URL-https://www.sudo.ws/security/advisories/sudoedit_any/",
		"CVE-2023-22809"
	],
	"platform": "Linux",
	"arch": "x86, x64",
	"targets": [
		"Auto"
	],
	"mod_time": "2023-05-16 16:18:14 +0000",
	"path": "/modules/exploits/linux/local/sudoedit_bypass_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/sudoedit_bypass_priv_esc",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs",
			"artifacts-on-disk",
			"config-changes"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
