{
	"name": "SystemTap MODPROBE_OPTIONS Privilege Escalation",
	"fullname": "exploit/linux/local/systemtap_modprobe_options_priv_esc",
	"rank": 600,
	"disclosure_date": "2010-11-17",
	"type": "exploit",
	"author": [
		"Tavis Ormandy",
		"bcoles <bcoles@gmail.com>"
	],
	"description": "This module attempts to gain root privileges by exploiting a\n          vulnerability in the `staprun` executable included with SystemTap\n          version 1.3.\n\n          The `staprun` executable does not clear environment variables prior to\n          executing `modprobe`, allowing an arbitrary configuration file to be\n          specified in the `MODPROBE_OPTIONS` environment variable, resulting\n          in arbitrary command execution with root privileges.\n\n          This module has been tested successfully on:\n\n          systemtap 1.2-1.fc13-i686 on Fedora 13 (i686); and\n          systemtap 1.1-3.el5 on RHEL 5.5 (x64).",
	"references": [
		"BID-44914",
		"CVE-2010-4170",
		"EDB-15620",
		"URL-https://securitytracker.com/id?1024754",
		"URL-https://access.redhat.com/security/cve/cve-2010-4170",
		"URL-https://bugzilla.redhat.com/show_bug.cgi?id=653604",
		"URL-https://lists.fedoraproject.org/pipermail/package-announce/2010-November/051115.html",
		"URL-https://bugs.launchpad.net/bugs/677226",
		"URL-https://www.debian.org/security/2011/dsa-2348"
	],
	"platform": "Linux",
	"arch": "x86, x64, armle, aarch64, ppc, mipsle, mipsbe",
	"targets": [
		"Auto"
	],
	"mod_time": "2023-02-02 18:17:02 +0000",
	"path": "/modules/exploits/linux/local/systemtap_modprobe_options_priv_esc.rb",
	"is_install_path": true,
	"ref_name": "linux/local/systemtap_modprobe_options_priv_esc",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	],
	"needs_cleanup": true
}
