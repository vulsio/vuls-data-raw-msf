{
	"name": "Samba SetInformationPolicy AuditEventsInfo Heap Overflow",
	"fullname": "exploit/linux/samba/setinfopolicy_heap",
	"rank": 300,
	"disclosure_date": "2012-04-10",
	"type": "exploit",
	"author": [
		"Unknown",
		"blasty",
		"mephos",
		"sinn3r <sinn3r@metasploit.com>",
		"juan vazquez <juan.vazquez@metasploit.com>"
	],
	"description": "This module triggers a vulnerability in the LSA RPC service of the Samba daemon\n        because of an error on the PIDL auto-generated code. Making a specially crafted\n        call to SetInformationPolicy to set a PolicyAuditEventsInformation allows to\n        trigger a heap overflow and finally execute arbitrary code with root privileges.\n\n        The module uses brute force to guess the stackpivot/rop chain or the system()\n        address and redirect flow there in order to bypass NX. The start and stop addresses\n        for brute forcing have been calculated empirically. On the other hand the module\n        provides the StartBrute and StopBrute which allow the user to configure his own\n        addresses.",
	"references": [
		"CVE-2012-1182",
		"OSVDB-81303",
		"BID-52973",
		"ZDI-12-069"
	],
	"platform": "Linux,Unix",
	"rport": 445,
	"autofilter_ports": [
		139,
		445
	],
	"autofilter_services": [
		"netbios-ssn",
		"microsoft-ds"
	],
	"targets": [
		"2:3.5.11~dfsg-1ubuntu2 on Ubuntu Server 11.10",
		"2:3.5.8~dfsg-1ubuntu2 on Ubuntu Server 11.10",
		"2:3.5.8~dfsg-1ubuntu2 on Ubuntu Server 11.04",
		"2:3.5.4~dfsg-1ubuntu8 on Ubuntu Server 10.10",
		"2:3.5.6~dfsg-3squeeze6 on Debian Squeeze",
		"3.5.10-0.107.el5 on CentOS 5"
	],
	"mod_time": "2020-10-02 17:38:06 +0000",
	"path": "/modules/exploits/linux/samba/setinfopolicy_heap.rb",
	"is_install_path": true,
	"ref_name": "linux/samba/setinfopolicy_heap",
	"check": true
}
