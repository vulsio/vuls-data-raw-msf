{
	"name": "Redis Lua Sandbox Escape",
	"fullname": "exploit/linux/redis/redis_debian_sandbox_escape",
	"rank": 600,
	"disclosure_date": "2022-02-18",
	"type": "exploit",
	"author": [
		"Reginaldo Silva",
		"jbaines-r7"
	],
	"description": "This module exploits CVE-2022-0543, a Lua-based Redis sandbox escape. The\n          vulnerability was introduced by Debian and Ubuntu Redis packages that\n          insufficiently sanitized the Lua environment. The maintainers failed to\n          disable the package interface, allowing attackers to load arbitrary libraries.\n\n          On a typical `redis` deployment (not docker), this module achieves execution\n          as the `redis` user. Debian/Ubuntu packages run Redis using systemd with the\n          \"MemoryDenyWriteExecute\" permission, which limits some of what an attacker can\n          do. For example, staged meterpreter will fail when attempting to use mprotect.\n          As such, stageless meterpreter is the preferred payload.\n\n          Redis can be configured with authentication or not. This module will work with\n          either configuration (provided you provide the correct authentication details).\n          This vulnerability could theoretically be exploited across a few architectures:\n          i386, arm, ppc, etc. However, the module only supports x86_64, which is likely\n          to be the most popular version.",
	"references": [
		"CVE-2022-0543",
		"URL-https://www.lua.org/pil/8.2.html",
		"URL-https://www.ubercomp.com/posts/2022-01-20_redis_on_debian_rce",
		"URL-https://www.debian.org/security/2022/dsa-5081",
		"URL-https://ubuntu.com/security/CVE-2022-0543"
	],
	"platform": "Linux,Unix",
	"arch": "cmd, x86, x64",
	"rport": 6379,
	"targets": [
		"Unix Command",
		"Linux Dropper"
	],
	"mod_time": "2023-02-08 15:20:32 +0000",
	"path": "/modules/exploits/linux/redis/redis_debian_sandbox_escape.rb",
	"is_install_path": true,
	"ref_name": "linux/redis/redis_debian_sandbox_escape",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
