{
	"name": "Setuid Nmap Exploit",
	"fullname": "exploit/unix/local/setuid_nmap",
	"rank": 600,
	"disclosure_date": "2012-07-19",
	"type": "exploit",
	"author": [
		"egypt <egypt@metasploit.com>"
	],
	"description": "Nmap's man page mentions that \"Nmap should never be installed with\n          special privileges (e.g. suid root) for security reasons..\" and\n          specifically avoids making any of its binaries setuid during\n          installation.  Nevertheless, administrators sometimes feel the need\n          to do insecure things.  This module abuses a setuid nmap binary by\n          writing out a lua nse script containing a call to os.execute().\n\n          Note that modern interpreters will refuse to run scripts on the\n          command line when EUID != UID, so the cmd/unix/reverse_{perl,ruby}\n          payloads will most likely not work.",
	"platform": "BSD,Linux,Unix",
	"arch": "cmd, x86",
	"targets": [
		"Command payload",
		"Linux x86",
		"BSD x86"
	],
	"mod_time": "2023-02-05 15:45:30 +0000",
	"path": "/modules/exploits/unix/local/setuid_nmap.rb",
	"is_install_path": true,
	"ref_name": "unix/local/setuid_nmap",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"session_types": [
		"shell",
		"meterpreter"
	]
}
