{
	"name": "Splunk Authenticated XSLT Upload RCE",
	"fullname": "exploit/unix/http/splunk_xslt_authenticated_rce",
	"rank": 600,
	"disclosure_date": "2023-11-28",
	"type": "exploit",
	"author": [
		"nathan",
		"Valentin Lobstein",
		"h00die"
	],
	"description": "This Metasploit module exploits a Remote Code Execution (RCE) vulnerability in Splunk Enterprise.\n          The affected versions include 9.0.x before 9.0.7 and 9.1.x before 9.1.2. The exploitation process leverages\n          a weakness in the XSLT transformation functionality of Splunk. Successful exploitation requires valid\n          credentials, typically 'admin:changeme' by default.\n\n          The exploit involves uploading a malicious XSLT file to the target system. This file, when processed by the\n          vulnerable Splunk server, leads to the execution of arbitrary code. The module then utilizes the 'runshellscript'\n          capability in Splunk to execute the payload, which can be tailored to establish a reverse shell. This provides\n          the attacker with remote control over the compromised Splunk instance. The module is designed to work\n          seamlessly, ensuring successful exploitation under the right conditions.",
	"references": [
		"CVE-2023-46214",
		"URL-https://github.com/nathan31337/Splunk-RCE-poc",
		"URL-https://advisory.splunk.com/advisories/SVD-2023-1104",
		"URL-https://blog.hrncirik.net/cve-2023-46214-analysis"
	],
	"platform": "Linux,Unix",
	"arch": "php, cmd",
	"rport": 8000,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Automatic"
	],
	"mod_time": "2023-12-11 15:36:10 +0000",
	"path": "/modules/exploits/unix/http/splunk_xslt_authenticated_rce.rb",
	"is_install_path": true,
	"ref_name": "unix/http/splunk_xslt_authenticated_rce",
	"check": true,
	"post_auth": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"SideEffects": [
			"ioc-in-logs",
			"artifacts-on-disk"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
