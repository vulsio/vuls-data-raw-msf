{
	"name": "Maltrail Unauthenticated Command Injection",
	"fullname": "exploit/unix/http/maltrail_rce",
	"rank": 600,
	"disclosure_date": "2023-07-31",
	"type": "exploit",
	"author": [
		"Ege BALCI <egebalci@pm.me>",
		"Chris Wild"
	],
	"description": "Maltrail is a malicious traffic detection system, utilizing publicly\n          available blacklists containing malicious and/or generally suspicious trails.\n          The Maltrail versions < 0.54 is suffering from a command injection vulnerability.\n          The `subprocess.check_output` function in `mailtrail/core/http.py` contains\n          a command injection vulnerability in the `params.get(\"username\")` parameter.\n          An attacker can exploit this vulnerability by injecting arbitrary OS commands\n          into the username parameter. The injected commands will be executed with the\n          privileges of the running process. This vulnerability can be exploited remotely\n          without authentication.\n\n          Successfully tested against Maltrail versions 0.52 and 0.53.",
	"references": [
		"EDB-51676",
		"URL-https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/",
		"URL-https://github.com/stamparm/maltrail/issues/19146"
	],
	"platform": "Linux,Unix",
	"arch": "cmd, x86, x64",
	"rport": 8338,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"Unix Command",
		"Linux Dropper"
	],
	"mod_time": "2023-08-16 16:52:48 +0000",
	"path": "/modules/exploits/unix/http/maltrail_rce.rb",
	"is_install_path": true,
	"ref_name": "unix/http/maltrail_rce",
	"check": true,
	"notes": {
		"Reliability": [
			"repeatable-session"
		],
		"Stability": [
			"crash-safe"
		]
	}
}
