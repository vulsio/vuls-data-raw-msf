{
  "name": "Pi-Hole DHCP MAC OS Command Execution",
  "fullname": "exploit/unix/http/pihole_dhcp_mac_exec",
  "rank": 400,
  "disclosure_date": "2020-03-28",
  "type": "exploit",
  "author": [
    "h00die",
    "Fran√ßois Renaud-Philippon <nate@nate.red>"
  ],
  "description": "This exploits a command execution in Pi-Hole <= 4.3.2.  A new DHCP static lease is added\n          with a MAC address which includes an RCE.  Exploitation requires /opt/pihole to be first\n          in the $PATH due to exploitation constraints.  DHCP server is not required to be running.",
  "references": [
    "URL-https://natedotred.wordpress.com/2020/03/28/cve-2020-8816-pi-hole-remote-code-execution/",
    "CVE-2020-8816"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "rport": 80,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Automatic Target"
  ],
  "mod_time": "2022-10-03 19:50:04 +0000",
  "path": "/modules/exploits/unix/http/pihole_dhcp_mac_exec.rb",
  "is_install_path": true,
  "ref_name": "unix/http/pihole_dhcp_mac_exec",
  "check": true,
  "notes": {
    "RelatedModules": [
      "exploit/linux/local/pihole_remove_commands_lpe"
    ],
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
