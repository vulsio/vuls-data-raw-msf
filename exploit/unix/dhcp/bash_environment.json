{
	"name": "Dhclient Bash Environment Variable Injection (Shellshock)",
	"fullname": "exploit/unix/dhcp/bash_environment",
	"rank": 600,
	"disclosure_date": "2014-09-24",
	"type": "exploit",
	"author": [
		"Stephane Chazelas",
		"egypt <egypt@metasploit.com>"
	],
	"description": "This module exploits the Shellshock vulnerability, a flaw in how the Bash shell\n        handles external environment variables. This module targets dhclient by responding\n        to DHCP requests with a malicious hostname, domainname, and URL which are then\n        passed to the configuration scripts as environment variables, resulting in code\n        execution. Due to length restrictions and the unusual networking scenario at the\n        time of exploitation, this module achieves code execution by writing the payload\n        into /etc/crontab and then cleaning it up after a session is created.",
	"references": [
		"CVE-2014-6271",
		"CWE-94",
		"OSVDB-112004",
		"EDB-34765",
		"URL-https://securityblog.redhat.com/2014/09/24/bash-specially-crafted-environment-variables-code-injection-attack/",
		"URL-https://seclists.org/oss-sec/2014/q3/649",
		"URL-https://www.trustedsec.com/september-2014/shellshock-dhcp-rce-proof-concept/"
	],
	"platform": "Unix",
	"arch": "cmd",
	"targets": [
		"Automatic Target"
	],
	"mod_time": "2023-03-13 10:31:27 +0000",
	"path": "/modules/exploits/unix/dhcp/bash_environment.rb",
	"is_install_path": true,
	"ref_name": "unix/dhcp/bash_environment",
	"notes": {
		"AKA": [
			"Shellshock"
		],
		"Stability": [
			"crash-safe"
		]
	},
	"needs_cleanup": true
}
