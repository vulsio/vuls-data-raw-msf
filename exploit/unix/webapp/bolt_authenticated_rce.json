{
  "name": "Bolt CMS 3.7.0 - Authenticated Remote Code Execution",
  "fullname": "exploit/unix/webapp/bolt_authenticated_rce",
  "rank": 500,
  "disclosure_date": "2020-05-07",
  "type": "exploit",
  "author": [
    "Sivanesh Ashok",
    "r3m0t3nu11",
    "Erik Wynter"
  ],
  "description": "This module exploits multiple vulnerabilities in Bolt CMS version 3.7.0\n          and 3.6.* in order to execute arbitrary commands as the user running Bolt.\n\n          This module first takes advantage of a vulnerability that allows an\n          authenticated user to change the username in /bolt/profile to a PHP\n          `system($_GET[\"\"])` variable. Next, the module obtains a list of tokens\n          from `/async/browse/cache/.sessions` and uses these to create files with\n          the blacklisted `.php` extention via HTTP POST requests to\n          `/async/folder/rename`. For each created file, the module checks the HTTP\n          response for evidence that the file can be used to execute arbitrary\n          commands via the created PHP $_GET variable. If the response is negative,\n          the file is deleted, otherwise the payload is executed via an HTTP\n          get request in this format: `/files/<rogue_PHP_file>?<$_GET_var>=<payload>`\n\n          Valid credentials for a Bolt CMS user are required. This module has been\n          successfully tested against Bolt CMS 3.7.0 running on CentOS 7.",
  "references": [
    "EDB-48296",
    "URL-https://github.com/bolt/bolt/releases/tag/3.7.1"
  ],
  "platform": "Linux,Unix",
  "arch": "x86, x64, cmd",
  "rport": 8000,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Linux (x86)",
    "Linux (x64)",
    "Linux (cmd)"
  ],
  "mod_time": "2023-03-13 10:31:27 +0000",
  "path": "/modules/exploits/unix/webapp/bolt_authenticated_rce.rb",
  "is_install_path": true,
  "ref_name": "unix/webapp/bolt_authenticated_rce",
  "check": true,
  "post_auth": true,
  "notes": {
    "NOCVE": [
      "0day"
    ],
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "ioc-in-logs",
      "config-changes",
      "artifacts-on-disk"
    ],
    "Stability": [
      "service-resource-loss"
    ]
  }
}
