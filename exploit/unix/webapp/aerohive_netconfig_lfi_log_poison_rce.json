{
  "name": "Aerohive NetConfig 10.0r8a LFI and log poisoning to RCE",
  "fullname": "exploit/unix/webapp/aerohive_netconfig_lfi_log_poison_rce",
  "rank": 600,
  "disclosure_date": "2020-02-17",
  "type": "exploit",
  "author": [
    "Erik de Jong",
    "Erik Wynter"
  ],
  "description": "This module exploits LFI and log poisoning vulnerabilities\n          (CVE-2020-16152) in Aerohive NetConfig, version 10.0r8a\n          build-242466 and older in order to achieve unauthenticated remote\n          code execution as the root user. NetConfig is the Aerohive/Extreme\n          Networks HiveOS administrative webinterface. Vulnerable versions\n          allow for LFI because they rely on a version of PHP 5 that is\n          vulnerable to string truncation attacks. This module leverages this\n          issue in conjunction with log poisoning to gain RCE as root.\n\n          Upon successful exploitation, the Aerohive NetConfig application\n          may hang for as long as the spawned shell remains open. For the\n          Linux target, the MeterpreterTryToFork option (enabled by default)\n          will likely prevent this. If the app hangs, closing the session\n          should render it responsive again.\n\n          The module provides an automatic cleanup option to clean the log.\n          However, this option is disabled by default because any modifications\n          to the /tmp/messages log, even via sed, may render the target\n          (temporarily) unexploitable. This state can last over an hour.\n\n          This module has been successfully tested against Aerohive NetConfig\n          versions 8.2r4 and 10.0r7a.",
  "references": [
    "CVE-2020-16152",
    "URL-https://github.com/eriknl/CVE-2020-16152"
  ],
  "platform": "Linux,Unix",
  "arch": "armle, cmd",
  "rport": 443,
  "autofilter_ports": [
    80,
    8080,
    443,
    8000,
    8888,
    8880,
    8008,
    3000,
    8443
  ],
  "autofilter_services": [
    "http",
    "https"
  ],
  "targets": [
    "Linux",
    "CMD"
  ],
  "mod_time": "2022-10-27 13:33:18 +0000",
  "path": "/modules/exploits/unix/webapp/aerohive_netconfig_lfi_log_poison_rce.rb",
  "is_install_path": true,
  "ref_name": "unix/webapp/aerohive_netconfig_lfi_log_poison_rce",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "artifacts-on-disk",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  }
}
