{
	"name": "WordPress PHPMailer Host Header Command Injection",
	"fullname": "exploit/unix/webapp/wp_phpmailer_host_header",
	"rank": 200,
	"disclosure_date": "2017-05-03",
	"type": "exploit",
	"author": [
		"Dawid Golunski",
		"wvu <wvu@metasploit.com>"
	],
	"description": "This module exploits a command injection vulnerability in WordPress\n        version 4.6 with Exim as an MTA via a spoofed Host header to PHPMailer,\n        a mail-sending library that is bundled with WordPress.\n\n        A valid WordPress username is required to exploit the vulnerability.\n        Additionally, due to the altered Host header, exploitation is limited to\n        the default virtual host, assuming the header isn't mangled in transit.\n\n        If the target is running Apache 2.2.32 or 2.4.24 and later, the server\n        may have HttpProtocolOptions set to Strict, preventing a Host header\n        containing parens from passing through, making exploitation unlikely.",
	"references": [
		"CVE-2016-10033",
		"URL-https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html",
		"URL-http://www.exim.org/exim-html-current/doc/html/spec_html/ch-string_expansions.html",
		"URL-https://httpd.apache.org/docs/2.4/mod/core.html#httpprotocoloptions"
	],
	"platform": "Linux",
	"arch": "x86, x64",
	"rport": 80,
	"autofilter_ports": [
		80,
		8080,
		443,
		8000,
		8888,
		8880,
		8008,
		3000,
		8443
	],
	"autofilter_services": [
		"http",
		"https"
	],
	"targets": [
		"WordPress 4.6 / Exim"
	],
	"mod_time": "2021-02-17 12:33:59 +0000",
	"path": "/modules/exploits/unix/webapp/wp_phpmailer_host_header.rb",
	"is_install_path": true,
	"ref_name": "unix/webapp/wp_phpmailer_host_header",
	"check": true,
	"post_auth": true
}
